/* C code for program orient, generated by snc from ../orient_st.st */
#include <string.h>
#include <stddef.h>
#include <stdio.h>
#include <limits.h>

#include "seq_snc.h"
# line 114 "../orient_st.st"
static const EF_ID Mode_mon = 1;
# line 125 "../orient_st.st"
static const EF_ID motPut_mon = 2;
# line 135 "../orient_st.st"
static const EF_ID motGet_mon = 3;
# line 144 "../orient_st.st"
static const EF_ID motTTH_mon = 4;
# line 145 "../orient_st.st"
static const EF_ID motTH_mon = 5;
# line 146 "../orient_st.st"
static const EF_ID motCHI_mon = 6;
# line 147 "../orient_st.st"
static const EF_ID motPHI_mon = 7;
# line 149 "../orient_st.st"
static const EF_ID motRBV_mon = 8;
# line 178 "../orient_st.st"
static const EF_ID H_mon = 9;
# line 184 "../orient_st.st"
static const EF_ID K_mon = 10;
# line 190 "../orient_st.st"
static const EF_ID L_mon = 11;
# line 200 "../orient_st.st"
static const EF_ID TTH_mon = 12;
# line 205 "../orient_st.st"
static const EF_ID TH_mon = 13;
# line 210 "../orient_st.st"
static const EF_ID CHI_mon = 14;
# line 215 "../orient_st.st"
static const EF_ID PHI_mon = 15;
# line 243 "../orient_st.st"
static const EF_ID xtalParm_mon = 16;
# line 252 "../orient_st.st"
static const EF_ID lambda_mon = 17;
# line 256 "../orient_st.st"
static const EF_ID energy_mon = 18;
# line 265 "../orient_st.st"
static const EF_ID A0_mon = 19;
# line 281 "../orient_st.st"
static const EF_ID OMTX_mon = 20;
# line 297 "../orient_st.st"
#include <string.h>
# line 298 "../orient_st.st"
#include <math.h>
# line 299 "../orient_st.st"
#include "matrix3.h"
# line 300 "../orient_st.st"
#include "orient.h"

/* Variable declarations */
struct seqg_vars {
# line 91 "../orient_st.st"
	char tmpstr[100];
# line 92 "../orient_st.st"
	char *cp;
# line 108 "../orient_st.st"
	short orientDebug;
# line 109 "../orient_st.st"
	string Msg;
# line 110 "../orient_st.st"
	short Alert;
# line 111 "../orient_st.st"
	short opAck;
# line 114 "../orient_st.st"
	short Mode;
# line 125 "../orient_st.st"
	short motPut;
# line 126 "../orient_st.st"
	short motPut_Auto;
# line 127 "../orient_st.st"
	short load_motPut;
# line 135 "../orient_st.st"
	short motGet;
# line 136 "../orient_st.st"
	short motGet_Auto;
# line 139 "../orient_st.st"
	string motTTH_name;
# line 140 "../orient_st.st"
	string motTH_name;
# line 141 "../orient_st.st"
	string motCHI_name;
# line 142 "../orient_st.st"
	string motPHI_name;
# line 144 "../orient_st.st"
	double motTTH;
# line 145 "../orient_st.st"
	double motTH;
# line 146 "../orient_st.st"
	double motCHI;
# line 147 "../orient_st.st"
	double motPHI;
# line 149 "../orient_st.st"
	double motTTH_RBV;
# line 150 "../orient_st.st"
	double motTH_RBV;
# line 151 "../orient_st.st"
	double motCHI_RBV;
# line 152 "../orient_st.st"
	double motPHI_RBV;
# line 153 "../orient_st.st"
	double rbv_angles[4];
# line 155 "../orient_st.st"
	int motTTH_stop;
# line 156 "../orient_st.st"
	int motTH_stop;
# line 157 "../orient_st.st"
	int motCHI_stop;
# line 158 "../orient_st.st"
	int motPHI_stop;
# line 159 "../orient_st.st"
	int stopMotors;
# line 161 "../orient_st.st"
	int motTTH_Connected;
# line 162 "../orient_st.st"
	int motTH_Connected;
# line 163 "../orient_st.st"
	int motCHI_Connected;
# line 164 "../orient_st.st"
	int motPHI_Connected;
# line 165 "../orient_st.st"
	int motorsConnected;
# line 166 "../orient_st.st"
	int motorStopsConnected;
# line 169 "../orient_st.st"
	short OMTX_Calc;
# line 174 "../orient_st.st"
	short Busy;
# line 177 "../orient_st.st"
	double H;
# line 178 "../orient_st.st"
	double H_event;
# line 179 "../orient_st.st"
	short H_busy;
# line 180 "../orient_st.st"
	double loadH;
# line 181 "../orient_st.st"
	double H_RBV;
# line 183 "../orient_st.st"
	double K;
# line 184 "../orient_st.st"
	double K_event;
# line 185 "../orient_st.st"
	short K_busy;
# line 186 "../orient_st.st"
	double loadK;
# line 187 "../orient_st.st"
	double K_RBV;
# line 189 "../orient_st.st"
	double L;
# line 190 "../orient_st.st"
	double L_event;
# line 191 "../orient_st.st"
	short L_busy;
# line 192 "../orient_st.st"
	double loadL;
# line 193 "../orient_st.st"
	double L_RBV;
# line 195 "../orient_st.st"
	double hkl[3];
# line 196 "../orient_st.st"
	double rbv_hkl[3];
# line 199 "../orient_st.st"
	double TTH;
# line 200 "../orient_st.st"
	double TTH_event;
# line 201 "../orient_st.st"
	short TTH_busy;
# line 202 "../orient_st.st"
	double loadTTH;
# line 204 "../orient_st.st"
	double TH;
# line 205 "../orient_st.st"
	double TH_event;
# line 206 "../orient_st.st"
	short TH_busy;
# line 207 "../orient_st.st"
	double loadTH;
# line 209 "../orient_st.st"
	double CHI;
# line 210 "../orient_st.st"
	double CHI_event;
# line 211 "../orient_st.st"
	short CHI_busy;
# line 212 "../orient_st.st"
	double loadCHI;
# line 214 "../orient_st.st"
	double PHI;
# line 215 "../orient_st.st"
	double PHI_event;
# line 216 "../orient_st.st"
	short PHI_busy;
# line 217 "../orient_st.st"
	double loadPHI;
# line 219 "../orient_st.st"
	double angles[4];
# line 222 "../orient_st.st"
	double H1;
# line 223 "../orient_st.st"
	double K1;
# line 224 "../orient_st.st"
	double L1;
# line 225 "../orient_st.st"
	double TTH1;
# line 226 "../orient_st.st"
	double TH1;
# line 227 "../orient_st.st"
	double CHI1;
# line 228 "../orient_st.st"
	double PHI1;
# line 229 "../orient_st.st"
	short refGet1;
# line 230 "../orient_st.st"
	short refPut1;
# line 232 "../orient_st.st"
	double H2;
# line 233 "../orient_st.st"
	double K2;
# line 234 "../orient_st.st"
	double L2;
# line 235 "../orient_st.st"
	double TTH2;
# line 236 "../orient_st.st"
	double TH2;
# line 237 "../orient_st.st"
	double CHI2;
# line 238 "../orient_st.st"
	double PHI2;
# line 239 "../orient_st.st"
	short refGet2;
# line 240 "../orient_st.st"
	short refPut2;
# line 243 "../orient_st.st"
	double a;
# line 244 "../orient_st.st"
	double b;
# line 245 "../orient_st.st"
	double c;
# line 246 "../orient_st.st"
	double alpha;
# line 247 "../orient_st.st"
	double beta;
# line 248 "../orient_st.st"
	double Gamma;
# line 251 "../orient_st.st"
	double lambda;
# line 252 "../orient_st.st"
	double lambda_event;
# line 253 "../orient_st.st"
	double load_lambda;
# line 255 "../orient_st.st"
	double energy;
# line 256 "../orient_st.st"
	double energy_event;
# line 257 "../orient_st.st"
	double load_energy;
# line 259 "../orient_st.st"
	double hc;
# line 262 "../orient_st.st"
	double A0[3][3];
# line 263 "../orient_st.st"
	double A0_i[3][3];
# line 265 "../orient_st.st"
	double A0_11;
# line 266 "../orient_st.st"
	double A0_12;
# line 267 "../orient_st.st"
	double A0_13;
# line 269 "../orient_st.st"
	double A0_21;
# line 270 "../orient_st.st"
	double A0_22;
# line 271 "../orient_st.st"
	double A0_23;
# line 273 "../orient_st.st"
	double A0_31;
# line 274 "../orient_st.st"
	double A0_32;
# line 275 "../orient_st.st"
	double A0_33;
# line 278 "../orient_st.st"
	double OMTX[3][3];
# line 279 "../orient_st.st"
	double OMTX_i[3][3];
# line 281 "../orient_st.st"
	double OMTX_11;
# line 282 "../orient_st.st"
	double OMTX_12;
# line 283 "../orient_st.st"
	double OMTX_13;
# line 285 "../orient_st.st"
	double OMTX_21;
# line 286 "../orient_st.st"
	double OMTX_22;
# line 287 "../orient_st.st"
	double OMTX_23;
# line 289 "../orient_st.st"
	double OMTX_31;
# line 290 "../orient_st.st"
	double OMTX_32;
# line 291 "../orient_st.st"
	double OMTX_33;
# line 294 "../orient_st.st"
	double errAngle;
# line 295 "../orient_st.st"
	double errAngleThresh;
# line 303 "../orient_st.st"
	double v1_hkl[3];
# line 304 "../orient_st.st"
	double v1_angles[4];
# line 305 "../orient_st.st"
	double v2_hkl[3];
# line 306 "../orient_st.st"
	double v2_angles[4];
# line 307 "../orient_st.st"
	int i;
# line 310 "../orient_st.st"
	short newHKL;
# line 311 "../orient_st.st"
	short newAngles;
# line 312 "../orient_st.st"
	short newMotors;
# line 313 "../orient_st.st"
	short waiting4Mot;
# line 314 "../orient_st.st"
	short waiting4motTTH;
# line 315 "../orient_st.st"
	short waiting4motTH;
# line 316 "../orient_st.st"
	short waiting4motCHI;
# line 317 "../orient_st.st"
	short waiting4motPHI;
# line 318 "../orient_st.st"
	int old_connect_state;
# line 324 "../orient_st.st"
	int A0_state;
# line 325 "../orient_st.st"
	int OMTX_state;
# line 327 "../orient_st.st"
	int weWrote_motTTH;
# line 328 "../orient_st.st"
	int weWrote_motTH;
# line 329 "../orient_st.st"
	int weWrote_motCHI;
# line 330 "../orient_st.st"
	int weWrote_motPHI;
# line 337 "../orient_st.st"
	int startup;
# line 340 "../orient_st.st"
	char *orient_pmac_PM;
# line 341 "../orient_st.st"
	char *orient_pmac_mTTH;
# line 342 "../orient_st.st"
	char *orient_pmac_mTH;
# line 343 "../orient_st.st"
	char *orient_pmac_mCHI;
# line 344 "../orient_st.st"
	char *orient_pmac_mPHI;
};


/* Function declarations */

#define seqg_var (*(struct seqg_vars *const *)seqg_env)

/* Program init func */
static void seqg_init(PROG_ID seqg_env)
{
}

/****** Code for state "init_wait" in state set "orient" ******/

/* Event function for state "init_wait" in state set "orient" */
static seqBool seqg_event_orient_0_init_wait(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 364 "../orient_st.st"
	if (seq_delay(seqg_env, 1))
	{
		*seqg_pnst = 1;
		*seqg_ptrn = 0;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "init_wait" in state set "orient" */
static void seqg_action_orient_0_init_wait(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
# line 365 "../orient_st.st"
			if (seqg_var->A0_state == 2)
			{
# line 365 "../orient_st.st"
				(seqg_var->A0_state) = (0);
# line 365 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 122/*A0_state*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 365 "../orient_st.st"
			;
# line 366 "../orient_st.st"
			if (seqg_var->OMTX_state == 2)
			{
# line 366 "../orient_st.st"
				(seqg_var->OMTX_state) = (0);
# line 366 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 123/*OMTX_state*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 366 "../orient_st.st"
			;
		}
		return;
	}
}

/****** Code for state "init" in state set "orient" ******/

/* Event function for state "init" in state set "orient" */
static seqBool seqg_event_orient_0_init(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 377 "../orient_st.st"
	if (seqg_var->startup != 12345)
	{
		*seqg_pnst = 1;
		*seqg_ptrn = 0;
		return TRUE;
	}
# line 460 "../orient_st.st"
	if (seq_efTest(seqg_env, lambda_mon) || seq_efTest(seqg_env, energy_mon))
	{
		*seqg_pnst = 1;
		*seqg_ptrn = 1;
		return TRUE;
	}
# line 474 "../orient_st.st"
	if (seqg_var->A0_state == 0)
	{
		*seqg_pnst = 1;
		*seqg_ptrn = 2;
		return TRUE;
	}
# line 509 "../orient_st.st"
	if (seqg_var->A0_state == 2)
	{
		*seqg_pnst = 0;
		*seqg_ptrn = 3;
		return TRUE;
	}
# line 513 "../orient_st.st"
	if ((seqg_var->A0_state == 1) && (seqg_var->OMTX_state == 0))
	{
		*seqg_pnst = 1;
		*seqg_ptrn = 4;
		return TRUE;
	}
# line 563 "../orient_st.st"
	if (seqg_var->OMTX_state == 2)
	{
		*seqg_pnst = 0;
		*seqg_ptrn = 5;
		return TRUE;
	}
# line 567 "../orient_st.st"
	if (seqg_var->A0_state == 1 && (seqg_var->OMTX_state == 1))
	{
		*seqg_pnst = 3;
		*seqg_ptrn = 6;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "init" in state set "orient" */
static void seqg_action_orient_0_init(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
# line 378 "../orient_st.st"
			seqg_var->hc = 12.3984244;
# line 379 "../orient_st.st"
			seqg_var->motorsConnected = 0;
# line 380 "../orient_st.st"
			seqg_var->motorStopsConnected = 0;
			pVar->orient_pmac_PM = seq_macValueGet(ssId, "PM");
			pVar->orient_pmac_mTTH = seq_macValueGet(ssId, "mTTH");
			pVar->orient_pmac_mTH = seq_macValueGet(ssId, "mTH");
			pVar->orient_pmac_mCHI = seq_macValueGet(ssId, "mCHI");
			pVar->orient_pmac_mPHI = seq_macValueGet(ssId, "mPHI");
# line 387 "../orient_st.st"
			if (seqg_var->orient_pmac_PM == 0)
			{
				{
# line 388 "../orient_st.st"
					strncpy(seqg_var->Msg, ("motor prefix (PM) not specified"), 39);
# line 388 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
					{
# line 388 "../orient_st.st"
						(seqg_var->Alert) = (1);
# line 388 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 388 "../orient_st.st"
					;
# line 388 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
				}
# line 388 "../orient_st.st"
				;
			}
			else
			{
				/* C code definitions */
# line 390 "../orient_st.st"
				strcpy(pVar->motTTH_name, pVar->orient_pmac_PM);
# line 391 "../orient_st.st"
				strcpy(pVar->motTH_name, pVar->orient_pmac_PM);
# line 392 "../orient_st.st"
				strcpy(pVar->motCHI_name, pVar->orient_pmac_PM);
# line 393 "../orient_st.st"
				strcpy(pVar->motPHI_name, pVar->orient_pmac_PM);
# line 394 "../orient_st.st"
				if (seqg_var->orient_pmac_mTTH == 0)
				{
					{
# line 395 "../orient_st.st"
						strncpy(seqg_var->Msg, ("orient: TTH motor name (mTTH) not specified"), 39);
# line 395 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
						{
# line 395 "../orient_st.st"
							(seqg_var->Alert) = (1);
# line 395 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 395 "../orient_st.st"
						;
# line 395 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
					}
# line 395 "../orient_st.st"
					;
				}
				else
				{
					/* C code definitions */
# line 397 "../orient_st.st"
					strcat(pVar->motTTH_name, pVar->orient_pmac_mTTH);
# line 398 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 10/*motTTH_name*/, DEFAULT, DEFAULT_TIMEOUT);
					strcpy(pVar->tmpstr, pVar->motTTH_name);
					if ((pVar->cp = strrchr(pVar->tmpstr, (int)'.'))) pVar->cp[0] = '\0';
					strcat(pVar->tmpstr, ".STOP");
# line 403 "../orient_st.st"
					seq_pvAssign(seqg_env, 22/*motTTH_stop*/, seqg_var->tmpstr);
					strcpy(pVar->tmpstr, pVar->motTTH_name);
					if ((pVar->cp = strrchr(pVar->tmpstr, (int)'.'))) pVar->cp[0] = '\0';
					strcat(pVar->tmpstr, ".RBV");
# line 408 "../orient_st.st"
					seq_pvAssign(seqg_env, 18/*motTTH_RBV*/, seqg_var->tmpstr);
				}
# line 410 "../orient_st.st"
				if (seqg_var->orient_pmac_mTH == 0)
				{
					{
# line 411 "../orient_st.st"
						strncpy(seqg_var->Msg, ("orient: TH motor name (mTH) not specified"), 39);
# line 411 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
						{
# line 411 "../orient_st.st"
							(seqg_var->Alert) = (1);
# line 411 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 411 "../orient_st.st"
						;
# line 411 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
					}
# line 411 "../orient_st.st"
					;
				}
				else
				{
					/* C code definitions */
# line 413 "../orient_st.st"
					strcat(pVar->motTH_name, pVar->orient_pmac_mTH);
# line 414 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 11/*motTH_name*/, DEFAULT, DEFAULT_TIMEOUT);
					strcpy(pVar->tmpstr, pVar->motTH_name);
					if ((pVar->cp = strrchr(pVar->tmpstr, (int)'.'))) pVar->cp[0] = '\0';
					strcat(pVar->tmpstr, ".STOP");
# line 418 "../orient_st.st"
					seq_pvAssign(seqg_env, 23/*motTH_stop*/, seqg_var->tmpstr);
					strcpy(pVar->tmpstr, pVar->motTH_name);
					if ((pVar->cp = strrchr(pVar->tmpstr, (int)'.'))) pVar->cp[0] = '\0';
					strcat(pVar->tmpstr, ".RBV");
# line 423 "../orient_st.st"
					seq_pvAssign(seqg_env, 19/*motTH_RBV*/, seqg_var->tmpstr);
				}
# line 425 "../orient_st.st"
				if (seqg_var->orient_pmac_mCHI == 0)
				{
					{
# line 426 "../orient_st.st"
						strncpy(seqg_var->Msg, ("orient: CHI motor name (mCHI) not specified"), 39);
# line 426 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
						{
# line 426 "../orient_st.st"
							(seqg_var->Alert) = (1);
# line 426 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 426 "../orient_st.st"
						;
# line 426 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
					}
# line 426 "../orient_st.st"
					;
				}
				else
				{
					/* C code definitions */
# line 428 "../orient_st.st"
					strcat(pVar->motCHI_name, pVar->orient_pmac_mCHI);
# line 429 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 12/*motCHI_name*/, DEFAULT, DEFAULT_TIMEOUT);
					strcpy(pVar->tmpstr, pVar->motCHI_name);
					if ((pVar->cp = strrchr(pVar->tmpstr, (int)'.'))) pVar->cp[0] = '\0';
					strcat(pVar->tmpstr, ".STOP");
# line 433 "../orient_st.st"
					seq_pvAssign(seqg_env, 24/*motCHI_stop*/, seqg_var->tmpstr);
					strcpy(pVar->tmpstr, pVar->motCHI_name);
					if ((pVar->cp = strrchr(pVar->tmpstr, (int)'.'))) pVar->cp[0] = '\0';
					strcat(pVar->tmpstr, ".RBV");
# line 438 "../orient_st.st"
					seq_pvAssign(seqg_env, 20/*motCHI_RBV*/, seqg_var->tmpstr);
				}
# line 440 "../orient_st.st"
				if (seqg_var->orient_pmac_mPHI == 0)
				{
					{
# line 441 "../orient_st.st"
						strncpy(seqg_var->Msg, ("orient: PHI motor name (mPHI) not specified"), 39);
# line 441 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
						{
# line 441 "../orient_st.st"
							(seqg_var->Alert) = (1);
# line 441 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 441 "../orient_st.st"
						;
# line 441 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
					}
# line 441 "../orient_st.st"
					;
				}
				else
				{
					/* C code definitions */
# line 443 "../orient_st.st"
					strcat(pVar->motPHI_name, pVar->orient_pmac_mPHI);
# line 444 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 13/*motPHI_name*/, DEFAULT, DEFAULT_TIMEOUT);
					strcpy(pVar->tmpstr, pVar->motPHI_name);
					if ((pVar->cp = strrchr(pVar->tmpstr, (int)'.'))) pVar->cp[0] = '\0';
					strcat(pVar->tmpstr, ".STOP");
# line 448 "../orient_st.st"
					seq_pvAssign(seqg_env, 25/*motPHI_stop*/, seqg_var->tmpstr);
					strcpy(pVar->tmpstr, pVar->motPHI_name);
					if ((pVar->cp = strrchr(pVar->tmpstr, (int)'.'))) pVar->cp[0] = '\0';
					strcat(pVar->tmpstr, ".RBV");
# line 453 "../orient_st.st"
					seq_pvAssign(seqg_env, 21/*motPHI_RBV*/, seqg_var->tmpstr);
				}
			}
# line 456 "../orient_st.st"
			seqg_var->startup = 12345;
		}
		return;
	case 1:
		{
# line 461 "../orient_st.st"
			if (seq_efTest(seqg_env, lambda_mon))
			{
# line 462 "../orient_st.st"
				seqg_var->energy = seqg_var->hc / seqg_var->lambda;
				{
# line 464 "../orient_st.st"
					(seqg_var->load_energy) = (seqg_var->energy);
# line 464 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 93/*load_energy*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 464 "../orient_st.st"
				;
			}
			else
# line 465 "../orient_st.st"
				if (seq_efTest(seqg_env, energy_mon))
				{
# line 466 "../orient_st.st"
					seqg_var->lambda = seqg_var->hc / seqg_var->energy;
					{
# line 468 "../orient_st.st"
						(seqg_var->load_lambda) = (seqg_var->lambda);
# line 468 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 90/*load_lambda*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 468 "../orient_st.st"
					;
				}
# line 470 "../orient_st.st"
			seq_efClear(seqg_env, lambda_mon);
# line 470 "../orient_st.st"
			seq_efClear(seqg_env, energy_mon);
			{
# line 471 "../orient_st.st"
				(seqg_var->A0_state) = (0);
# line 471 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 122/*A0_state*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 471 "../orient_st.st"
			;
		}
		return;
	case 2:
		{
# line 480 "../orient_st.st"
			if (seqg_var->lambda > 1.0e-9)
			{
# line 481 "../orient_st.st"
				seqg_var->energy = seqg_var->hc / seqg_var->lambda;
				{
# line 483 "../orient_st.st"
					(seqg_var->load_energy) = (seqg_var->energy);
# line 483 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 93/*load_energy*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 483 "../orient_st.st"
				;
# line 484 "../orient_st.st"
				if (seqg_var->orientDebug)
				{
# line 484 "../orient_st.st"
					strncpy(seqg_var->Msg, ("calculated energy"), 39);
# line 484 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 484 "../orient_st.st"
					if (seqg_var->orientDebug)
# line 484 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
				}
# line 484 "../orient_st.st"
				;
			}
			else
# line 485 "../orient_st.st"
				if (seqg_var->energy > 1.0e-9)
				{
# line 486 "../orient_st.st"
					seqg_var->lambda = seqg_var->hc / seqg_var->energy;
					{
# line 488 "../orient_st.st"
						(seqg_var->load_lambda) = (seqg_var->lambda);
# line 488 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 90/*load_lambda*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 488 "../orient_st.st"
					;
				}
# line 490 "../orient_st.st"
			if ((seqg_var->a != 0) && (seqg_var->b != 0) && (seqg_var->c != 0) && (seqg_var->alpha != 0) && (seqg_var->beta != 0) && (seqg_var->Gamma != 0) && (seqg_var->lambda != 0))
			{
# line 491 "../orient_st.st"
				seq_efClear(seqg_env, xtalParm_mon);
# line 491 "../orient_st.st"
				seq_efClear(seqg_env, lambda_mon);
# line 491 "../orient_st.st"
				seq_efClear(seqg_env, energy_mon);
# line 492 "../orient_st.st"
				if (seqg_var->orientDebug)
				{
# line 492 "../orient_st.st"
					strncpy(seqg_var->Msg, ("calling calc_A0"), 39);
# line 492 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 492 "../orient_st.st"
					if (seqg_var->orientDebug)
# line 492 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
				}
# line 492 "../orient_st.st"
				;
				pVar->i = calc_A0(pVar->a, pVar->b, pVar->c, pVar->alpha, pVar->beta, pVar->Gamma,
				pVar->lambda, pVar->A0, pVar->A0_i);
				pVar->A0_11 = pVar->A0[0][0]; pVar->A0_12 = pVar->A0[0][1]; pVar->A0_13 = pVar->A0[0][2];
				pVar->A0_21 = pVar->A0[1][0]; pVar->A0_22 = pVar->A0[1][1]; pVar->A0_23 = pVar->A0[1][2];
				pVar->A0_31 = pVar->A0[2][0]; pVar->A0_32 = pVar->A0[2][1]; pVar->A0_33 = pVar->A0[2][2];
# line 499 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 94/*A0_11*/, DEFAULT, DEFAULT_TIMEOUT);
# line 499 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 95/*A0_12*/, DEFAULT, DEFAULT_TIMEOUT);
# line 499 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 96/*A0_13*/, DEFAULT, DEFAULT_TIMEOUT);
# line 500 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 97/*A0_21*/, DEFAULT, DEFAULT_TIMEOUT);
# line 500 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 98/*A0_22*/, DEFAULT, DEFAULT_TIMEOUT);
# line 500 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 99/*A0_23*/, DEFAULT, DEFAULT_TIMEOUT);
# line 501 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 100/*A0_31*/, DEFAULT, DEFAULT_TIMEOUT);
# line 501 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 101/*A0_32*/, DEFAULT, DEFAULT_TIMEOUT);
# line 501 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 102/*A0_33*/, DEFAULT, DEFAULT_TIMEOUT);
				{
# line 502 "../orient_st.st"
					(seqg_var->A0_state) = ((seqg_var->i == 0 ? 1 : 2));
# line 502 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 122/*A0_state*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 502 "../orient_st.st"
				;
# line 503 "../orient_st.st"
				if (seqg_var->A0_state == 1)
				{
# line 503 "../orient_st.st"
					strncpy(seqg_var->Msg, ("Successful A0 calc"), 39);
# line 503 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 503 "../orient_st.st"
					if (seqg_var->orientDebug)
# line 503 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
				}
# line 503 "../orient_st.st"
				;
			}
			else
			{
				{
# line 505 "../orient_st.st"
					(seqg_var->A0_state) = (2);
# line 505 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 122/*A0_state*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 505 "../orient_st.st"
				;
			}
		}
		return;
	case 3:
		{
		}
		return;
	case 4:
		{
# line 523 "../orient_st.st"
			if ((seqg_var->H1 != 0 || seqg_var->K1 != 0 || seqg_var->L1 != 0) && (seqg_var->H2 != 0 || seqg_var->K2 != 0 || seqg_var->L2 != 0))
			{
# line 524 "../orient_st.st"
				if (seqg_var->orientDebug)
				{
# line 524 "../orient_st.st"
					strncpy(seqg_var->Msg, ("calling calc_OMTX"), 39);
# line 524 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 524 "../orient_st.st"
					if (seqg_var->orientDebug)
# line 524 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
				}
# line 524 "../orient_st.st"
				;
				pVar->v1_hkl[H_INDEX] = pVar->H1; pVar->v1_hkl[K_INDEX] = pVar->K1; pVar->v1_hkl[L_INDEX] = pVar->L1;
				pVar->v1_angles[TTH_INDEX] = pVar->TTH1; pVar->v1_angles[TH_INDEX] = pVar->TH1;
				pVar->v1_angles[CHI_INDEX] = pVar->CHI1; pVar->v1_angles[PHI_INDEX] = pVar->PHI1;
				pVar->v2_hkl[H_INDEX] = pVar->H2; pVar->v2_hkl[K_INDEX] = pVar->K2; pVar->v2_hkl[L_INDEX] = pVar->L2;
				pVar->v2_angles[TTH_INDEX] = pVar->TTH2; pVar->v2_angles[TH_INDEX] = pVar->TH2;
				pVar->v2_angles[CHI_INDEX] = pVar->CHI2; pVar->v2_angles[PHI_INDEX] = pVar->PHI2;
				pVar->i = calc_OMTX(pVar->v1_hkl, pVar->v1_angles, pVar->v2_hkl, pVar->v2_angles,
				pVar->A0, pVar->A0_i, pVar->OMTX, pVar->OMTX_i);
				pVar->OMTX_11 = pVar->OMTX[0][0]; pVar->OMTX_12 = pVar->OMTX[0][1]; pVar->OMTX_13 = pVar->OMTX[0][2];
				pVar->OMTX_21 = pVar->OMTX[1][0]; pVar->OMTX_22 = pVar->OMTX[1][1]; pVar->OMTX_23 = pVar->OMTX[1][2];
				pVar->OMTX_31 = pVar->OMTX[2][0]; pVar->OMTX_32 = pVar->OMTX[2][1]; pVar->OMTX_33 = pVar->OMTX[2][2];
# line 536 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 103/*OMTX_11*/, DEFAULT, DEFAULT_TIMEOUT);
# line 536 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 104/*OMTX_12*/, DEFAULT, DEFAULT_TIMEOUT);
# line 536 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 105/*OMTX_13*/, DEFAULT, DEFAULT_TIMEOUT);
# line 537 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 106/*OMTX_21*/, DEFAULT, DEFAULT_TIMEOUT);
# line 537 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 107/*OMTX_22*/, DEFAULT, DEFAULT_TIMEOUT);
# line 537 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 108/*OMTX_23*/, DEFAULT, DEFAULT_TIMEOUT);
# line 538 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 109/*OMTX_31*/, DEFAULT, DEFAULT_TIMEOUT);
# line 538 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 110/*OMTX_32*/, DEFAULT, DEFAULT_TIMEOUT);
# line 538 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 111/*OMTX_33*/, DEFAULT, DEFAULT_TIMEOUT);
# line 539 "../orient_st.st"
				if (seqg_var->OMTX_Calc)
				{
# line 539 "../orient_st.st"
					(seqg_var->OMTX_Calc) = (0);
# line 539 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 31/*OMTX_Calc*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 539 "../orient_st.st"
				;
				{
# line 540 "../orient_st.st"
					(seqg_var->errAngle) = (checkOMTX(seqg_var->v2_hkl, seqg_var->v2_angles, seqg_var->A0, seqg_var->A0_i, seqg_var->OMTX_i));
# line 540 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 112/*errAngle*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 540 "../orient_st.st"
				;
			}
			else
			{
# line 542 "../orient_st.st"
				seqg_var->i = -1;
			}
# line 550 "../orient_st.st"
			if ((seqg_var->i == 0) && (fabs(seqg_var->errAngle) < seqg_var->errAngleThresh))
			{
				{
# line 552 "../orient_st.st"
					(seqg_var->OMTX_state) = (1);
# line 552 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 123/*OMTX_state*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 552 "../orient_st.st"
				;
				{
# line 553 "../orient_st.st"
					strncpy(seqg_var->Msg, ("Successful OMTX calc"), 39);
# line 553 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 553 "../orient_st.st"
					if (seqg_var->orientDebug)
# line 553 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
				}
# line 553 "../orient_st.st"
				;
			}
			else
			{
				{
# line 555 "../orient_st.st"
					(seqg_var->OMTX_state) = (2);
# line 555 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 123/*OMTX_state*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 555 "../orient_st.st"
				;
# line 556 "../orient_st.st"
				if (seqg_var->motPut_Auto != 0)
				{
					{
# line 557 "../orient_st.st"
						(seqg_var->motPut_Auto) = (0);
# line 557 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 6/*motPut_Auto*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 557 "../orient_st.st"
					;
					{
# line 558 "../orient_st.st"
						strncpy(seqg_var->Msg, ("Bad OMTX calc; motPut_Auto set to Manual"), 39);
# line 558 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
						{
# line 558 "../orient_st.st"
							(seqg_var->Alert) = (1);
# line 558 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 558 "../orient_st.st"
						;
# line 558 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
					}
# line 558 "../orient_st.st"
					;
				}
			}
		}
		return;
	case 5:
		{
		}
		return;
	case 6:
		{
		}
		return;
	}
}

/****** Code for state "ref_show" in state set "orient" ******/

/* Event function for state "ref_show" in state set "orient" */
static seqBool seqg_event_orient_0_ref_show(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 586 "../orient_st.st"
	if (seq_delay(seqg_env, .5))
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 0;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "ref_show" in state set "orient" */
static void seqg_action_orient_0_ref_show(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
			{
# line 587 "../orient_st.st"
				(seqg_var->refGet1) = (0);
# line 587 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 71/*refGet1*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 587 "../orient_st.st"
			;
			{
# line 587 "../orient_st.st"
				(seqg_var->refGet2) = (0);
# line 587 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 80/*refGet2*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 587 "../orient_st.st"
			;
			{
# line 588 "../orient_st.st"
				(seqg_var->refPut1) = (0);
# line 588 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 72/*refPut1*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 588 "../orient_st.st"
			;
			{
# line 588 "../orient_st.st"
				(seqg_var->refPut2) = (0);
# line 588 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 81/*refPut2*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 588 "../orient_st.st"
			;
		}
		return;
	}
}

/****** Code for state "enter_monitor_all" in state set "orient" ******/

/* Event function for state "enter_monitor_all" in state set "orient" */
static seqBool seqg_event_orient_0_enter_monitor_all(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 593 "../orient_st.st"
	if (seq_delay(seqg_env, 10))
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 0;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "enter_monitor_all" in state set "orient" */
static void seqg_action_orient_0_enter_monitor_all(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
# line 595 "../orient_st.st"
			seq_efClear(seqg_env, A0_mon);
# line 595 "../orient_st.st"
			seq_efClear(seqg_env, OMTX_mon);
# line 596 "../orient_st.st"
			seq_efClear(seqg_env, H_mon);
# line 596 "../orient_st.st"
			seq_efClear(seqg_env, K_mon);
# line 596 "../orient_st.st"
			seq_efClear(seqg_env, L_mon);
# line 597 "../orient_st.st"
			seq_efClear(seqg_env, TTH_mon);
# line 597 "../orient_st.st"
			seq_efClear(seqg_env, TH_mon);
# line 597 "../orient_st.st"
			seq_efClear(seqg_env, CHI_mon);
# line 597 "../orient_st.st"
			seq_efClear(seqg_env, PHI_mon);
# line 598 "../orient_st.st"
			seq_efClear(seqg_env, Mode_mon);
			{
# line 599 "../orient_st.st"
				strncpy(seqg_var->Msg, ("Initialization complete; going live"), 39);
# line 599 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 599 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 599 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
			}
# line 599 "../orient_st.st"
			;
		}
		return;
	}
}

/****** Code for state "monitor_all_delay" in state set "orient" ******/

/* Event function for state "monitor_all_delay" in state set "orient" */
static seqBool seqg_event_orient_0_monitor_all_delay(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 605 "../orient_st.st"
	if (seq_delay(seqg_env, 1))
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 0;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "monitor_all_delay" in state set "orient" */
static void seqg_action_orient_0_monitor_all_delay(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
		}
		return;
	}
}

/****** Code for state "monitor_all" in state set "orient" ******/

/* Event function for state "monitor_all" in state set "orient" */
static seqBool seqg_event_orient_0_monitor_all(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 616 "../orient_st.st"
	if (seqg_var->motorsConnected == 0)
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 0;
		return TRUE;
	}
# line 620 "../orient_st.st"
	if (seqg_var->motorStopsConnected == 0)
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 1;
		return TRUE;
	}
# line 625 "../orient_st.st"
	if ((seqg_var->A0_state == 1) && seqg_var->OMTX_Calc)
	{
		*seqg_pnst = 7;
		*seqg_ptrn = 2;
		return TRUE;
	}
# line 656 "../orient_st.st"
	if (seq_efTest(seqg_env, xtalParm_mon) || seq_efTest(seqg_env, lambda_mon) || seq_efTest(seqg_env, energy_mon))
	{
		*seqg_pnst = 8;
		*seqg_ptrn = 3;
		return TRUE;
	}
# line 685 "../orient_st.st"
	if (seq_efTest(seqg_env, A0_mon))
	{
		*seqg_pnst = 6;
		*seqg_ptrn = 4;
		return TRUE;
	}
# line 700 "../orient_st.st"
	if (seq_efTest(seqg_env, OMTX_mon))
	{
		*seqg_pnst = 7;
		*seqg_ptrn = 5;
		return TRUE;
	}
# line 729 "../orient_st.st"
	if (seq_efTest(seqg_env, H_mon))
	{
		*seqg_pnst = 8;
		*seqg_ptrn = 6;
		return TRUE;
	}
# line 735 "../orient_st.st"
	if (seq_efTest(seqg_env, K_mon))
	{
		*seqg_pnst = 8;
		*seqg_ptrn = 7;
		return TRUE;
	}
# line 741 "../orient_st.st"
	if (seq_efTest(seqg_env, L_mon))
	{
		*seqg_pnst = 8;
		*seqg_ptrn = 8;
		return TRUE;
	}
# line 749 "../orient_st.st"
	if (seq_efTest(seqg_env, TTH_mon))
	{
		*seqg_pnst = 9;
		*seqg_ptrn = 9;
		return TRUE;
	}
# line 755 "../orient_st.st"
	if (seq_efTest(seqg_env, TH_mon))
	{
		*seqg_pnst = 9;
		*seqg_ptrn = 10;
		return TRUE;
	}
# line 761 "../orient_st.st"
	if (seq_efTest(seqg_env, CHI_mon))
	{
		*seqg_pnst = 9;
		*seqg_ptrn = 11;
		return TRUE;
	}
# line 767 "../orient_st.st"
	if (seq_efTest(seqg_env, PHI_mon))
	{
		*seqg_pnst = 9;
		*seqg_ptrn = 12;
		return TRUE;
	}
# line 800 "../orient_st.st"
	if (seq_efTest(seqg_env, motTTH_mon) && seqg_var->waiting4motTTH && seq_pvPutComplete(seqg_env, 14/*motTTH*/, 1, FALSE, NULL))
	{
		*seqg_pnst = 10;
		*seqg_ptrn = 13;
		return TRUE;
	}
# line 811 "../orient_st.st"
	if (seq_efTest(seqg_env, motTTH_mon) && seqg_var->weWrote_motTTH)
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 14;
		return TRUE;
	}
# line 815 "../orient_st.st"
	if (seq_efTest(seqg_env, motTTH_mon) && !seqg_var->weWrote_motTTH)
	{
		*seqg_pnst = 11;
		*seqg_ptrn = 15;
		return TRUE;
	}
# line 820 "../orient_st.st"
	if (seq_efTest(seqg_env, motTH_mon) && seqg_var->waiting4motTH && seq_pvPutComplete(seqg_env, 15/*motTH*/, 1, FALSE, NULL))
	{
		*seqg_pnst = 10;
		*seqg_ptrn = 16;
		return TRUE;
	}
# line 825 "../orient_st.st"
	if (seq_efTest(seqg_env, motTH_mon) && seqg_var->weWrote_motTH)
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 17;
		return TRUE;
	}
# line 829 "../orient_st.st"
	if (seq_efTest(seqg_env, motTH_mon) && !seqg_var->weWrote_motTH)
	{
		*seqg_pnst = 11;
		*seqg_ptrn = 18;
		return TRUE;
	}
# line 834 "../orient_st.st"
	if (seq_efTest(seqg_env, motCHI_mon) && seqg_var->waiting4motCHI && seq_pvPutComplete(seqg_env, 16/*motCHI*/, 1, FALSE, NULL))
	{
		*seqg_pnst = 10;
		*seqg_ptrn = 19;
		return TRUE;
	}
# line 839 "../orient_st.st"
	if (seq_efTest(seqg_env, motCHI_mon) && seqg_var->weWrote_motCHI)
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 20;
		return TRUE;
	}
# line 843 "../orient_st.st"
	if (seq_efTest(seqg_env, motCHI_mon) && !seqg_var->weWrote_motCHI)
	{
		*seqg_pnst = 11;
		*seqg_ptrn = 21;
		return TRUE;
	}
# line 848 "../orient_st.st"
	if (seq_efTest(seqg_env, motPHI_mon) && seqg_var->waiting4motPHI && seq_pvPutComplete(seqg_env, 17/*motPHI*/, 1, FALSE, NULL))
	{
		*seqg_pnst = 10;
		*seqg_ptrn = 22;
		return TRUE;
	}
# line 853 "../orient_st.st"
	if (seq_efTest(seqg_env, motPHI_mon) && seqg_var->weWrote_motPHI)
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 23;
		return TRUE;
	}
# line 857 "../orient_st.st"
	if (seq_efTest(seqg_env, motPHI_mon) && !seqg_var->weWrote_motPHI)
	{
		*seqg_pnst = 11;
		*seqg_ptrn = 24;
		return TRUE;
	}
# line 864 "../orient_st.st"
	if (seqg_var->Busy && seqg_var->waiting4Mot && (seqg_var->waiting4motTTH == 0) && (seqg_var->waiting4motTH == 0) && (seqg_var->waiting4motCHI == 0) && (seqg_var->waiting4motPHI == 0))
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 25;
		return TRUE;
	}
# line 878 "../orient_st.st"
	if (seq_efTest(seqg_env, Mode_mon))
	{
		*seqg_pnst = 8;
		*seqg_ptrn = 26;
		return TRUE;
	}
# line 887 "../orient_st.st"
	if (seqg_var->motPut)
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 27;
		return TRUE;
	}
# line 902 "../orient_st.st"
	if (seqg_var->motGet)
	{
		*seqg_pnst = 11;
		*seqg_ptrn = 28;
		return TRUE;
	}
# line 906 "../orient_st.st"
	if (seqg_var->refGet1)
	{
		*seqg_pnst = 2;
		*seqg_ptrn = 29;
		return TRUE;
	}
# line 911 "../orient_st.st"
	if (seqg_var->refGet2)
	{
		*seqg_pnst = 2;
		*seqg_ptrn = 30;
		return TRUE;
	}
# line 917 "../orient_st.st"
	if (seqg_var->refPut1)
	{
		*seqg_pnst = 2;
		*seqg_ptrn = 31;
		return TRUE;
	}
# line 922 "../orient_st.st"
	if (seqg_var->refPut2)
	{
		*seqg_pnst = 2;
		*seqg_ptrn = 32;
		return TRUE;
	}
# line 928 "../orient_st.st"
	if (seqg_var->opAck)
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 33;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "monitor_all" in state set "orient" */
static void seqg_action_orient_0_monitor_all(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
			{
# line 617 "../orient_st.st"
				strncpy(seqg_var->Msg, ("Waiting for motor connection(s)"), 39);
# line 617 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 617 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 617 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
			}
# line 617 "../orient_st.st"
			;
		}
		return;
	case 1:
		{
			{
# line 621 "../orient_st.st"
				strncpy(seqg_var->Msg, ("Waiting for motor-stop connection(s)"), 39);
# line 621 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 621 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 621 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
			}
# line 621 "../orient_st.st"
			;
		}
		return;
	case 2:
		{
# line 627 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 627 "../orient_st.st"
				strncpy(seqg_var->Msg, ("Recalculating OMTX"), 39);
# line 627 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 627 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 627 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
			}
# line 627 "../orient_st.st"
			;
			pVar->v1_hkl[H_INDEX] = pVar->H1; pVar->v1_hkl[K_INDEX] = pVar->K1; pVar->v1_hkl[L_INDEX] = pVar->L1;
			pVar->v1_angles[TTH_INDEX] = pVar->TTH1; pVar->v1_angles[TH_INDEX] = pVar->TH1;
			pVar->v1_angles[CHI_INDEX] = pVar->CHI1; pVar->v1_angles[PHI_INDEX] = pVar->PHI1;
			pVar->v2_hkl[H_INDEX] = pVar->H2; pVar->v2_hkl[K_INDEX] = pVar->K2; pVar->v2_hkl[L_INDEX] = pVar->L2;
			pVar->v2_angles[TTH_INDEX] = pVar->TTH2; pVar->v2_angles[TH_INDEX] = pVar->TH2;
			pVar->v2_angles[CHI_INDEX] = pVar->CHI2; pVar->v2_angles[PHI_INDEX] = pVar->PHI2;
			pVar->i = calc_OMTX(pVar->v1_hkl, pVar->v1_angles, pVar->v2_hkl, pVar->v2_angles,
			pVar->A0, pVar->A0_i, pVar->OMTX, pVar->OMTX_i);
			pVar->OMTX_11 = pVar->OMTX[0][0]; pVar->OMTX_12 = pVar->OMTX[0][1]; pVar->OMTX_13 = pVar->OMTX[0][2];
			pVar->OMTX_21 = pVar->OMTX[1][0]; pVar->OMTX_22 = pVar->OMTX[1][1]; pVar->OMTX_23 = pVar->OMTX[1][2];
			pVar->OMTX_31 = pVar->OMTX[2][0]; pVar->OMTX_32 = pVar->OMTX[2][1]; pVar->OMTX_33 = pVar->OMTX[2][2];
# line 639 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 103/*OMTX_11*/, DEFAULT, DEFAULT_TIMEOUT);
# line 639 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 104/*OMTX_12*/, DEFAULT, DEFAULT_TIMEOUT);
# line 639 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 105/*OMTX_13*/, DEFAULT, DEFAULT_TIMEOUT);
# line 640 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 106/*OMTX_21*/, DEFAULT, DEFAULT_TIMEOUT);
# line 640 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 107/*OMTX_22*/, DEFAULT, DEFAULT_TIMEOUT);
# line 640 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 108/*OMTX_23*/, DEFAULT, DEFAULT_TIMEOUT);
# line 641 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 109/*OMTX_31*/, DEFAULT, DEFAULT_TIMEOUT);
# line 641 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 110/*OMTX_32*/, DEFAULT, DEFAULT_TIMEOUT);
# line 641 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 111/*OMTX_33*/, DEFAULT, DEFAULT_TIMEOUT);
			{
# line 642 "../orient_st.st"
				(seqg_var->OMTX_Calc) = (0);
# line 642 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 31/*OMTX_Calc*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 642 "../orient_st.st"
			;
# line 643 "../orient_st.st"
			seqg_var->errAngle = checkOMTX(seqg_var->v2_hkl, seqg_var->v2_angles, seqg_var->A0, seqg_var->A0_i, seqg_var->OMTX_i);
# line 644 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 112/*errAngle*/, DEFAULT, DEFAULT_TIMEOUT);
# line 645 "../orient_st.st"
			if ((seqg_var->i == 0) && (fabs(seqg_var->errAngle) < seqg_var->errAngleThresh))
			{
				{
# line 647 "../orient_st.st"
					(seqg_var->OMTX_state) = (1);
# line 647 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 123/*OMTX_state*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 647 "../orient_st.st"
				;
			}
			else
			{
				{
# line 649 "../orient_st.st"
					(seqg_var->OMTX_state) = (2);
# line 649 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 123/*OMTX_state*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 649 "../orient_st.st"
				;
				{
# line 650 "../orient_st.st"
					(seqg_var->motPut_Auto) = (0);
# line 650 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 6/*motPut_Auto*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 650 "../orient_st.st"
				;
				{
# line 651 "../orient_st.st"
					strncpy(seqg_var->Msg, ("Bad OMTX calc; motPut_Auto set to Manual"), 39);
# line 651 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
					{
# line 651 "../orient_st.st"
						(seqg_var->Alert) = (1);
# line 651 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 651 "../orient_st.st"
					;
# line 651 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
				}
# line 651 "../orient_st.st"
				;
			}
		}
		return;
	case 3:
		{
# line 657 "../orient_st.st"
			if (seq_efTest(seqg_env, lambda_mon))
			{
# line 658 "../orient_st.st"
				seqg_var->energy = seqg_var->hc / seqg_var->lambda;
				{
# line 660 "../orient_st.st"
					(seqg_var->load_energy) = (seqg_var->energy);
# line 660 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 93/*load_energy*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 660 "../orient_st.st"
				;
			}
			else
# line 661 "../orient_st.st"
				if (seq_efTest(seqg_env, energy_mon))
				{
# line 662 "../orient_st.st"
					seqg_var->lambda = seqg_var->hc / seqg_var->energy;
					{
# line 664 "../orient_st.st"
						(seqg_var->load_lambda) = (seqg_var->lambda);
# line 664 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 90/*load_lambda*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 664 "../orient_st.st"
					;
				}
# line 666 "../orient_st.st"
			seq_efClear(seqg_env, xtalParm_mon);
# line 666 "../orient_st.st"
			seq_efClear(seqg_env, lambda_mon);
# line 666 "../orient_st.st"
			seq_efClear(seqg_env, energy_mon);
# line 667 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 667 "../orient_st.st"
				strncpy(seqg_var->Msg, ("new XTAL parameters"), 39);
# line 667 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 667 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 667 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
			}
# line 667 "../orient_st.st"
			;
			pVar->i = calc_A0(pVar->a, pVar->b, pVar->c, pVar->alpha, pVar->beta,
			pVar->Gamma, pVar->lambda, pVar->A0, pVar->A0_i);
			pVar->A0_11 = pVar->A0[0][0]; pVar->A0_12 = pVar->A0[0][1]; pVar->A0_13 = pVar->A0[0][2];
			pVar->A0_21 = pVar->A0[1][0]; pVar->A0_22 = pVar->A0[1][1]; pVar->A0_23 = pVar->A0[1][2];
			pVar->A0_31 = pVar->A0[2][0]; pVar->A0_32 = pVar->A0[2][1]; pVar->A0_33 = pVar->A0[2][2];
# line 673 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 94/*A0_11*/, DEFAULT, DEFAULT_TIMEOUT);
# line 673 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 95/*A0_12*/, DEFAULT, DEFAULT_TIMEOUT);
# line 673 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 96/*A0_13*/, DEFAULT, DEFAULT_TIMEOUT);
# line 674 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 97/*A0_21*/, DEFAULT, DEFAULT_TIMEOUT);
# line 674 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 98/*A0_22*/, DEFAULT, DEFAULT_TIMEOUT);
# line 674 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 99/*A0_23*/, DEFAULT, DEFAULT_TIMEOUT);
# line 675 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 100/*A0_31*/, DEFAULT, DEFAULT_TIMEOUT);
# line 675 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 101/*A0_32*/, DEFAULT, DEFAULT_TIMEOUT);
# line 675 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 102/*A0_33*/, DEFAULT, DEFAULT_TIMEOUT);
			{
# line 676 "../orient_st.st"
				(seqg_var->A0_state) = ((seqg_var->i == 0 ? 1 : 2));
# line 676 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 122/*A0_state*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 676 "../orient_st.st"
			;
# line 677 "../orient_st.st"
			if (seqg_var->A0_state == 1)
			{
				{
# line 678 "../orient_st.st"
					strncpy(seqg_var->Msg, ("Successful A0 calc"), 39);
# line 678 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 678 "../orient_st.st"
					if (seqg_var->orientDebug)
# line 678 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
				}
# line 678 "../orient_st.st"
				;
			}
			else
			{
				{
# line 680 "../orient_st.st"
					strncpy(seqg_var->Msg, ("A0 calc failed"), 39);
# line 680 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
					{
# line 680 "../orient_st.st"
						(seqg_var->Alert) = (1);
# line 680 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 680 "../orient_st.st"
					;
# line 680 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
				}
# line 680 "../orient_st.st"
				;
			}
		}
		return;
	case 4:
		{
# line 686 "../orient_st.st"
			seq_efClear(seqg_env, A0_mon);
# line 687 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 687 "../orient_st.st"
				strncpy(seqg_var->Msg, ("new A0 precursor(s)"), 39);
# line 687 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 687 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 687 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
			}
# line 687 "../orient_st.st"
			;
			pVar->A0[0][0] = pVar->A0_11; pVar->A0[0][1] = pVar->A0_12; pVar->A0[0][2] = pVar->A0_13;
			pVar->A0[1][0] = pVar->A0_21; pVar->A0[1][1] = pVar->A0_22; pVar->A0[1][2] = pVar->A0_23;
			pVar->A0[2][0] = pVar->A0_31; pVar->A0[2][1] = pVar->A0_32; pVar->A0[2][2] = pVar->A0_33;
# line 692 "../orient_st.st"
			seqg_var->i = invertArray(seqg_var->A0, seqg_var->A0_i);
# line 693 "../orient_st.st"
			if (seqg_var->i == -1)
			{
				{
# line 694 "../orient_st.st"
					strncpy(seqg_var->Msg, ("Could not invert A0 array"), 39);
# line 694 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 694 "../orient_st.st"
					if (seqg_var->orientDebug)
# line 694 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
				}
# line 694 "../orient_st.st"
				;
				{
# line 695 "../orient_st.st"
					(seqg_var->A0_state) = (2);
# line 695 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 122/*A0_state*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 695 "../orient_st.st"
				;
			}
		}
		return;
	case 5:
		{
# line 701 "../orient_st.st"
			seq_efClear(seqg_env, OMTX_mon);
# line 702 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 702 "../orient_st.st"
				strncpy(seqg_var->Msg, ("new OMTX element(s)"), 39);
# line 702 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 702 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 702 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
			}
# line 702 "../orient_st.st"
			;
			pVar->OMTX[0][0] = pVar->OMTX_11; pVar->OMTX[0][1] = pVar->OMTX_12; pVar->OMTX[0][2] = pVar->OMTX_13;
			pVar->OMTX[1][0] = pVar->OMTX_21; pVar->OMTX[1][1] = pVar->OMTX_22; pVar->OMTX[1][2] = pVar->OMTX_23;
			pVar->OMTX[2][0] = pVar->OMTX_31; pVar->OMTX[2][1] = pVar->OMTX_32; pVar->OMTX[2][2] = pVar->OMTX_33;
# line 707 "../orient_st.st"
			seqg_var->i = invertArray(seqg_var->OMTX, seqg_var->OMTX_i);
# line 708 "../orient_st.st"
			if (seqg_var->i == -1)
			{
				{
# line 709 "../orient_st.st"
					strncpy(seqg_var->Msg, ("Could not invert OMTX array"), 39);
# line 709 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 709 "../orient_st.st"
					if (seqg_var->orientDebug)
# line 709 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
				}
# line 709 "../orient_st.st"
				;
				{
# line 710 "../orient_st.st"
					(seqg_var->OMTX_state) = (2);
# line 710 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 123/*OMTX_state*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 710 "../orient_st.st"
				;
			}
			else
# line 711 "../orient_st.st"
				if (seqg_var->A0_state != 1)
				{
					{
# line 712 "../orient_st.st"
						strncpy(seqg_var->Msg, ("Can't check or use OMTX array (No A0)"), 39);
# line 712 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 712 "../orient_st.st"
						if (seqg_var->orientDebug)
# line 712 "../orient_st.st"
							printf("orient: %s\n", seqg_var->Msg);
					}
# line 712 "../orient_st.st"
					;
					{
# line 713 "../orient_st.st"
						(seqg_var->OMTX_state) = (2);
# line 713 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 123/*OMTX_state*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 713 "../orient_st.st"
					;
				}
				else
				{
# line 715 "../orient_st.st"
					seqg_var->errAngle = checkOMTX(seqg_var->v2_hkl, seqg_var->v2_angles, seqg_var->A0, seqg_var->A0_i, seqg_var->OMTX_i);
# line 716 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 112/*errAngle*/, DEFAULT, DEFAULT_TIMEOUT);
# line 717 "../orient_st.st"
					if (fabs(seqg_var->errAngle) < seqg_var->errAngleThresh)
					{
						{
# line 719 "../orient_st.st"
							(seqg_var->OMTX_state) = (1);
# line 719 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 123/*OMTX_state*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 719 "../orient_st.st"
						;
# line 720 "../orient_st.st"
						if (seqg_var->orientDebug)
						{
# line 720 "../orient_st.st"
							strncpy(seqg_var->Msg, ("User's OMTX passes test"), 39);
# line 720 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 720 "../orient_st.st"
							if (seqg_var->orientDebug)
# line 720 "../orient_st.st"
								printf("orient: %s\n", seqg_var->Msg);
						}
# line 720 "../orient_st.st"
						;
					}
					else
					{
						{
# line 722 "../orient_st.st"
							(seqg_var->OMTX_state) = (2);
# line 722 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 123/*OMTX_state*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 722 "../orient_st.st"
						;
# line 723 "../orient_st.st"
						if (seqg_var->orientDebug)
						{
# line 723 "../orient_st.st"
							strncpy(seqg_var->Msg, ("User's OMTX fails test"), 39);
# line 723 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 723 "../orient_st.st"
							if (seqg_var->orientDebug)
# line 723 "../orient_st.st"
								printf("orient: %s\n", seqg_var->Msg);
						}
# line 723 "../orient_st.st"
						;
					}
				}
		}
		return;
	case 6:
		{
# line 730 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 730 "../orient_st.st"
				printf("\norient: client wrote H\n");
			}
# line 731 "../orient_st.st"
			if (!seqg_var->Busy)
			{
# line 731 "../orient_st.st"
				(seqg_var->Busy) = (1);
# line 731 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 32/*Busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 731 "../orient_st.st"
			;
# line 732 "../orient_st.st"
			seq_efClear(seqg_env, H_mon);
		}
		return;
	case 7:
		{
# line 736 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 736 "../orient_st.st"
				printf("\norient: client wrote K\n");
			}
# line 737 "../orient_st.st"
			if (!seqg_var->Busy)
			{
# line 737 "../orient_st.st"
				(seqg_var->Busy) = (1);
# line 737 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 32/*Busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 737 "../orient_st.st"
			;
# line 738 "../orient_st.st"
			seq_efClear(seqg_env, K_mon);
		}
		return;
	case 8:
		{
# line 742 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 742 "../orient_st.st"
				printf("\norient: client wrote L\n");
			}
# line 743 "../orient_st.st"
			if (!seqg_var->Busy)
			{
# line 743 "../orient_st.st"
				(seqg_var->Busy) = (1);
# line 743 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 32/*Busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 743 "../orient_st.st"
			;
# line 744 "../orient_st.st"
			seq_efClear(seqg_env, L_mon);
		}
		return;
	case 9:
		{
# line 750 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 750 "../orient_st.st"
				printf("\norient: client wrote TTH\n");
			}
# line 751 "../orient_st.st"
			if (!seqg_var->Busy)
			{
# line 751 "../orient_st.st"
				(seqg_var->Busy) = (1);
# line 751 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 32/*Busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 751 "../orient_st.st"
			;
# line 752 "../orient_st.st"
			seq_efClear(seqg_env, TTH_mon);
		}
		return;
	case 10:
		{
# line 756 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 756 "../orient_st.st"
				printf("\norient: client wrote TH\n");
			}
# line 757 "../orient_st.st"
			if (!seqg_var->Busy)
			{
# line 757 "../orient_st.st"
				(seqg_var->Busy) = (1);
# line 757 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 32/*Busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 757 "../orient_st.st"
			;
# line 758 "../orient_st.st"
			seq_efClear(seqg_env, TH_mon);
		}
		return;
	case 11:
		{
# line 762 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 762 "../orient_st.st"
				printf("\norient: client wrote CHI\n");
			}
# line 763 "../orient_st.st"
			if (!seqg_var->Busy)
			{
# line 763 "../orient_st.st"
				(seqg_var->Busy) = (1);
# line 763 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 32/*Busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 763 "../orient_st.st"
			;
# line 764 "../orient_st.st"
			seq_efClear(seqg_env, CHI_mon);
		}
		return;
	case 12:
		{
# line 768 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 768 "../orient_st.st"
				printf("\norient: client wrote PHI\n");
			}
# line 769 "../orient_st.st"
			if (!seqg_var->Busy)
			{
# line 769 "../orient_st.st"
				(seqg_var->Busy) = (1);
# line 769 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 32/*Busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 769 "../orient_st.st"
			;
# line 770 "../orient_st.st"
			seq_efClear(seqg_env, PHI_mon);
		}
		return;
	case 13:
		{
# line 801 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 801 "../orient_st.st"
				printf("orient: motTTH done moving\n");
			}
# line 802 "../orient_st.st"
			seq_efClear(seqg_env, motTTH_mon);
			{
# line 802 "../orient_st.st"
				(seqg_var->waiting4motTTH) = (0);
# line 802 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 118/*waiting4motTTH*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 802 "../orient_st.st"
			;
# line 809 "../orient_st.st"
			if (seqg_var->weWrote_motTTH)
			{
# line 809 "../orient_st.st"
				(seqg_var->weWrote_motTTH) = (0);
# line 809 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 124/*weWrote_motTTH*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 809 "../orient_st.st"
			;
		}
		return;
	case 14:
		{
# line 812 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 812 "../orient_st.st"
				printf("orient: We wrote motTTH\n");
			}
# line 813 "../orient_st.st"
			seq_efClear(seqg_env, motTTH_mon);
			{
# line 813 "../orient_st.st"
				(seqg_var->weWrote_motTTH) = (0);
# line 813 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 124/*weWrote_motTTH*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 813 "../orient_st.st"
			;
		}
		return;
	case 15:
		{
# line 816 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 816 "../orient_st.st"
				printf("orient: client wrote motTTH\n");
			}
# line 817 "../orient_st.st"
			seq_efClear(seqg_env, motTTH_mon);
		}
		return;
	case 16:
		{
# line 821 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 821 "../orient_st.st"
				printf("orient: motTH done moving\n");
			}
# line 822 "../orient_st.st"
			seq_efClear(seqg_env, motTH_mon);
			{
# line 822 "../orient_st.st"
				(seqg_var->waiting4motTH) = (0);
# line 822 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 119/*waiting4motTH*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 822 "../orient_st.st"
			;
# line 823 "../orient_st.st"
			if (seqg_var->weWrote_motTH)
			{
# line 823 "../orient_st.st"
				(seqg_var->weWrote_motTH) = (0);
# line 823 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 125/*weWrote_motTH*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 823 "../orient_st.st"
			;
		}
		return;
	case 17:
		{
# line 826 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 826 "../orient_st.st"
				printf("orient: We wrote motTH\n");
			}
# line 827 "../orient_st.st"
			seq_efClear(seqg_env, motTH_mon);
			{
# line 827 "../orient_st.st"
				(seqg_var->weWrote_motTH) = (0);
# line 827 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 125/*weWrote_motTH*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 827 "../orient_st.st"
			;
		}
		return;
	case 18:
		{
# line 830 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 830 "../orient_st.st"
				printf("orient: client wrote motTH\n");
			}
# line 831 "../orient_st.st"
			seq_efClear(seqg_env, motTH_mon);
		}
		return;
	case 19:
		{
# line 835 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 835 "../orient_st.st"
				printf("orient: motCHI done moving\n");
			}
# line 836 "../orient_st.st"
			seq_efClear(seqg_env, motCHI_mon);
			{
# line 836 "../orient_st.st"
				(seqg_var->waiting4motCHI) = (0);
# line 836 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 120/*waiting4motCHI*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 836 "../orient_st.st"
			;
# line 837 "../orient_st.st"
			if (seqg_var->weWrote_motCHI)
			{
# line 837 "../orient_st.st"
				(seqg_var->weWrote_motCHI) = (0);
# line 837 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 126/*weWrote_motCHI*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 837 "../orient_st.st"
			;
		}
		return;
	case 20:
		{
# line 840 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 840 "../orient_st.st"
				printf("orient: We wrote motCHI\n");
			}
# line 841 "../orient_st.st"
			seq_efClear(seqg_env, motCHI_mon);
			{
# line 841 "../orient_st.st"
				(seqg_var->weWrote_motCHI) = (0);
# line 841 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 126/*weWrote_motCHI*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 841 "../orient_st.st"
			;
		}
		return;
	case 21:
		{
# line 844 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 844 "../orient_st.st"
				printf("orient: client wrote motCHI\n");
			}
# line 845 "../orient_st.st"
			seq_efClear(seqg_env, motCHI_mon);
		}
		return;
	case 22:
		{
# line 849 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 849 "../orient_st.st"
				printf("orient: motPHI done moving\n");
			}
# line 850 "../orient_st.st"
			seq_efClear(seqg_env, motPHI_mon);
			{
# line 850 "../orient_st.st"
				(seqg_var->waiting4motPHI) = (0);
# line 850 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 121/*waiting4motPHI*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 850 "../orient_st.st"
			;
# line 851 "../orient_st.st"
			if (seqg_var->weWrote_motPHI)
			{
# line 851 "../orient_st.st"
				(seqg_var->weWrote_motPHI) = (0);
# line 851 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 127/*weWrote_motPHI*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 851 "../orient_st.st"
			;
		}
		return;
	case 23:
		{
# line 854 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 854 "../orient_st.st"
				printf("orient: We wrote motPHI\n");
			}
# line 855 "../orient_st.st"
			seq_efClear(seqg_env, motPHI_mon);
			{
# line 855 "../orient_st.st"
				(seqg_var->weWrote_motPHI) = (0);
# line 855 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 127/*weWrote_motPHI*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 855 "../orient_st.st"
			;
		}
		return;
	case 24:
		{
# line 858 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 858 "../orient_st.st"
				printf("orient: client wrote motPHI\n");
			}
# line 859 "../orient_st.st"
			seq_efClear(seqg_env, motPHI_mon);
		}
		return;
	case 25:
		{
			{
# line 865 "../orient_st.st"
				(seqg_var->waiting4Mot) = (0);
# line 865 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 117/*waiting4Mot*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 865 "../orient_st.st"
			;
			{
# line 866 "../orient_st.st"
				(seqg_var->Busy) = (0);
# line 866 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 32/*Busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 866 "../orient_st.st"
			;
# line 867 "../orient_st.st"
			if (seqg_var->H_busy)
			{
# line 867 "../orient_st.st"
				(seqg_var->H_busy) = (0);
# line 867 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 35/*H_busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 867 "../orient_st.st"
			;
# line 868 "../orient_st.st"
			if (seqg_var->K_busy)
			{
# line 868 "../orient_st.st"
				(seqg_var->K_busy) = (0);
# line 868 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 40/*K_busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 868 "../orient_st.st"
			;
# line 869 "../orient_st.st"
			if (seqg_var->L_busy)
			{
# line 869 "../orient_st.st"
				(seqg_var->L_busy) = (0);
# line 869 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 45/*L_busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 869 "../orient_st.st"
			;
# line 870 "../orient_st.st"
			if (seqg_var->TTH_busy)
			{
# line 870 "../orient_st.st"
				(seqg_var->TTH_busy) = (0);
# line 870 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 50/*TTH_busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 870 "../orient_st.st"
			;
# line 871 "../orient_st.st"
			if (seqg_var->TH_busy)
			{
# line 871 "../orient_st.st"
				(seqg_var->TH_busy) = (0);
# line 871 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 54/*TH_busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 871 "../orient_st.st"
			;
# line 872 "../orient_st.st"
			if (seqg_var->CHI_busy)
			{
# line 872 "../orient_st.st"
				(seqg_var->CHI_busy) = (0);
# line 872 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 58/*CHI_busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 872 "../orient_st.st"
			;
# line 873 "../orient_st.st"
			if (seqg_var->PHI_busy)
			{
# line 873 "../orient_st.st"
				(seqg_var->PHI_busy) = (0);
# line 873 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 62/*PHI_busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 873 "../orient_st.st"
			;
# line 874 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 874 "../orient_st.st"
				printf("motors done\n");
			}
		}
		return;
	case 26:
		{
# line 879 "../orient_st.st"
			seq_efClear(seqg_env, Mode_mon);
# line 880 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
				{
# line 881 "../orient_st.st"
					strncpy(seqg_var->Msg, ("new HKL-to-Angles Mode"), 39);
# line 881 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 881 "../orient_st.st"
					if (seqg_var->orientDebug)
# line 881 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
				}
# line 881 "../orient_st.st"
				;
# line 882 "../orient_st.st"
				printf("...Mode=%d\n", seqg_var->Mode);
			}
		}
		return;
	case 27:
		{
# line 888 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 888 "../orient_st.st"
				printf("orient: motPut==%d\n", seqg_var->motPut);
			}
			{
# line 889 "../orient_st.st"
				(seqg_var->weWrote_motTTH) = (1);
# line 889 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 124/*weWrote_motTTH*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 889 "../orient_st.st"
			;
# line 889 "../orient_st.st"
			seqg_var->motTTH = seqg_var->TTH;
			{
# line 889 "../orient_st.st"
				(seqg_var->waiting4motTTH) = (1);
# line 889 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 118/*waiting4motTTH*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 889 "../orient_st.st"
			;
# line 889 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 14/*motTTH*/, ASYNC, DEFAULT_TIMEOUT);
			{
# line 890 "../orient_st.st"
				(seqg_var->weWrote_motTH) = (1);
# line 890 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 125/*weWrote_motTH*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 890 "../orient_st.st"
			;
# line 890 "../orient_st.st"
			seqg_var->motTH = seqg_var->TH;
			{
# line 890 "../orient_st.st"
				(seqg_var->waiting4motTH) = (1);
# line 890 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 119/*waiting4motTH*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 890 "../orient_st.st"
			;
# line 890 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 15/*motTH*/, ASYNC, DEFAULT_TIMEOUT);
			{
# line 891 "../orient_st.st"
				(seqg_var->weWrote_motCHI) = (1);
# line 891 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 126/*weWrote_motCHI*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 891 "../orient_st.st"
			;
# line 891 "../orient_st.st"
			seqg_var->motCHI = seqg_var->CHI;
			{
# line 891 "../orient_st.st"
				(seqg_var->waiting4motCHI) = (1);
# line 891 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 120/*waiting4motCHI*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 891 "../orient_st.st"
			;
# line 891 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 16/*motCHI*/, ASYNC, DEFAULT_TIMEOUT);
			{
# line 892 "../orient_st.st"
				(seqg_var->weWrote_motPHI) = (1);
# line 892 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 127/*weWrote_motPHI*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 892 "../orient_st.st"
			;
# line 892 "../orient_st.st"
			seqg_var->motPHI = seqg_var->PHI;
			{
# line 892 "../orient_st.st"
				(seqg_var->waiting4motPHI) = (1);
# line 892 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 121/*waiting4motPHI*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 892 "../orient_st.st"
			;
# line 892 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 17/*motPHI*/, ASYNC, DEFAULT_TIMEOUT);
# line 894 "../orient_st.st"
			seqg_var->motPut = 0;
			{
# line 894 "../orient_st.st"
				(seqg_var->load_motPut) = (seqg_var->motPut);
# line 894 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 7/*load_motPut*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 894 "../orient_st.st"
			;
			{
# line 895 "../orient_st.st"
				(seqg_var->waiting4Mot) = (1);
# line 895 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 117/*waiting4Mot*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 895 "../orient_st.st"
			;
		}
		return;
	case 28:
		{
		}
		return;
	case 29:
		{
			{
# line 907 "../orient_st.st"
				(seqg_var->H1) = (seqg_var->H);
# line 907 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 64/*H1*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 907 "../orient_st.st"
			;
			{
# line 907 "../orient_st.st"
				(seqg_var->K1) = (seqg_var->K);
# line 907 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 65/*K1*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 907 "../orient_st.st"
			;
			{
# line 907 "../orient_st.st"
				(seqg_var->L1) = (seqg_var->L);
# line 907 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 66/*L1*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 907 "../orient_st.st"
			;
			{
# line 908 "../orient_st.st"
				(seqg_var->TTH1) = (seqg_var->TTH);
# line 908 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 67/*TTH1*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 908 "../orient_st.st"
			;
			{
# line 908 "../orient_st.st"
				(seqg_var->TH1) = (seqg_var->TH);
# line 908 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 68/*TH1*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 908 "../orient_st.st"
			;
			{
# line 908 "../orient_st.st"
				(seqg_var->CHI1) = (seqg_var->CHI);
# line 908 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 69/*CHI1*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 908 "../orient_st.st"
			;
			{
# line 908 "../orient_st.st"
				(seqg_var->PHI1) = (seqg_var->PHI);
# line 908 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 70/*PHI1*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 908 "../orient_st.st"
			;
		}
		return;
	case 30:
		{
			{
# line 912 "../orient_st.st"
				(seqg_var->H2) = (seqg_var->H);
# line 912 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 73/*H2*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 912 "../orient_st.st"
			;
			{
# line 912 "../orient_st.st"
				(seqg_var->K2) = (seqg_var->K);
# line 912 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 74/*K2*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 912 "../orient_st.st"
			;
			{
# line 912 "../orient_st.st"
				(seqg_var->L2) = (seqg_var->L);
# line 912 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 75/*L2*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 912 "../orient_st.st"
			;
			{
# line 913 "../orient_st.st"
				(seqg_var->TTH2) = (seqg_var->TTH);
# line 913 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 76/*TTH2*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 913 "../orient_st.st"
			;
			{
# line 913 "../orient_st.st"
				(seqg_var->TH2) = (seqg_var->TH);
# line 913 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 77/*TH2*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 913 "../orient_st.st"
			;
			{
# line 913 "../orient_st.st"
				(seqg_var->CHI2) = (seqg_var->CHI);
# line 913 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 78/*CHI2*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 913 "../orient_st.st"
			;
			{
# line 913 "../orient_st.st"
				(seqg_var->PHI2) = (seqg_var->PHI);
# line 913 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 79/*PHI2*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 913 "../orient_st.st"
			;
		}
		return;
	case 31:
		{
			{
# line 918 "../orient_st.st"
				(seqg_var->H) = (seqg_var->H1);
# line 918 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 33/*H*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 918 "../orient_st.st"
			;
			{
# line 918 "../orient_st.st"
				(seqg_var->K) = (seqg_var->K1);
# line 918 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 38/*K*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 918 "../orient_st.st"
			;
			{
# line 918 "../orient_st.st"
				(seqg_var->L) = (seqg_var->L1);
# line 918 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 43/*L*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 918 "../orient_st.st"
			;
			{
# line 919 "../orient_st.st"
				(seqg_var->TTH) = (seqg_var->TTH1);
# line 919 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 48/*TTH*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 919 "../orient_st.st"
			;
			{
# line 919 "../orient_st.st"
				(seqg_var->TH) = (seqg_var->TH1);
# line 919 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 52/*TH*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 919 "../orient_st.st"
			;
			{
# line 919 "../orient_st.st"
				(seqg_var->CHI) = (seqg_var->CHI1);
# line 919 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 56/*CHI*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 919 "../orient_st.st"
			;
			{
# line 919 "../orient_st.st"
				(seqg_var->PHI) = (seqg_var->PHI1);
# line 919 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 60/*PHI*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 919 "../orient_st.st"
			;
		}
		return;
	case 32:
		{
			{
# line 923 "../orient_st.st"
				(seqg_var->H) = (seqg_var->H2);
# line 923 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 33/*H*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 923 "../orient_st.st"
			;
			{
# line 923 "../orient_st.st"
				(seqg_var->K) = (seqg_var->K2);
# line 923 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 38/*K*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 923 "../orient_st.st"
			;
			{
# line 923 "../orient_st.st"
				(seqg_var->L) = (seqg_var->L2);
# line 923 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 43/*L*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 923 "../orient_st.st"
			;
			{
# line 924 "../orient_st.st"
				(seqg_var->TTH) = (seqg_var->TTH2);
# line 924 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 48/*TTH*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 924 "../orient_st.st"
			;
			{
# line 924 "../orient_st.st"
				(seqg_var->TH) = (seqg_var->TH2);
# line 924 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 52/*TH*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 924 "../orient_st.st"
			;
			{
# line 924 "../orient_st.st"
				(seqg_var->CHI) = (seqg_var->CHI2);
# line 924 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 56/*CHI*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 924 "../orient_st.st"
			;
			{
# line 924 "../orient_st.st"
				(seqg_var->PHI) = (seqg_var->PHI2);
# line 924 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 60/*PHI*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 924 "../orient_st.st"
			;
		}
		return;
	case 33:
		{
			{
# line 929 "../orient_st.st"
				strncpy(seqg_var->Msg, (""), 39);
# line 929 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 929 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 929 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
			}
# line 929 "../orient_st.st"
			;
			{
# line 930 "../orient_st.st"
				(seqg_var->opAck) = (0);
# line 930 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 3/*opAck*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 930 "../orient_st.st"
			;
			{
# line 931 "../orient_st.st"
				(seqg_var->Alert) = (0);
# line 931 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 931 "../orient_st.st"
			;
		}
		return;
	}
}

/****** Code for state "newA0" in state set "orient" ******/

/* Event function for state "newA0" in state set "orient" */
static seqBool seqg_event_orient_0_newA0(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 943 "../orient_st.st"
	if (seqg_var->A0_state != 1)
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 0;
		return TRUE;
	}
# line 945 "../orient_st.st"
	if (seqg_var->A0_state == 1)
	{
		*seqg_pnst = 8;
		*seqg_ptrn = 1;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "newA0" in state set "orient" */
static void seqg_action_orient_0_newA0(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
		}
		return;
	case 1:
		{
		}
		return;
	}
}

/****** Code for state "newOMTX" in state set "orient" ******/

/* Event function for state "newOMTX" in state set "orient" */
static seqBool seqg_event_orient_0_newOMTX(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 954 "../orient_st.st"
	if (seqg_var->OMTX_state == 1)
	{
		*seqg_pnst = 8;
		*seqg_ptrn = 0;
		return TRUE;
	}
# line 956 "../orient_st.st"
	if (seqg_var->OMTX_state != 1)
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 1;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "newOMTX" in state set "orient" */
static void seqg_action_orient_0_newOMTX(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
		}
		return;
	case 1:
		{
			{
# line 957 "../orient_st.st"
				(seqg_var->motPut_Auto) = (0);
# line 957 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 6/*motPut_Auto*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 957 "../orient_st.st"
			;
			{
# line 958 "../orient_st.st"
				strncpy(seqg_var->Msg, ("Bad OMTX calc; motPut_Auto set to Manual"), 39);
# line 958 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
				{
# line 958 "../orient_st.st"
					(seqg_var->Alert) = (1);
# line 958 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 958 "../orient_st.st"
				;
# line 958 "../orient_st.st"
				printf("orient: %s\n", seqg_var->Msg);
			}
# line 958 "../orient_st.st"
			;
		}
		return;
	}
}

/****** Code for state "newHKL" in state set "orient" ******/

/* Event function for state "newHKL" in state set "orient" */
static seqBool seqg_event_orient_0_newHKL(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 970 "../orient_st.st"
	if ((seqg_var->A0_state != 1) || (seqg_var->OMTX_state != 1))
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 0;
		return TRUE;
	}
# line 977 "../orient_st.st"
	if (seq_delay(seqg_env, 0.02))
	{
		*seqg_pnst = 12;
		*seqg_ptrn = 1;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "newHKL" in state set "orient" */
static void seqg_action_orient_0_newHKL(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
# line 971 "../orient_st.st"
			if (seqg_var->A0_state != 1)
			{
				{
# line 972 "../orient_st.st"
					strncpy(seqg_var->Msg, ("We don't have a good A0 matrix"), 39);
# line 972 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
					{
# line 972 "../orient_st.st"
						(seqg_var->Alert) = (1);
# line 972 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 972 "../orient_st.st"
					;
# line 972 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
				}
# line 972 "../orient_st.st"
				;
			}
			else
			{
				{
# line 974 "../orient_st.st"
					strncpy(seqg_var->Msg, ("We don't have a good OMTX matrix"), 39);
# line 974 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
					{
# line 974 "../orient_st.st"
						(seqg_var->Alert) = (1);
# line 974 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 974 "../orient_st.st"
					;
# line 974 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
				}
# line 974 "../orient_st.st"
				;
			}
		}
		return;
	case 1:
		{
# line 978 "../orient_st.st"
			if (seq_efTest(seqg_env, H_mon))
			{
# line 978 "../orient_st.st"
				seq_efClear(seqg_env, H_mon);
# line 978 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 978 "../orient_st.st"
					printf("orient:newHKL: client also wrote H\n");
			}
# line 979 "../orient_st.st"
			if (seq_efTest(seqg_env, K_mon))
			{
# line 979 "../orient_st.st"
				seq_efClear(seqg_env, K_mon);
# line 979 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 979 "../orient_st.st"
					printf("orient:newHKL: client also wrote K\n");
			}
# line 980 "../orient_st.st"
			if (seq_efTest(seqg_env, L_mon))
			{
# line 980 "../orient_st.st"
				seq_efClear(seqg_env, L_mon);
# line 980 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 980 "../orient_st.st"
					printf("orient:newHKL: client also wrote L\n");
			}
			pVar->hkl[H_INDEX] = pVar->H; pVar->hkl[K_INDEX] = pVar->K; pVar->hkl[L_INDEX] = pVar->L;
			pVar->angles[TTH_INDEX] = pVar->TTH; pVar->angles[TH_INDEX] = pVar->TH;
			pVar->angles[CHI_INDEX] = pVar->CHI; pVar->angles[PHI_INDEX] = pVar->PHI;
			pVar->i = HKL_to_angles(pVar->hkl, pVar->A0, pVar->OMTX, pVar->angles, (int)pVar->Mode);
# line 986 "../orient_st.st"
			if (seqg_var->i == 0)
			{
				/* C code definitions */
# line 987 "../orient_st.st"
				pVar->TTH = pVar->angles[TTH_INDEX];
# line 988 "../orient_st.st"
				pVar->TH = pVar->angles[TH_INDEX];
# line 989 "../orient_st.st"
				pVar->CHI = pVar->angles[CHI_INDEX];
# line 990 "../orient_st.st"
				pVar->PHI = pVar->angles[PHI_INDEX];
				{
# line 991 "../orient_st.st"
					(seqg_var->newAngles) = (1);
# line 991 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 115/*newAngles*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 991 "../orient_st.st"
				;
# line 992 "../orient_st.st"
				if (seqg_var->motPut_Auto)
				{
# line 992 "../orient_st.st"
					(seqg_var->newMotors) = (1);
# line 992 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 116/*newMotors*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 992 "../orient_st.st"
				;
			}
			else
# line 993 "../orient_st.st"
				if (seqg_var->i)
				{
					{
# line 994 "../orient_st.st"
						strncpy(seqg_var->Msg, ("Bad HKL2angles calc."), 39);
# line 994 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
						{
# line 994 "../orient_st.st"
							(seqg_var->Alert) = (1);
# line 994 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 994 "../orient_st.st"
						;
# line 994 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
					}
# line 994 "../orient_st.st"
					;
				}
		}
		return;
	}
}

/****** Code for state "newAngles" in state set "orient" ******/

/* Event function for state "newAngles" in state set "orient" */
static seqBool seqg_event_orient_0_newAngles(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 1005 "../orient_st.st"
	if ((seqg_var->A0_state != 1) || (seqg_var->OMTX_state != 1))
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 0;
		return TRUE;
	}
# line 1012 "../orient_st.st"
	if (seq_delay(seqg_env, 0.02))
	{
		*seqg_pnst = 12;
		*seqg_ptrn = 1;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "newAngles" in state set "orient" */
static void seqg_action_orient_0_newAngles(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
# line 1006 "../orient_st.st"
			if (seqg_var->A0_state != 1)
			{
				{
# line 1007 "../orient_st.st"
					strncpy(seqg_var->Msg, ("We don't have a good A0 matrix"), 39);
# line 1007 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
					{
# line 1007 "../orient_st.st"
						(seqg_var->Alert) = (1);
# line 1007 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 1007 "../orient_st.st"
					;
# line 1007 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
				}
# line 1007 "../orient_st.st"
				;
			}
			else
			{
				{
# line 1009 "../orient_st.st"
					strncpy(seqg_var->Msg, ("We don't have a good OMTX matrix"), 39);
# line 1009 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
					{
# line 1009 "../orient_st.st"
						(seqg_var->Alert) = (1);
# line 1009 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 1009 "../orient_st.st"
					;
# line 1009 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
				}
# line 1009 "../orient_st.st"
				;
			}
		}
		return;
	case 1:
		{
# line 1013 "../orient_st.st"
			if (seq_efTest(seqg_env, TTH_mon))
			{
# line 1013 "../orient_st.st"
				seq_efClear(seqg_env, TTH_mon);
# line 1013 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 1013 "../orient_st.st"
					printf("orient:newAngles: client also wrote TTH\n");
			}
# line 1014 "../orient_st.st"
			if (seq_efTest(seqg_env, TH_mon))
			{
# line 1014 "../orient_st.st"
				seq_efClear(seqg_env, TH_mon);
# line 1014 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 1014 "../orient_st.st"
					printf("orient:newAngles: client also wrote TH\n");
			}
# line 1015 "../orient_st.st"
			if (seq_efTest(seqg_env, CHI_mon))
			{
# line 1015 "../orient_st.st"
				seq_efClear(seqg_env, CHI_mon);
# line 1015 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 1015 "../orient_st.st"
					printf("orient:newAngles: client also wrote CHI\n");
			}
# line 1016 "../orient_st.st"
			if (seq_efTest(seqg_env, PHI_mon))
			{
# line 1016 "../orient_st.st"
				seq_efClear(seqg_env, PHI_mon);
# line 1016 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 1016 "../orient_st.st"
					printf("orient:newAngles: client also wrote PHI\n");
			}
			pVar->angles[TTH_INDEX] = pVar->TTH; pVar->angles[TH_INDEX] = pVar->TH;
			pVar->angles[CHI_INDEX] = pVar->CHI; pVar->angles[PHI_INDEX] = pVar->PHI;
			angles_to_HKL(pVar->angles, pVar->OMTX_i, pVar->A0_i, pVar->hkl);
			pVar->H = pVar->hkl[H_INDEX]; pVar->K = pVar->hkl[K_INDEX]; pVar->L = pVar->hkl[L_INDEX];
			{
# line 1022 "../orient_st.st"
				(seqg_var->newHKL) = (1);
# line 1022 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 114/*newHKL*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1022 "../orient_st.st"
			;
# line 1023 "../orient_st.st"
			if (seqg_var->motPut_Auto)
			{
				{
# line 1024 "../orient_st.st"
					(seqg_var->newMotors) = (1);
# line 1024 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 116/*newMotors*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1024 "../orient_st.st"
				;
			}
		}
		return;
	}
}

/****** Code for state "checkDone" in state set "orient" ******/

/* Event function for state "checkDone" in state set "orient" */
static seqBool seqg_event_orient_0_checkDone(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 1032 "../orient_st.st"
	if (seqg_var->Busy && seqg_var->waiting4Mot && (seqg_var->waiting4motTTH == 0) && (seqg_var->waiting4motTH == 0) && (seqg_var->waiting4motCHI == 0) && (seqg_var->waiting4motPHI == 0))
	{
		*seqg_pnst = 11;
		*seqg_ptrn = 0;
		return TRUE;
	}
	if (TRUE)
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 1;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "checkDone" in state set "orient" */
static void seqg_action_orient_0_checkDone(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
			{
# line 1033 "../orient_st.st"
				(seqg_var->waiting4Mot) = (0);
# line 1033 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 117/*waiting4Mot*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1033 "../orient_st.st"
			;
			{
# line 1034 "../orient_st.st"
				(seqg_var->Busy) = (0);
# line 1034 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 32/*Busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1034 "../orient_st.st"
			;
# line 1035 "../orient_st.st"
			if (seqg_var->H_busy)
			{
# line 1035 "../orient_st.st"
				(seqg_var->H_busy) = (0);
# line 1035 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 35/*H_busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1035 "../orient_st.st"
			;
# line 1036 "../orient_st.st"
			if (seqg_var->K_busy)
			{
# line 1036 "../orient_st.st"
				(seqg_var->K_busy) = (0);
# line 1036 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 40/*K_busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1036 "../orient_st.st"
			;
# line 1037 "../orient_st.st"
			if (seqg_var->L_busy)
			{
# line 1037 "../orient_st.st"
				(seqg_var->L_busy) = (0);
# line 1037 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 45/*L_busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1037 "../orient_st.st"
			;
# line 1038 "../orient_st.st"
			if (seqg_var->TTH_busy)
			{
# line 1038 "../orient_st.st"
				(seqg_var->TTH_busy) = (0);
# line 1038 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 50/*TTH_busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1038 "../orient_st.st"
			;
# line 1039 "../orient_st.st"
			if (seqg_var->TH_busy)
			{
# line 1039 "../orient_st.st"
				(seqg_var->TH_busy) = (0);
# line 1039 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 54/*TH_busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1039 "../orient_st.st"
			;
# line 1040 "../orient_st.st"
			if (seqg_var->CHI_busy)
			{
# line 1040 "../orient_st.st"
				(seqg_var->CHI_busy) = (0);
# line 1040 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 58/*CHI_busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1040 "../orient_st.st"
			;
# line 1041 "../orient_st.st"
			if (seqg_var->PHI_busy)
			{
# line 1041 "../orient_st.st"
				(seqg_var->PHI_busy) = (0);
# line 1041 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 62/*PHI_busy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1041 "../orient_st.st"
			;
# line 1042 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 1042 "../orient_st.st"
				printf("motors done\n");
			}
		}
		return;
	case 1:
		{
		}
		return;
	}
}

/****** Code for state "newMotors" in state set "orient" ******/

/* Event function for state "newMotors" in state set "orient" */
static seqBool seqg_event_orient_0_newMotors(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
	if (TRUE)
	{
		*seqg_pnst = 12;
		*seqg_ptrn = 0;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "newMotors" in state set "orient" */
static void seqg_action_orient_0_newMotors(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
# line 1051 "../orient_st.st"
			if (seqg_var->orientDebug)
			{
# line 1051 "../orient_st.st"
				printf("orient:newMotors: motGet=%d\n", seqg_var->motGet);
			}
# line 1052 "../orient_st.st"
			if (seqg_var->motGet || (seqg_var->motGet_Auto && !seqg_var->waiting4Mot))
			{
# line 1054 "../orient_st.st"
				if (seqg_var->orientDebug)
				{
# line 1054 "../orient_st.st"
					printf("orient:newMotors: getting values\n");
				}
# line 1055 "../orient_st.st"
				seqg_var->TTH = seqg_var->motTTH;
# line 1055 "../orient_st.st"
				seqg_var->TH = seqg_var->motTH;
# line 1055 "../orient_st.st"
				seqg_var->CHI = seqg_var->motCHI;
# line 1055 "../orient_st.st"
				seqg_var->PHI = seqg_var->motPHI;
				{
# line 1056 "../orient_st.st"
					(seqg_var->newAngles) = (1);
# line 1056 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 115/*newAngles*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1056 "../orient_st.st"
				;
				pVar->angles[TTH_INDEX] = pVar->TTH; pVar->angles[TH_INDEX] = pVar->TH;
				pVar->angles[CHI_INDEX] = pVar->CHI; pVar->angles[PHI_INDEX] = pVar->PHI;
				angles_to_HKL(pVar->angles, pVar->OMTX_i, pVar->A0_i, pVar->hkl);
				pVar->H = pVar->hkl[H_INDEX]; pVar->K = pVar->hkl[K_INDEX]; pVar->L = pVar->hkl[L_INDEX];
				{
# line 1062 "../orient_st.st"
					(seqg_var->newHKL) = (1);
# line 1062 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 114/*newHKL*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1062 "../orient_st.st"
				;
# line 1063 "../orient_st.st"
				if (seqg_var->motGet)
				{
# line 1063 "../orient_st.st"
					(seqg_var->motGet) = (0);
# line 1063 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 8/*motGet*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1063 "../orient_st.st"
				;
			}
		}
		return;
	}
}

/****** Code for state "putAll" in state set "orient" ******/

/* Event function for state "putAll" in state set "orient" */
static seqBool seqg_event_orient_0_putAll(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
	if (TRUE)
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 0;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "putAll" in state set "orient" */
static void seqg_action_orient_0_putAll(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
# line 1079 "../orient_st.st"
			if (seqg_var->newHKL)
			{
# line 1080 "../orient_st.st"
				if (seqg_var->orientDebug)
				{
# line 1080 "../orient_st.st"
					printf("orient:putAll: writing HKL\n");
				}
				{
# line 1082 "../orient_st.st"
					(seqg_var->loadH) = (seqg_var->H);
# line 1082 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 36/*loadH*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1082 "../orient_st.st"
				;
				{
# line 1083 "../orient_st.st"
					(seqg_var->loadK) = (seqg_var->K);
# line 1083 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 41/*loadK*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1083 "../orient_st.st"
				;
				{
# line 1084 "../orient_st.st"
					(seqg_var->loadL) = (seqg_var->L);
# line 1084 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 46/*loadL*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1084 "../orient_st.st"
				;
				{
# line 1085 "../orient_st.st"
					(seqg_var->newHKL) = (0);
# line 1085 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 114/*newHKL*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1085 "../orient_st.st"
				;
			}
# line 1087 "../orient_st.st"
			if (seqg_var->newAngles)
			{
# line 1088 "../orient_st.st"
				if (seqg_var->orientDebug)
				{
# line 1088 "../orient_st.st"
					printf("orient:putAll: writing Angles\n");
				}
				{
# line 1090 "../orient_st.st"
					(seqg_var->loadTTH) = (seqg_var->TTH);
# line 1090 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 51/*loadTTH*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1090 "../orient_st.st"
				;
				{
# line 1091 "../orient_st.st"
					(seqg_var->loadTH) = (seqg_var->TH);
# line 1091 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 55/*loadTH*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1091 "../orient_st.st"
				;
				{
# line 1092 "../orient_st.st"
					(seqg_var->loadCHI) = (seqg_var->CHI);
# line 1092 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 59/*loadCHI*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1092 "../orient_st.st"
				;
				{
# line 1093 "../orient_st.st"
					(seqg_var->loadPHI) = (seqg_var->PHI);
# line 1093 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 63/*loadPHI*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1093 "../orient_st.st"
				;
				{
# line 1094 "../orient_st.st"
					(seqg_var->newAngles) = (0);
# line 1094 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 115/*newAngles*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1094 "../orient_st.st"
				;
			}
# line 1096 "../orient_st.st"
			if (seqg_var->newMotors)
			{
# line 1097 "../orient_st.st"
				if (seqg_var->orientDebug)
				{
# line 1097 "../orient_st.st"
					printf("orient:putAll: comparing new/old Motor values\n");
				}
# line 1098 "../orient_st.st"
				if (seqg_var->motTTH_Connected && seqg_var->motTH_Connected && seqg_var->motCHI_Connected && seqg_var->motPHI_Connected)
				{
# line 1099 "../orient_st.st"
					if (seqg_var->orientDebug)
# line 1099 "../orient_st.st"
						printf("putAll:newMotors: H=%8.4f, K=%8.4f, L=%8.4f\n", seqg_var->H, seqg_var->K, seqg_var->L);
# line 1100 "../orient_st.st"
					if ((fabs((seqg_var->motTTH) - (seqg_var->TTH)) > 1.0e-9))
					{
# line 1101 "../orient_st.st"
						if (seqg_var->orientDebug)
# line 1101 "../orient_st.st"
							printf("putAll:newMotors: TTH=%8.4f, motTTH=%8.4f\n", seqg_var->TTH, seqg_var->motTTH);
						{
# line 1102 "../orient_st.st"
							(seqg_var->weWrote_motTTH) = (1);
# line 1102 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 124/*weWrote_motTTH*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 1102 "../orient_st.st"
						;
						{
# line 1102 "../orient_st.st"
							(seqg_var->waiting4motTTH) = (1);
# line 1102 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 118/*waiting4motTTH*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 1102 "../orient_st.st"
						;
# line 1103 "../orient_st.st"
						seqg_var->motTTH = seqg_var->TTH;
# line 1103 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 14/*motTTH*/, ASYNC, DEFAULT_TIMEOUT);
					}
# line 1105 "../orient_st.st"
					if ((fabs((seqg_var->motTH) - (seqg_var->TH)) > 1.0e-9))
					{
# line 1106 "../orient_st.st"
						if (seqg_var->orientDebug)
# line 1106 "../orient_st.st"
							printf("putAll:newMotors:  TH=%8.4f,  motTH=%8.4f\n", seqg_var->TH, seqg_var->motTH);
						{
# line 1107 "../orient_st.st"
							(seqg_var->weWrote_motTH) = (1);
# line 1107 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 125/*weWrote_motTH*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 1107 "../orient_st.st"
						;
						{
# line 1107 "../orient_st.st"
							(seqg_var->waiting4motTH) = (1);
# line 1107 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 119/*waiting4motTH*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 1107 "../orient_st.st"
						;
# line 1108 "../orient_st.st"
						seqg_var->motTH = seqg_var->TH;
# line 1108 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 15/*motTH*/, ASYNC, DEFAULT_TIMEOUT);
					}
# line 1110 "../orient_st.st"
					if ((fabs((seqg_var->motCHI) - (seqg_var->CHI)) > 1.0e-9))
					{
# line 1111 "../orient_st.st"
						if (seqg_var->orientDebug)
# line 1111 "../orient_st.st"
							printf("putAll:newMotors: CHI=%8.4f, motCHI=%8.4f\n", seqg_var->CHI, seqg_var->motCHI);
						{
# line 1112 "../orient_st.st"
							(seqg_var->weWrote_motCHI) = (1);
# line 1112 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 126/*weWrote_motCHI*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 1112 "../orient_st.st"
						;
						{
# line 1112 "../orient_st.st"
							(seqg_var->waiting4motCHI) = (1);
# line 1112 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 120/*waiting4motCHI*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 1112 "../orient_st.st"
						;
# line 1113 "../orient_st.st"
						seqg_var->motCHI = seqg_var->CHI;
# line 1113 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 16/*motCHI*/, ASYNC, DEFAULT_TIMEOUT);
					}
# line 1115 "../orient_st.st"
					if ((fabs((seqg_var->motPHI) - (seqg_var->PHI)) > 1.0e-9))
					{
# line 1116 "../orient_st.st"
						if (seqg_var->orientDebug)
# line 1116 "../orient_st.st"
							printf("putAll:newMotors: PHI=%8.4f, motPHI=%8.4f\n", seqg_var->PHI, seqg_var->motPHI);
						{
# line 1117 "../orient_st.st"
							(seqg_var->weWrote_motPHI) = (1);
# line 1117 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 127/*weWrote_motPHI*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 1117 "../orient_st.st"
						;
						{
# line 1117 "../orient_st.st"
							(seqg_var->waiting4motPHI) = (1);
# line 1117 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 121/*waiting4motPHI*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 1117 "../orient_st.st"
						;
# line 1118 "../orient_st.st"
						seqg_var->motPHI = seqg_var->PHI;
# line 1118 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 17/*motPHI*/, ASYNC, DEFAULT_TIMEOUT);
					}
# line 1120 "../orient_st.st"
					if (seqg_var->waiting4motTTH || seqg_var->waiting4motTH || seqg_var->waiting4motCHI || seqg_var->waiting4motPHI)
					{
						{
# line 1121 "../orient_st.st"
							(seqg_var->waiting4Mot) = (1);
# line 1121 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 117/*waiting4Mot*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 1121 "../orient_st.st"
						;
# line 1122 "../orient_st.st"
						if (!seqg_var->Busy)
						{
# line 1122 "../orient_st.st"
							(seqg_var->Busy) = (1);
# line 1122 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 32/*Busy*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 1122 "../orient_st.st"
						;
					}
					{
# line 1124 "../orient_st.st"
						(seqg_var->newMotors) = (0);
# line 1124 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 116/*newMotors*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 1124 "../orient_st.st"
					;
				}
				else
				{
					{
# line 1126 "../orient_st.st"
						strncpy(seqg_var->Msg, ("Motors not connected"), 39);
# line 1126 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
						{
# line 1126 "../orient_st.st"
							(seqg_var->Alert) = (1);
# line 1126 "../orient_st.st"
							seq_pvPutTmo(seqg_env, 2/*Alert*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 1126 "../orient_st.st"
						;
# line 1126 "../orient_st.st"
						printf("orient: %s\n", seqg_var->Msg);
					}
# line 1126 "../orient_st.st"
					;
					{
# line 1127 "../orient_st.st"
						(seqg_var->newMotors) = (0);
# line 1127 "../orient_st.st"
						seq_pvPutTmo(seqg_env, 116/*newMotors*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 1127 "../orient_st.st"
					;
				}
			}
# line 1131 "../orient_st.st"
			if (!seqg_var->waiting4Mot)
			{
# line 1132 "../orient_st.st"
				if (seqg_var->Busy)
				{
# line 1132 "../orient_st.st"
					(seqg_var->Busy) = (0);
# line 1132 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 32/*Busy*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1132 "../orient_st.st"
				;
# line 1133 "../orient_st.st"
				if (seqg_var->H_busy)
				{
# line 1133 "../orient_st.st"
					(seqg_var->H_busy) = (0);
# line 1133 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 35/*H_busy*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1133 "../orient_st.st"
				;
# line 1134 "../orient_st.st"
				if (seqg_var->K_busy)
				{
# line 1134 "../orient_st.st"
					(seqg_var->K_busy) = (0);
# line 1134 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 40/*K_busy*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1134 "../orient_st.st"
				;
# line 1135 "../orient_st.st"
				if (seqg_var->L_busy)
				{
# line 1135 "../orient_st.st"
					(seqg_var->L_busy) = (0);
# line 1135 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 45/*L_busy*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1135 "../orient_st.st"
				;
# line 1136 "../orient_st.st"
				if (seqg_var->TTH_busy)
				{
# line 1136 "../orient_st.st"
					(seqg_var->TTH_busy) = (0);
# line 1136 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 50/*TTH_busy*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1136 "../orient_st.st"
				;
# line 1137 "../orient_st.st"
				if (seqg_var->TH_busy)
				{
# line 1137 "../orient_st.st"
					(seqg_var->TH_busy) = (0);
# line 1137 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 54/*TH_busy*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1137 "../orient_st.st"
				;
# line 1138 "../orient_st.st"
				if (seqg_var->CHI_busy)
				{
# line 1138 "../orient_st.st"
					(seqg_var->CHI_busy) = (0);
# line 1138 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 58/*CHI_busy*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1138 "../orient_st.st"
				;
# line 1139 "../orient_st.st"
				if (seqg_var->PHI_busy)
				{
# line 1139 "../orient_st.st"
					(seqg_var->PHI_busy) = (0);
# line 1139 "../orient_st.st"
					seq_pvPutTmo(seqg_env, 62/*PHI_busy*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 1139 "../orient_st.st"
				;
# line 1140 "../orient_st.st"
				if (seqg_var->orientDebug)
				{
# line 1140 "../orient_st.st"
					printf("orient:putAll: all complete (no motors)\n");
				}
			}
		}
		return;
	}
}

/****** Code for state "check" in state set "connections" ******/

/* Event function for state "check" in state set "connections" */
static seqBool seqg_event_connections_1_check(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 1151 "../orient_st.st"
	if (seq_delay(seqg_env, 1))
	{
		*seqg_pnst = 0;
		*seqg_ptrn = 0;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "check" in state set "connections" */
static void seqg_action_connections_1_check(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
# line 1152 "../orient_st.st"
			seqg_var->old_connect_state = seqg_var->motTTH_Connected;
# line 1153 "../orient_st.st"
			seqg_var->motTTH_Connected = seq_pvAssigned(seqg_env, 14/*motTTH*/) ? seq_pvConnected(seqg_env, 14/*motTTH*/) : 0;
# line 1154 "../orient_st.st"
			if (seqg_var->old_connect_state != seqg_var->motTTH_Connected)
# line 1154 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 27/*motTTH_Connected*/, DEFAULT, DEFAULT_TIMEOUT);
# line 1156 "../orient_st.st"
			seqg_var->old_connect_state = seqg_var->motTH_Connected;
# line 1157 "../orient_st.st"
			seqg_var->motTH_Connected = seq_pvAssigned(seqg_env, 15/*motTH*/) ? seq_pvConnected(seqg_env, 15/*motTH*/) : 0;
# line 1158 "../orient_st.st"
			if (seqg_var->old_connect_state != seqg_var->motTH_Connected)
# line 1158 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 28/*motTH_Connected*/, DEFAULT, DEFAULT_TIMEOUT);
# line 1160 "../orient_st.st"
			seqg_var->old_connect_state = seqg_var->motCHI_Connected;
# line 1161 "../orient_st.st"
			seqg_var->motCHI_Connected = seq_pvAssigned(seqg_env, 16/*motCHI*/) ? seq_pvConnected(seqg_env, 16/*motCHI*/) : 0;
# line 1162 "../orient_st.st"
			if (seqg_var->old_connect_state != seqg_var->motCHI_Connected)
# line 1162 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 29/*motCHI_Connected*/, DEFAULT, DEFAULT_TIMEOUT);
# line 1164 "../orient_st.st"
			seqg_var->old_connect_state = seqg_var->motPHI_Connected;
# line 1165 "../orient_st.st"
			seqg_var->motPHI_Connected = seq_pvAssigned(seqg_env, 17/*motPHI*/) ? seq_pvConnected(seqg_env, 17/*motPHI*/) : 0;
# line 1166 "../orient_st.st"
			if (seqg_var->old_connect_state != seqg_var->motPHI_Connected)
# line 1166 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 30/*motPHI_Connected*/, DEFAULT, DEFAULT_TIMEOUT);
# line 1169 "../orient_st.st"
			seqg_var->motorsConnected = seqg_var->motTTH_Connected && seqg_var->motTH_Connected && seqg_var->motCHI_Connected && seqg_var->motPHI_Connected;
# line 1174 "../orient_st.st"
			seqg_var->motorStopsConnected = seq_pvAssigned(seqg_env, 22/*motTTH_stop*/) && seq_pvConnected(seqg_env, 22/*motTTH_stop*/) && seq_pvAssigned(seqg_env, 23/*motTH_stop*/) && seq_pvConnected(seqg_env, 23/*motTH_stop*/) && seq_pvAssigned(seqg_env, 24/*motCHI_stop*/) && seq_pvConnected(seqg_env, 24/*motCHI_stop*/) && seq_pvAssigned(seqg_env, 25/*motPHI_stop*/) && seq_pvConnected(seqg_env, 25/*motPHI_stop*/);
		}
		return;
	}
}

/****** Code for state "rbv_monitor_throttle" in state set "readback" ******/

/* Event function for state "rbv_monitor_throttle" in state set "readback" */
static seqBool seqg_event_readback_2_rbv_monitor_throttle(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 1182 "../orient_st.st"
	if (seq_delay(seqg_env, .1))
	{
		*seqg_pnst = 2;
		*seqg_ptrn = 0;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "rbv_monitor_throttle" in state set "readback" */
static void seqg_action_readback_2_rbv_monitor_throttle(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
		}
		return;
	}
}

/****** Code for state "rbv_monitor_wait" in state set "readback" ******/

/* Event function for state "rbv_monitor_wait" in state set "readback" */
static seqBool seqg_event_readback_2_rbv_monitor_wait(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 1187 "../orient_st.st"
	if ((seqg_var->A0_state == 1) && (seqg_var->OMTX_state == 1))
	{
		*seqg_pnst = 2;
		*seqg_ptrn = 0;
		return TRUE;
	}
# line 1190 "../orient_st.st"
	if (seq_delay(seqg_env, 5))
	{
		*seqg_pnst = 2;
		*seqg_ptrn = 1;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "rbv_monitor_wait" in state set "readback" */
static void seqg_action_readback_2_rbv_monitor_wait(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
		}
		return;
	case 1:
		{
		}
		return;
	}
}

/****** Code for state "rbv_monitor" in state set "readback" ******/

/* Event function for state "rbv_monitor" in state set "readback" */
static seqBool seqg_event_readback_2_rbv_monitor(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 1195 "../orient_st.st"
	if ((seqg_var->A0_state != 1) || (seqg_var->OMTX_state != 1))
	{
		*seqg_pnst = 1;
		*seqg_ptrn = 0;
		return TRUE;
	}
# line 1201 "../orient_st.st"
	if (seq_efTest(seqg_env, motRBV_mon))
	{
		*seqg_pnst = 0;
		*seqg_ptrn = 1;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "rbv_monitor" in state set "readback" */
static void seqg_action_readback_2_rbv_monitor(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
# line 1196 "../orient_st.st"
			if (seqg_var->H_RBV != 0)
			{
# line 1196 "../orient_st.st"
				(seqg_var->H_RBV) = (0);
# line 1196 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 37/*H_RBV*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1196 "../orient_st.st"
			;
# line 1197 "../orient_st.st"
			if (seqg_var->K_RBV != 0)
			{
# line 1197 "../orient_st.st"
				(seqg_var->K_RBV) = (0);
# line 1197 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 42/*K_RBV*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1197 "../orient_st.st"
			;
# line 1198 "../orient_st.st"
			if (seqg_var->L_RBV != 0)
			{
# line 1198 "../orient_st.st"
				(seqg_var->L_RBV) = (0);
# line 1198 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 47/*L_RBV*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1198 "../orient_st.st"
			;
		}
		return;
	case 1:
		{
# line 1202 "../orient_st.st"
			seq_efClear(seqg_env, motRBV_mon);
			pVar->rbv_angles[TTH_INDEX] = pVar->motTTH_RBV; pVar->rbv_angles[TH_INDEX] = pVar->motTH_RBV;
			pVar->rbv_angles[CHI_INDEX] = pVar->motCHI_RBV; pVar->rbv_angles[PHI_INDEX] = pVar->motPHI_RBV;
			angles_to_HKL(pVar->rbv_angles, pVar->OMTX_i, pVar->A0_i, pVar->rbv_hkl);
			pVar->H_RBV = pVar->rbv_hkl[H_INDEX]; pVar->K_RBV = pVar->rbv_hkl[K_INDEX]; pVar->L_RBV = pVar->rbv_hkl[L_INDEX];
# line 1208 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 37/*H_RBV*/, DEFAULT, DEFAULT_TIMEOUT);
# line 1208 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 42/*K_RBV*/, DEFAULT, DEFAULT_TIMEOUT);
# line 1208 "../orient_st.st"
			seq_pvPutTmo(seqg_env, 47/*L_RBV*/, DEFAULT, DEFAULT_TIMEOUT);
		}
		return;
	}
}

/****** Code for state "stop_all" in state set "stop" ******/

/* Event function for state "stop_all" in state set "stop" */
static seqBool seqg_event_stop_3_stop_all(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 1216 "../orient_st.st"
	if (seqg_var->stopMotors)
	{
		*seqg_pnst = 0;
		*seqg_ptrn = 0;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "stop_all" in state set "stop" */
static void seqg_action_stop_3_stop_all(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
			{
# line 1217 "../orient_st.st"
				strncpy(seqg_var->Msg, ("stopping motors"), 39);
# line 1217 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 1/*Msg*/, DEFAULT, DEFAULT_TIMEOUT);
# line 1217 "../orient_st.st"
				if (seqg_var->orientDebug)
# line 1217 "../orient_st.st"
					printf("orient: %s\n", seqg_var->Msg);
			}
# line 1217 "../orient_st.st"
			;
# line 1218 "../orient_st.st"
			if (seq_pvAssigned(seqg_env, 22/*motTTH_stop*/) && seq_pvConnected(seqg_env, 22/*motTTH_stop*/))
			{
# line 1218 "../orient_st.st"
				(seqg_var->motTTH_stop) = (1);
# line 1218 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 22/*motTTH_stop*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1218 "../orient_st.st"
			;
# line 1219 "../orient_st.st"
			if (seq_pvAssigned(seqg_env, 23/*motTH_stop*/) && seq_pvConnected(seqg_env, 23/*motTH_stop*/))
			{
# line 1219 "../orient_st.st"
				(seqg_var->motTH_stop) = (1);
# line 1219 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 23/*motTH_stop*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1219 "../orient_st.st"
			;
# line 1220 "../orient_st.st"
			if (seq_pvAssigned(seqg_env, 24/*motCHI_stop*/) && seq_pvConnected(seqg_env, 24/*motCHI_stop*/))
			{
# line 1220 "../orient_st.st"
				(seqg_var->motCHI_stop) = (1);
# line 1220 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 24/*motCHI_stop*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1220 "../orient_st.st"
			;
# line 1221 "../orient_st.st"
			if (seq_pvAssigned(seqg_env, 25/*motPHI_stop*/) && seq_pvConnected(seqg_env, 25/*motPHI_stop*/))
			{
# line 1221 "../orient_st.st"
				(seqg_var->motPHI_stop) = (1);
# line 1221 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 25/*motPHI_stop*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1221 "../orient_st.st"
			;
			{
# line 1222 "../orient_st.st"
				(seqg_var->stopMotors) = (0);
# line 1222 "../orient_st.st"
				seq_pvPutTmo(seqg_env, 26/*stopMotors*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 1222 "../orient_st.st"
			;
		}
		return;
	}
}

#undef seqg_var

/************************ Tables ************************/

/* Channel table */
static seqChan seqg_chans[] = {
	/* chName, offset, varName, varType, count, eventNum, efId, monitored, queueSize, queueIndex */
	{"{P}Debug", offsetof(struct seqg_vars, orientDebug), "orientDebug", P_SHORT, 1, 21, 0, 1, 0, 0},
	{"{P}Msg", offsetof(struct seqg_vars, Msg), "Msg", P_STRING, 1, 22, 0, 0, 0, 0},
	{"{P}Alert", offsetof(struct seqg_vars, Alert), "Alert", P_SHORT, 1, 23, 0, 0, 0, 0},
	{"{P}OperAck", offsetof(struct seqg_vars, opAck), "opAck", P_SHORT, 1, 24, 0, 1, 0, 0},
	{"{P}Mode", offsetof(struct seqg_vars, Mode), "Mode", P_SHORT, 1, 25, 1, 1, 0, 0},
	{"{P}motPut", offsetof(struct seqg_vars, motPut), "motPut", P_SHORT, 1, 26, 2, 1, 0, 0},
	{"{P}motPut_Auto", offsetof(struct seqg_vars, motPut_Auto), "motPut_Auto", P_SHORT, 1, 27, 0, 1, 0, 0},
	{"{P}load_motPut", offsetof(struct seqg_vars, load_motPut), "load_motPut", P_SHORT, 1, 28, 0, 0, 0, 0},
	{"{P}motGet", offsetof(struct seqg_vars, motGet), "motGet", P_SHORT, 1, 29, 3, 1, 0, 0},
	{"{P}motGet_Auto", offsetof(struct seqg_vars, motGet_Auto), "motGet_Auto", P_SHORT, 1, 30, 0, 1, 0, 0},
	{"{P}motTTH_name", offsetof(struct seqg_vars, motTTH_name), "motTTH_name", P_STRING, 1, 31, 0, 1, 0, 0},
	{"{P}motTH_name", offsetof(struct seqg_vars, motTH_name), "motTH_name", P_STRING, 1, 32, 0, 1, 0, 0},
	{"{P}motCHI_name", offsetof(struct seqg_vars, motCHI_name), "motCHI_name", P_STRING, 1, 33, 0, 1, 0, 0},
	{"{P}motPHI_name", offsetof(struct seqg_vars, motPHI_name), "motPHI_name", P_STRING, 1, 34, 0, 1, 0, 0},
	{"{PM}{mTTH}", offsetof(struct seqg_vars, motTTH), "motTTH", P_DOUBLE, 1, 35, 4, 1, 0, 0},
	{"{PM}{mTH}", offsetof(struct seqg_vars, motTH), "motTH", P_DOUBLE, 1, 36, 5, 1, 0, 0},
	{"{PM}{mCHI}", offsetof(struct seqg_vars, motCHI), "motCHI", P_DOUBLE, 1, 37, 6, 1, 0, 0},
	{"{PM}{mPHI}", offsetof(struct seqg_vars, motPHI), "motPHI", P_DOUBLE, 1, 38, 7, 1, 0, 0},
	{"", offsetof(struct seqg_vars, motTTH_RBV), "motTTH_RBV", P_DOUBLE, 1, 39, 8, 1, 0, 0},
	{"", offsetof(struct seqg_vars, motTH_RBV), "motTH_RBV", P_DOUBLE, 1, 40, 8, 1, 0, 0},
	{"", offsetof(struct seqg_vars, motCHI_RBV), "motCHI_RBV", P_DOUBLE, 1, 41, 8, 1, 0, 0},
	{"", offsetof(struct seqg_vars, motPHI_RBV), "motPHI_RBV", P_DOUBLE, 1, 42, 8, 1, 0, 0},
	{"", offsetof(struct seqg_vars, motTTH_stop), "motTTH_stop", P_INT, 1, 43, 0, 0, 0, 0},
	{"", offsetof(struct seqg_vars, motTH_stop), "motTH_stop", P_INT, 1, 44, 0, 0, 0, 0},
	{"", offsetof(struct seqg_vars, motCHI_stop), "motCHI_stop", P_INT, 1, 45, 0, 0, 0, 0},
	{"", offsetof(struct seqg_vars, motPHI_stop), "motPHI_stop", P_INT, 1, 46, 0, 0, 0, 0},
	{"{P}stopMotors", offsetof(struct seqg_vars, stopMotors), "stopMotors", P_INT, 1, 47, 0, 1, 0, 0},
	{"{P}motTTH_Connected", offsetof(struct seqg_vars, motTTH_Connected), "motTTH_Connected", P_INT, 1, 48, 0, 0, 0, 0},
	{"{P}motTH_Connected", offsetof(struct seqg_vars, motTH_Connected), "motTH_Connected", P_INT, 1, 49, 0, 0, 0, 0},
	{"{P}motCHI_Connected", offsetof(struct seqg_vars, motCHI_Connected), "motCHI_Connected", P_INT, 1, 50, 0, 0, 0, 0},
	{"{P}motPHI_Connected", offsetof(struct seqg_vars, motPHI_Connected), "motPHI_Connected", P_INT, 1, 51, 0, 0, 0, 0},
	{"{P}OMTX_Calc", offsetof(struct seqg_vars, OMTX_Calc), "OMTX_Calc", P_SHORT, 1, 52, 0, 1, 0, 0},
	{"{P}Busy", offsetof(struct seqg_vars, Busy), "Busy", P_SHORT, 1, 53, 0, 1, 0, 0},
	{"{P}H", offsetof(struct seqg_vars, H), "H", P_DOUBLE, 1, 54, 0, 1, 0, 0},
	{"{P}H_event", offsetof(struct seqg_vars, H_event), "H_event", P_DOUBLE, 1, 55, 9, 1, 0, 0},
	{"{P}H_busy", offsetof(struct seqg_vars, H_busy), "H_busy", P_SHORT, 1, 56, 0, 1, 0, 0},
	{"{P}loadH", offsetof(struct seqg_vars, loadH), "loadH", P_DOUBLE, 1, 57, 0, 0, 0, 0},
	{"{P}H_RBV", offsetof(struct seqg_vars, H_RBV), "H_RBV", P_DOUBLE, 1, 58, 0, 0, 0, 0},
	{"{P}K", offsetof(struct seqg_vars, K), "K", P_DOUBLE, 1, 59, 0, 1, 0, 0},
	{"{P}K_event", offsetof(struct seqg_vars, K_event), "K_event", P_DOUBLE, 1, 60, 10, 1, 0, 0},
	{"{P}K_busy", offsetof(struct seqg_vars, K_busy), "K_busy", P_SHORT, 1, 61, 0, 1, 0, 0},
	{"{P}loadK", offsetof(struct seqg_vars, loadK), "loadK", P_DOUBLE, 1, 62, 0, 0, 0, 0},
	{"{P}K_RBV", offsetof(struct seqg_vars, K_RBV), "K_RBV", P_DOUBLE, 1, 63, 0, 0, 0, 0},
	{"{P}L", offsetof(struct seqg_vars, L), "L", P_DOUBLE, 1, 64, 0, 1, 0, 0},
	{"{P}L_event", offsetof(struct seqg_vars, L_event), "L_event", P_DOUBLE, 1, 65, 11, 1, 0, 0},
	{"{P}L_busy", offsetof(struct seqg_vars, L_busy), "L_busy", P_SHORT, 1, 66, 0, 1, 0, 0},
	{"{P}loadL", offsetof(struct seqg_vars, loadL), "loadL", P_DOUBLE, 1, 67, 0, 0, 0, 0},
	{"{P}L_RBV", offsetof(struct seqg_vars, L_RBV), "L_RBV", P_DOUBLE, 1, 68, 0, 0, 0, 0},
	{"{P}TTH", offsetof(struct seqg_vars, TTH), "TTH", P_DOUBLE, 1, 69, 0, 1, 0, 0},
	{"{P}TTH_event", offsetof(struct seqg_vars, TTH_event), "TTH_event", P_DOUBLE, 1, 70, 12, 1, 0, 0},
	{"{P}TTH_busy", offsetof(struct seqg_vars, TTH_busy), "TTH_busy", P_SHORT, 1, 71, 0, 1, 0, 0},
	{"{P}loadTTH", offsetof(struct seqg_vars, loadTTH), "loadTTH", P_DOUBLE, 1, 72, 0, 0, 0, 0},
	{"{P}TH", offsetof(struct seqg_vars, TH), "TH", P_DOUBLE, 1, 73, 0, 1, 0, 0},
	{"{P}TH_event", offsetof(struct seqg_vars, TH_event), "TH_event", P_DOUBLE, 1, 74, 13, 1, 0, 0},
	{"{P}TH_busy", offsetof(struct seqg_vars, TH_busy), "TH_busy", P_SHORT, 1, 75, 0, 1, 0, 0},
	{"{P}loadTH", offsetof(struct seqg_vars, loadTH), "loadTH", P_DOUBLE, 1, 76, 0, 0, 0, 0},
	{"{P}CHI", offsetof(struct seqg_vars, CHI), "CHI", P_DOUBLE, 1, 77, 0, 1, 0, 0},
	{"{P}CHI_event", offsetof(struct seqg_vars, CHI_event), "CHI_event", P_DOUBLE, 1, 78, 14, 1, 0, 0},
	{"{P}CHI_busy", offsetof(struct seqg_vars, CHI_busy), "CHI_busy", P_SHORT, 1, 79, 0, 1, 0, 0},
	{"{P}loadCHI", offsetof(struct seqg_vars, loadCHI), "loadCHI", P_DOUBLE, 1, 80, 0, 0, 0, 0},
	{"{P}PHI", offsetof(struct seqg_vars, PHI), "PHI", P_DOUBLE, 1, 81, 0, 1, 0, 0},
	{"{P}PHI_event", offsetof(struct seqg_vars, PHI_event), "PHI_event", P_DOUBLE, 1, 82, 15, 1, 0, 0},
	{"{P}PHI_busy", offsetof(struct seqg_vars, PHI_busy), "PHI_busy", P_SHORT, 1, 83, 0, 1, 0, 0},
	{"{P}loadPHI", offsetof(struct seqg_vars, loadPHI), "loadPHI", P_DOUBLE, 1, 84, 0, 0, 0, 0},
	{"{P}H1", offsetof(struct seqg_vars, H1), "H1", P_DOUBLE, 1, 85, 0, 1, 0, 0},
	{"{P}K1", offsetof(struct seqg_vars, K1), "K1", P_DOUBLE, 1, 86, 0, 1, 0, 0},
	{"{P}L1", offsetof(struct seqg_vars, L1), "L1", P_DOUBLE, 1, 87, 0, 1, 0, 0},
	{"{P}TTH1", offsetof(struct seqg_vars, TTH1), "TTH1", P_DOUBLE, 1, 88, 0, 1, 0, 0},
	{"{P}TH1", offsetof(struct seqg_vars, TH1), "TH1", P_DOUBLE, 1, 89, 0, 1, 0, 0},
	{"{P}CHI1", offsetof(struct seqg_vars, CHI1), "CHI1", P_DOUBLE, 1, 90, 0, 1, 0, 0},
	{"{P}PHI1", offsetof(struct seqg_vars, PHI1), "PHI1", P_DOUBLE, 1, 91, 0, 1, 0, 0},
	{"{P}refGet1", offsetof(struct seqg_vars, refGet1), "refGet1", P_SHORT, 1, 92, 0, 1, 0, 0},
	{"{P}refPut1", offsetof(struct seqg_vars, refPut1), "refPut1", P_SHORT, 1, 93, 0, 1, 0, 0},
	{"{P}H2", offsetof(struct seqg_vars, H2), "H2", P_DOUBLE, 1, 94, 0, 1, 0, 0},
	{"{P}K2", offsetof(struct seqg_vars, K2), "K2", P_DOUBLE, 1, 95, 0, 1, 0, 0},
	{"{P}L2", offsetof(struct seqg_vars, L2), "L2", P_DOUBLE, 1, 96, 0, 1, 0, 0},
	{"{P}TTH2", offsetof(struct seqg_vars, TTH2), "TTH2", P_DOUBLE, 1, 97, 0, 1, 0, 0},
	{"{P}TH2", offsetof(struct seqg_vars, TH2), "TH2", P_DOUBLE, 1, 98, 0, 1, 0, 0},
	{"{P}CHI2", offsetof(struct seqg_vars, CHI2), "CHI2", P_DOUBLE, 1, 99, 0, 1, 0, 0},
	{"{P}PHI2", offsetof(struct seqg_vars, PHI2), "PHI2", P_DOUBLE, 1, 100, 0, 1, 0, 0},
	{"{P}refGet2", offsetof(struct seqg_vars, refGet2), "refGet2", P_SHORT, 1, 101, 0, 1, 0, 0},
	{"{P}refPut2", offsetof(struct seqg_vars, refPut2), "refPut2", P_SHORT, 1, 102, 0, 1, 0, 0},
	{"{P}a", offsetof(struct seqg_vars, a), "a", P_DOUBLE, 1, 103, 16, 1, 0, 0},
	{"{P}b", offsetof(struct seqg_vars, b), "b", P_DOUBLE, 1, 104, 16, 1, 0, 0},
	{"{P}c", offsetof(struct seqg_vars, c), "c", P_DOUBLE, 1, 105, 16, 1, 0, 0},
	{"{P}alpha", offsetof(struct seqg_vars, alpha), "alpha", P_DOUBLE, 1, 106, 16, 1, 0, 0},
	{"{P}beta", offsetof(struct seqg_vars, beta), "beta", P_DOUBLE, 1, 107, 16, 1, 0, 0},
	{"{P}gamma", offsetof(struct seqg_vars, Gamma), "Gamma", P_DOUBLE, 1, 108, 16, 1, 0, 0},
	{"{P}lambda", offsetof(struct seqg_vars, lambda), "lambda", P_DOUBLE, 1, 109, 0, 1, 0, 0},
	{"{P}lambda_event", offsetof(struct seqg_vars, lambda_event), "lambda_event", P_DOUBLE, 1, 110, 17, 1, 0, 0},
	{"{P}load_lambda", offsetof(struct seqg_vars, load_lambda), "load_lambda", P_DOUBLE, 1, 111, 0, 0, 0, 0},
	{"{P}energy", offsetof(struct seqg_vars, energy), "energy", P_DOUBLE, 1, 112, 0, 1, 0, 0},
	{"{P}energy_event", offsetof(struct seqg_vars, energy_event), "energy_event", P_DOUBLE, 1, 113, 18, 1, 0, 0},
	{"{P}load_energy", offsetof(struct seqg_vars, load_energy), "load_energy", P_DOUBLE, 1, 114, 0, 0, 0, 0},
	{"{P}A0_11", offsetof(struct seqg_vars, A0_11), "A0_11", P_DOUBLE, 1, 115, 19, 1, 0, 0},
	{"{P}A0_12", offsetof(struct seqg_vars, A0_12), "A0_12", P_DOUBLE, 1, 116, 19, 1, 0, 0},
	{"{P}A0_13", offsetof(struct seqg_vars, A0_13), "A0_13", P_DOUBLE, 1, 117, 19, 1, 0, 0},
	{"{P}A0_21", offsetof(struct seqg_vars, A0_21), "A0_21", P_DOUBLE, 1, 118, 19, 1, 0, 0},
	{"{P}A0_22", offsetof(struct seqg_vars, A0_22), "A0_22", P_DOUBLE, 1, 119, 19, 1, 0, 0},
	{"{P}A0_23", offsetof(struct seqg_vars, A0_23), "A0_23", P_DOUBLE, 1, 120, 19, 1, 0, 0},
	{"{P}A0_31", offsetof(struct seqg_vars, A0_31), "A0_31", P_DOUBLE, 1, 121, 19, 1, 0, 0},
	{"{P}A0_32", offsetof(struct seqg_vars, A0_32), "A0_32", P_DOUBLE, 1, 122, 19, 1, 0, 0},
	{"{P}A0_33", offsetof(struct seqg_vars, A0_33), "A0_33", P_DOUBLE, 1, 123, 19, 1, 0, 0},
	{"{P}OMTX_11", offsetof(struct seqg_vars, OMTX_11), "OMTX_11", P_DOUBLE, 1, 124, 20, 1, 0, 0},
	{"{P}OMTX_12", offsetof(struct seqg_vars, OMTX_12), "OMTX_12", P_DOUBLE, 1, 125, 20, 1, 0, 0},
	{"{P}OMTX_13", offsetof(struct seqg_vars, OMTX_13), "OMTX_13", P_DOUBLE, 1, 126, 20, 1, 0, 0},
	{"{P}OMTX_21", offsetof(struct seqg_vars, OMTX_21), "OMTX_21", P_DOUBLE, 1, 127, 20, 1, 0, 0},
	{"{P}OMTX_22", offsetof(struct seqg_vars, OMTX_22), "OMTX_22", P_DOUBLE, 1, 128, 20, 1, 0, 0},
	{"{P}OMTX_23", offsetof(struct seqg_vars, OMTX_23), "OMTX_23", P_DOUBLE, 1, 129, 20, 1, 0, 0},
	{"{P}OMTX_31", offsetof(struct seqg_vars, OMTX_31), "OMTX_31", P_DOUBLE, 1, 130, 20, 1, 0, 0},
	{"{P}OMTX_32", offsetof(struct seqg_vars, OMTX_32), "OMTX_32", P_DOUBLE, 1, 131, 20, 1, 0, 0},
	{"{P}OMTX_33", offsetof(struct seqg_vars, OMTX_33), "OMTX_33", P_DOUBLE, 1, 132, 20, 1, 0, 0},
	{"{P}errAngle", offsetof(struct seqg_vars, errAngle), "errAngle", P_DOUBLE, 1, 133, 0, 0, 0, 0},
	{"{P}errAngleThresh", offsetof(struct seqg_vars, errAngleThresh), "errAngleThresh", P_DOUBLE, 1, 134, 0, 1, 0, 0},
	{"{P}newHKL", offsetof(struct seqg_vars, newHKL), "newHKL", P_SHORT, 1, 135, 0, 0, 0, 0},
	{"{P}newAngles", offsetof(struct seqg_vars, newAngles), "newAngles", P_SHORT, 1, 136, 0, 0, 0, 0},
	{"{P}newMotors", offsetof(struct seqg_vars, newMotors), "newMotors", P_SHORT, 1, 137, 0, 0, 0, 0},
	{"{P}waiting4Mot", offsetof(struct seqg_vars, waiting4Mot), "waiting4Mot", P_SHORT, 1, 138, 0, 0, 0, 0},
	{"{P}waiting4motTTH", offsetof(struct seqg_vars, waiting4motTTH), "waiting4motTTH", P_SHORT, 1, 139, 0, 1, 0, 0},
	{"{P}waiting4motTH", offsetof(struct seqg_vars, waiting4motTH), "waiting4motTH", P_SHORT, 1, 140, 0, 1, 0, 0},
	{"{P}waiting4motCHI", offsetof(struct seqg_vars, waiting4motCHI), "waiting4motCHI", P_SHORT, 1, 141, 0, 1, 0, 0},
	{"{P}waiting4motPHI", offsetof(struct seqg_vars, waiting4motPHI), "waiting4motPHI", P_SHORT, 1, 142, 0, 1, 0, 0},
	{"{P}A0_state", offsetof(struct seqg_vars, A0_state), "A0_state", P_INT, 1, 143, 0, 1, 0, 0},
	{"{P}OMTX_state", offsetof(struct seqg_vars, OMTX_state), "OMTX_state", P_INT, 1, 144, 0, 1, 0, 0},
	{"{P}weWrote_motTTH", offsetof(struct seqg_vars, weWrote_motTTH), "weWrote_motTTH", P_INT, 1, 145, 0, 1, 0, 0},
	{"{P}weWrote_motTH", offsetof(struct seqg_vars, weWrote_motTH), "weWrote_motTH", P_INT, 1, 146, 0, 1, 0, 0},
	{"{P}weWrote_motCHI", offsetof(struct seqg_vars, weWrote_motCHI), "weWrote_motCHI", P_INT, 1, 147, 0, 1, 0, 0},
	{"{P}weWrote_motPHI", offsetof(struct seqg_vars, weWrote_motPHI), "weWrote_motPHI", P_INT, 1, 148, 0, 1, 0, 0},
};

/* Event masks for state set "orient" */
static const seqMask seqg_mask_orient_0_init_wait[] = {
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
};
static const seqMask seqg_mask_orient_0_init[] = {
	0x00060000,
	0x00000000,
	0x00000000,
	0x00000000,
	0x00018000,
};
static const seqMask seqg_mask_orient_0_ref_show[] = {
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
};
static const seqMask seqg_mask_orient_0_enter_monitor_all[] = {
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
};
static const seqMask seqg_mask_orient_0_monitor_all_delay[] = {
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
};
static const seqMask seqg_mask_orient_0_monitor_all[] = {
	0x251ffef2,
	0x00300078,
	0x30000000,
	0x00000060,
	0x001efc00,
};
static const seqMask seqg_mask_orient_0_newA0[] = {
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
	0x00008000,
};
static const seqMask seqg_mask_orient_0_newOMTX[] = {
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
	0x00010000,
};
static const seqMask seqg_mask_orient_0_newHKL[] = {
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
	0x00018000,
};
static const seqMask seqg_mask_orient_0_newAngles[] = {
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
	0x00018000,
};
static const seqMask seqg_mask_orient_0_checkDone[] = {
	0x00000000,
	0x00200000,
	0x00000000,
	0x00000000,
	0x00007c00,
};
static const seqMask seqg_mask_orient_0_newMotors[] = {
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
};
static const seqMask seqg_mask_orient_0_putAll[] = {
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
};

/* State table for state set "orient" */
static seqState seqg_states_orient[] = {
	{
	/* state name */        "init_wait",
	/* action function */   seqg_action_orient_0_init_wait,
	/* event function */    seqg_event_orient_0_init_wait,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_orient_0_init_wait,
	/* state options */     (0)
	},
	{
	/* state name */        "init",
	/* action function */   seqg_action_orient_0_init,
	/* event function */    seqg_event_orient_0_init,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_orient_0_init,
	/* state options */     (0)
	},
	{
	/* state name */        "ref_show",
	/* action function */   seqg_action_orient_0_ref_show,
	/* event function */    seqg_event_orient_0_ref_show,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_orient_0_ref_show,
	/* state options */     (0)
	},
	{
	/* state name */        "enter_monitor_all",
	/* action function */   seqg_action_orient_0_enter_monitor_all,
	/* event function */    seqg_event_orient_0_enter_monitor_all,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_orient_0_enter_monitor_all,
	/* state options */     (0)
	},
	{
	/* state name */        "monitor_all_delay",
	/* action function */   seqg_action_orient_0_monitor_all_delay,
	/* event function */    seqg_event_orient_0_monitor_all_delay,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_orient_0_monitor_all_delay,
	/* state options */     (0)
	},
	{
	/* state name */        "monitor_all",
	/* action function */   seqg_action_orient_0_monitor_all,
	/* event function */    seqg_event_orient_0_monitor_all,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_orient_0_monitor_all,
	/* state options */     (0)
	},
	{
	/* state name */        "newA0",
	/* action function */   seqg_action_orient_0_newA0,
	/* event function */    seqg_event_orient_0_newA0,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_orient_0_newA0,
	/* state options */     (0)
	},
	{
	/* state name */        "newOMTX",
	/* action function */   seqg_action_orient_0_newOMTX,
	/* event function */    seqg_event_orient_0_newOMTX,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_orient_0_newOMTX,
	/* state options */     (0)
	},
	{
	/* state name */        "newHKL",
	/* action function */   seqg_action_orient_0_newHKL,
	/* event function */    seqg_event_orient_0_newHKL,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_orient_0_newHKL,
	/* state options */     (0)
	},
	{
	/* state name */        "newAngles",
	/* action function */   seqg_action_orient_0_newAngles,
	/* event function */    seqg_event_orient_0_newAngles,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_orient_0_newAngles,
	/* state options */     (0)
	},
	{
	/* state name */        "checkDone",
	/* action function */   seqg_action_orient_0_checkDone,
	/* event function */    seqg_event_orient_0_checkDone,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_orient_0_checkDone,
	/* state options */     (0)
	},
	{
	/* state name */        "newMotors",
	/* action function */   seqg_action_orient_0_newMotors,
	/* event function */    seqg_event_orient_0_newMotors,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_orient_0_newMotors,
	/* state options */     (0)
	},
	{
	/* state name */        "putAll",
	/* action function */   seqg_action_orient_0_putAll,
	/* event function */    seqg_event_orient_0_putAll,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_orient_0_putAll,
	/* state options */     (0)
	},
};

/* Event masks for state set "connections" */
static const seqMask seqg_mask_connections_1_check[] = {
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
};

/* State table for state set "connections" */
static seqState seqg_states_connections[] = {
	{
	/* state name */        "check",
	/* action function */   seqg_action_connections_1_check,
	/* event function */    seqg_event_connections_1_check,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_connections_1_check,
	/* state options */     (0)
	},
};

/* Event masks for state set "readback" */
static const seqMask seqg_mask_readback_2_rbv_monitor_throttle[] = {
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
};
static const seqMask seqg_mask_readback_2_rbv_monitor_wait[] = {
	0x00000000,
	0x00000000,
	0x00000000,
	0x00000000,
	0x00018000,
};
static const seqMask seqg_mask_readback_2_rbv_monitor[] = {
	0x00000100,
	0x00000000,
	0x00000000,
	0x00000000,
	0x00018000,
};

/* State table for state set "readback" */
static seqState seqg_states_readback[] = {
	{
	/* state name */        "rbv_monitor_throttle",
	/* action function */   seqg_action_readback_2_rbv_monitor_throttle,
	/* event function */    seqg_event_readback_2_rbv_monitor_throttle,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_readback_2_rbv_monitor_throttle,
	/* state options */     (0)
	},
	{
	/* state name */        "rbv_monitor_wait",
	/* action function */   seqg_action_readback_2_rbv_monitor_wait,
	/* event function */    seqg_event_readback_2_rbv_monitor_wait,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_readback_2_rbv_monitor_wait,
	/* state options */     (0)
	},
	{
	/* state name */        "rbv_monitor",
	/* action function */   seqg_action_readback_2_rbv_monitor,
	/* event function */    seqg_event_readback_2_rbv_monitor,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_readback_2_rbv_monitor,
	/* state options */     (0)
	},
};

/* Event masks for state set "stop" */
static const seqMask seqg_mask_stop_3_stop_all[] = {
	0x00000000,
	0x00008000,
	0x00000000,
	0x00000000,
	0x00000000,
};

/* State table for state set "stop" */
static seqState seqg_states_stop[] = {
	{
	/* state name */        "stop_all",
	/* action function */   seqg_action_stop_3_stop_all,
	/* event function */    seqg_event_stop_3_stop_all,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_stop_3_stop_all,
	/* state options */     (0)
	},
};

/* State set table */
static seqSS seqg_statesets[] = {
	{
	/* state set name */    "orient",
	/* states */            seqg_states_orient,
	/* number of states */  13
	},

	{
	/* state set name */    "connections",
	/* states */            seqg_states_connections,
	/* number of states */  1
	},

	{
	/* state set name */    "readback",
	/* states */            seqg_states_readback,
	/* number of states */  3
	},

	{
	/* state set name */    "stop",
	/* states */            seqg_states_stop,
	/* number of states */  1
	},
};

/* Program table (global) */
seqProgram orient = {
	/* magic number */      2002005,
	/* program name */      "orient",
	/* channels */          seqg_chans,
	/* num. channels */     128,
	/* state sets */        seqg_statesets,
	/* num. state sets */   4,
	/* user var size */     sizeof(struct seqg_vars),
	/* param */             "P=xxx:orient1:,PM=xxx:,mTTH=m9,mTH=m10,mCHI=m11,mPHI=m12",
	/* num. event flags */  20,
	/* encoded options */   (0 | OPT_CONN | OPT_NEWEF | OPT_REENT),
	/* init func */         seqg_init,
	/* entry func */        0,
	/* exit func */         0,
	/* num. queues */       0
};

/* Register sequencer commands and program */
#include "epicsExport.h"
static void orientRegistrar (void) {
    seqRegisterSequencerCommands();
    seqRegisterSequencerProgram (&orient);
}
epicsExportRegistrar(orientRegistrar);
