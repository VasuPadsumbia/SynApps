/* C code for program xiahsc, generated by snc from ../xiahsc.st */
#include <string.h>
#include <stddef.h>
#include <stdio.h>
#include <limits.h>

#include "seq_snc.h"
# line 86 "../xiahsc.st"
static const EF_ID s_ainp_mon = 1;
# line 113 "../xiahsc.st"
static const EF_ID hID_mon = 2;
# line 114 "../xiahsc.st"
static const EF_ID vID_mon = 3;
# line 115 "../xiahsc.st"
static const EF_ID hOrient_mon = 4;
# line 116 "../xiahsc.st"
static const EF_ID vOrient_mon = 5;
# line 119 "../xiahsc.st"
static const EF_ID stop_mon = 6;
# line 124 "../xiahsc.st"
static const EF_ID t_mon = 7;
# line 128 "../xiahsc.st"
static const EF_ID l_mon = 8;
# line 132 "../xiahsc.st"
static const EF_ID b_mon = 9;
# line 136 "../xiahsc.st"
static const EF_ID r_mon = 10;
# line 140 "../xiahsc.st"
static const EF_ID h0_mon = 11;
# line 144 "../xiahsc.st"
static const EF_ID v0_mon = 12;
# line 148 "../xiahsc.st"
static const EF_ID width_mon = 13;
# line 152 "../xiahsc.st"
static const EF_ID height_mon = 14;
# line 176 "../xiahsc.st"
static const EF_ID start_H_move = 15;
# line 176 "../xiahsc.st"
static const EF_ID start_V_move = 16;
# line 177 "../xiahsc.st"
static const EF_ID wait_H_input = 17;
# line 177 "../xiahsc.st"
static const EF_ID wait_V_input = 18;
# line 178 "../xiahsc.st"
static const EF_ID new_H_RB = 19;
# line 178 "../xiahsc.st"
static const EF_ID new_V_RB = 20;
# line 179 "../xiahsc.st"
static const EF_ID move_h = 21;
# line 179 "../xiahsc.st"
static const EF_ID move_v = 22;
# line 196 "../xiahsc.st"
#include <math.h>
# line 197 "../xiahsc.st"
#include <string.h>
# line 198 "../xiahsc.st"
#include <epicsThread.h>
# line 203 "../xiahsc.st"
int validateResponse(char *out, char *in);

/* Variable declarations */
struct seqg_vars {
# line 86 "../xiahsc.st"
	string s_ainp;
# line 87 "../xiahsc.st"
	string s_aout;
# line 88 "../xiahsc.st"
	short s_baud;
# line 89 "../xiahsc.st"
	short s_dbit;
# line 90 "../xiahsc.st"
	short s_fctl;
# line 92 "../xiahsc.st"
	string s_ieos;
# line 93 "../xiahsc.st"
	short s_ifmt;
# line 94 "../xiahsc.st"
	short s_nord;
# line 95 "../xiahsc.st"
	short s_nrrd;
# line 97 "../xiahsc.st"
	string s_oeos;
# line 98 "../xiahsc.st"
	short s_ofmt;
# line 99 "../xiahsc.st"
	short s_proc;
# line 100 "../xiahsc.st"
	short s_prty;
# line 101 "../xiahsc.st"
	short s_sbit;
# line 102 "../xiahsc.st"
	short s_scan;
# line 103 "../xiahsc.st"
	int s_sevr;
# line 104 "../xiahsc.st"
	short s_tmod;
# line 106 "../xiahsc.st"
	double s_tmot;
# line 112 "../xiahsc.st"
	string port;
# line 113 "../xiahsc.st"
	string hID;
# line 114 "../xiahsc.st"
	string vID;
# line 115 "../xiahsc.st"
	short hOrient;
# line 116 "../xiahsc.st"
	short vOrient;
# line 117 "../xiahsc.st"
	short hBusy;
# line 118 "../xiahsc.st"
	short vBusy;
# line 119 "../xiahsc.st"
	short stop;
# line 120 "../xiahsc.st"
	short locate;
# line 121 "../xiahsc.st"
	short init;
# line 122 "../xiahsc.st"
	short enable;
# line 123 "../xiahsc.st"
	short calibrate;
# line 124 "../xiahsc.st"
	double t;
# line 125 "../xiahsc.st"
	double t_hi;
# line 126 "../xiahsc.st"
	double t_lo;
# line 127 "../xiahsc.st"
	double t_RB;
# line 128 "../xiahsc.st"
	double l;
# line 129 "../xiahsc.st"
	double l_hi;
# line 130 "../xiahsc.st"
	double l_lo;
# line 131 "../xiahsc.st"
	double l_RB;
# line 132 "../xiahsc.st"
	double b;
# line 133 "../xiahsc.st"
	double b_hi;
# line 134 "../xiahsc.st"
	double b_lo;
# line 135 "../xiahsc.st"
	double b_RB;
# line 136 "../xiahsc.st"
	double r;
# line 137 "../xiahsc.st"
	double r_hi;
# line 138 "../xiahsc.st"
	double r_lo;
# line 139 "../xiahsc.st"
	double r_RB;
# line 140 "../xiahsc.st"
	double h0;
# line 141 "../xiahsc.st"
	double h0_hi;
# line 142 "../xiahsc.st"
	double h0_lo;
# line 143 "../xiahsc.st"
	double h0_RB;
# line 144 "../xiahsc.st"
	double v0;
# line 145 "../xiahsc.st"
	double v0_hi;
# line 146 "../xiahsc.st"
	double v0_lo;
# line 147 "../xiahsc.st"
	double v0_RB;
# line 148 "../xiahsc.st"
	double width;
# line 149 "../xiahsc.st"
	double width_hi;
# line 150 "../xiahsc.st"
	double width_lo;
# line 151 "../xiahsc.st"
	double width_RB;
# line 152 "../xiahsc.st"
	double height;
# line 153 "../xiahsc.st"
	double height_hi;
# line 154 "../xiahsc.st"
	double height_lo;
# line 155 "../xiahsc.st"
	double height_RB;
# line 156 "../xiahsc.st"
	int error;
# line 157 "../xiahsc.st"
	string errMsg;
# line 159 "../xiahsc.st"
	int xiahscDebug;
# line 164 "../xiahsc.st"
	char scratch[256];
# line 165 "../xiahsc.st"
	char myChar;
# line 166 "../xiahsc.st"
	double dScratch;
# line 168 "../xiahsc.st"
	int numWords;
# line 169 "../xiahsc.st"
	string word1;
# line 169 "../xiahsc.st"
	string word2;
# line 169 "../xiahsc.st"
	string word3;
# line 170 "../xiahsc.st"
	string word4;
# line 170 "../xiahsc.st"
	string word5;
# line 170 "../xiahsc.st"
	string word6;
# line 172 "../xiahsc.st"
	int pos_a;
# line 172 "../xiahsc.st"
	int pos_b;
# line 173 "../xiahsc.st"
	double pos_ag;
# line 173 "../xiahsc.st"
	double pos_bg;
# line 174 "../xiahsc.st"
	string id;
# line 174 "../xiahsc.st"
	short hasID;
# line 175 "../xiahsc.st"
	string hscErrors[14];
# line 180 "../xiahsc.st"
	double t_old;
# line 180 "../xiahsc.st"
	double l_old;
# line 181 "../xiahsc.st"
	double b_old;
# line 181 "../xiahsc.st"
	double r_old;
# line 182 "../xiahsc.st"
	double width_old;
# line 182 "../xiahsc.st"
	double height_old;
# line 183 "../xiahsc.st"
	double h0_old;
# line 183 "../xiahsc.st"
	double v0_old;
# line 184 "../xiahsc.st"
	int init_delay;
# line 185 "../xiahsc.st"
	int i;
# line 186 "../xiahsc.st"
	int count;
# line 187 "../xiahsc.st"
	int hOrigin;
# line 187 "../xiahsc.st"
	int vOrigin;
# line 188 "../xiahsc.st"
	int hOuterLimit;
# line 188 "../xiahsc.st"
	int vOuterLimit;
# line 189 "../xiahsc.st"
	string hsc_command;
# line 190 "../xiahsc.st"
	string hsc_response;
# line 191 "../xiahsc.st"
	int hsc_timeout;
# line 192 "../xiahsc.st"
	int h_valid;
# line 193 "../xiahsc.st"
	int v_valid;
};


/* Function declarations */

#define seqg_var (*(struct seqg_vars *const *)seqg_env)

/* Program init func */
static void seqg_init(PROG_ID seqg_env)
{
}

/****** Code for state "startup" in state set "xiahsc" ******/

/* Event function for state "startup" in state set "xiahsc" */
static seqBool seqg_event_xiahsc_0_startup(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
	if (TRUE)
	{
		*seqg_pnst = 3;
		*seqg_ptrn = 0;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "startup" in state set "xiahsc" */
static void seqg_action_xiahsc_0_startup(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
# line 339 "../xiahsc.st"
			seqg_var->xiahscDebug = 0;
# line 340 "../xiahsc.st"
			seq_pvGetTmo(seqg_env, 0/*s_ainp*/, DEFAULT, DEFAULT_TIMEOUT);
# line 341 "../xiahsc.st"
			seq_pvGetTmo(seqg_env, 1/*s_aout*/, DEFAULT, DEFAULT_TIMEOUT);
			{
# line 342 "../xiahsc.st"
				seqg_var->init = (1);
# line 342 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 27/*init*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 342 "../xiahsc.st"
			;
# line 343 "../xiahsc.st"
			seqg_var->init_delay = 1.0;
# line 348 "../xiahsc.st"
			strcpy(seqg_var->port, seq_macValueGet(seqg_env, "S"));
# line 349 "../xiahsc.st"
			seq_pvPutTmo(seqg_env, 18/*port*/, DEFAULT, DEFAULT_TIMEOUT);
# line 351 "../xiahsc.st"
			strcpy(seqg_var->hscErrors[0], "Missing Command");
# line 352 "../xiahsc.st"
			strcpy(seqg_var->hscErrors[1], "Unrecognized Command");
# line 353 "../xiahsc.st"
			strcpy(seqg_var->hscErrors[2], "Input Buffer Overflow");
# line 354 "../xiahsc.st"
			strcpy(seqg_var->hscErrors[3], "No new Alias Given");
# line 355 "../xiahsc.st"
			strcpy(seqg_var->hscErrors[4], "Alias too long");
# line 356 "../xiahsc.st"
			strcpy(seqg_var->hscErrors[5], "Invalid Field Parameter");
# line 357 "../xiahsc.st"
			strcpy(seqg_var->hscErrors[6], "Value Out of Range");
# line 358 "../xiahsc.st"
			strcpy(seqg_var->hscErrors[7], "Parameter is read-only");
# line 359 "../xiahsc.st"
			strcpy(seqg_var->hscErrors[8], "Invalid/Missing Argument");
# line 360 "../xiahsc.st"
			strcpy(seqg_var->hscErrors[9], "No Movement Required");
# line 361 "../xiahsc.st"
			strcpy(seqg_var->hscErrors[10], "Uncalibrated: no motion allowed");
# line 362 "../xiahsc.st"
			strcpy(seqg_var->hscErrors[11], "Motion out of range");
# line 363 "../xiahsc.st"
			strcpy(seqg_var->hscErrors[12], "Invalid/missing direction character");
# line 364 "../xiahsc.st"
			strcpy(seqg_var->hscErrors[13], "Invalid Motor Specified");
# line 370 "../xiahsc.st"
			seqg_var->t_old = seqg_var->t;
# line 370 "../xiahsc.st"
			seqg_var->b_old = seqg_var->b;
# line 371 "../xiahsc.st"
			seqg_var->l_old = seqg_var->l;
# line 371 "../xiahsc.st"
			seqg_var->r_old = seqg_var->r;
# line 372 "../xiahsc.st"
			seqg_var->h0_old = seqg_var->h0;
# line 372 "../xiahsc.st"
			seqg_var->width_old = seqg_var->width;
# line 373 "../xiahsc.st"
			seqg_var->v0_old = seqg_var->v0;
# line 373 "../xiahsc.st"
			seqg_var->height_old = seqg_var->height;
# line 376 "../xiahsc.st"
			seqg_var->hOrigin = seqg_var->vOrigin = 400;
# line 377 "../xiahsc.st"
			seqg_var->hOuterLimit = seqg_var->vOuterLimit = 4400;
			{
# line 379 "../xiahsc.st"
				seqg_var->enable = (1);
# line 379 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 28/*enable*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 379 "../xiahsc.st"
			;
			{
# line 381 "../xiahsc.st"
				seqg_var->s_tmot = (.250);
# line 381 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 17/*s_tmot*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 381 "../xiahsc.st"
			;
		}
		return;
	}
}

/****** Code for state "disable" in state set "xiahsc" ******/

/* Event function for state "disable" in state set "xiahsc" */
static seqBool seqg_event_xiahsc_0_disable(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 389 "../xiahsc.st"
	if (seqg_var->enable)
	{
		*seqg_pnst = 3;
		*seqg_ptrn = 0;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "disable" in state set "xiahsc" */
static void seqg_action_xiahsc_0_disable(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
# line 390 "../xiahsc.st"
			seqg_var->init_delay = 1.0;
			{
# line 391 "../xiahsc.st"
				seqg_var->init = (1);
# line 391 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 27/*init*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 391 "../xiahsc.st"
			;
		}
		return;
	}
}

/****** Code for state "comm_error" in state set "xiahsc" ******/

/* Event function for state "comm_error" in state set "xiahsc" */
static seqBool seqg_event_xiahsc_0_comm_error(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 399 "../xiahsc.st"
	if (seqg_var->init || !seqg_var->s_sevr || seq_delay(seqg_env, (10 * 60.0)))
	{
		*seqg_pnst = 3;
		*seqg_ptrn = 0;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "comm_error" in state set "xiahsc" */
static void seqg_action_xiahsc_0_comm_error(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
# line 400 "../xiahsc.st"
			if (seqg_var->xiahscDebug >= 20)
			{
# line 400 "../xiahsc.st"
				printf("(%s,%d): ", "../xiahsc.st", 400);
# line 400 "../xiahsc.st"
				printf("comm_error: init=%d  s_sevr=%d", seqg_var->init, seqg_var->s_sevr);
# line 400 "../xiahsc.st"
				printf("\n");
			}
# line 401 "../xiahsc.st"
			seqg_var->init_delay = 1.0;
# line 402 "../xiahsc.st"
			seqg_var->s_sevr = 0;
			{
# line 403 "../xiahsc.st"
				seqg_var->init = (1);
# line 403 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 27/*init*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 403 "../xiahsc.st"
			;
		}
		return;
	}
}

/****** Code for state "init" in state set "xiahsc" ******/

/* Event function for state "init" in state set "xiahsc" */
static seqBool seqg_event_xiahsc_0_init(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 409 "../xiahsc.st"
	if (!seqg_var->enable)
	{
		*seqg_pnst = 1;
		*seqg_ptrn = 0;
		return TRUE;
	}
# line 410 "../xiahsc.st"
	if (seq_efTest(seqg_env, hID_mon) || seq_efTest(seqg_env, vID_mon))
	{
		*seqg_pnst = 3;
		*seqg_ptrn = 1;
		return TRUE;
	}
# line 435 "../xiahsc.st"
	if (seqg_var->init && seq_delay(seqg_env, seqg_var->init_delay))
	{
		*seqg_pnst = 3;
		*seqg_ptrn = 2;
		return TRUE;
	}
# line 479 "../xiahsc.st"
	if (!seqg_var->init && seq_delay(seqg_env, 0.1))
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 3;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "init" in state set "xiahsc" */
static void seqg_action_xiahsc_0_init(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
		}
		return;
	case 1:
		{
# line 423 "../xiahsc.st"
			strcpy(seqg_var->port, seq_macValueGet(seqg_env, "S"));
# line 424 "../xiahsc.st"
			seq_pvPutTmo(seqg_env, 18/*port*/, DEFAULT, DEFAULT_TIMEOUT);
# line 428 "../xiahsc.st"
			seqg_var->init_delay = 0;
# line 429 "../xiahsc.st"
			seqg_var->init = 1;
# line 430 "../xiahsc.st"
			seq_efClear(seqg_env, hID_mon);
# line 431 "../xiahsc.st"
			seq_efClear(seqg_env, vID_mon);
# line 432 "../xiahsc.st"
			seq_efClear(seqg_env, hOrient_mon);
# line 433 "../xiahsc.st"
			seq_efClear(seqg_env, vOrient_mon);
		}
		return;
	case 2:
		{
# line 439 "../xiahsc.st"
			seqg_var->error = 0;
# line 440 "../xiahsc.st"
			if (!strcmp(seqg_var->hID, seqg_var->vID))
			{
				{
# line 441 "../xiahsc.st"
					strcpy(seqg_var->errMsg, "H & V IDs must be different");
# line 441 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 63/*errMsg*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 441 "../xiahsc.st"
				;
# line 442 "../xiahsc.st"
				seqg_var->error++;
			}
# line 444 "../xiahsc.st"
			if (sscanf(seqg_var->hID, "XIAHSC-%c-%d%s", &seqg_var->myChar, &seqg_var->numWords, seqg_var->scratch) != 2)
			{
# line 445 "../xiahsc.st"
				if (sscanf(seqg_var->hID, "%c-%d%s", &seqg_var->myChar, &seqg_var->numWords, seqg_var->scratch) != 2)
				{
					{
# line 446 "../xiahsc.st"
						strcpy(seqg_var->errMsg, "H ID not a valid HSC ID");
# line 446 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 63/*errMsg*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 446 "../xiahsc.st"
					;
# line 447 "../xiahsc.st"
					seqg_var->error++;
				}
			}
# line 450 "../xiahsc.st"
			if (sscanf(seqg_var->vID, "XIAHSC-%c-%d%s", &seqg_var->myChar, &seqg_var->numWords, seqg_var->scratch) != 2)
			{
# line 451 "../xiahsc.st"
				if (sscanf(seqg_var->vID, "%c-%d%s", &seqg_var->myChar, &seqg_var->numWords, seqg_var->scratch) != 2)
				{
					{
# line 452 "../xiahsc.st"
						strcpy(seqg_var->errMsg, "V ID not a valid HSC ID");
# line 452 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 63/*errMsg*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 452 "../xiahsc.st"
					;
# line 453 "../xiahsc.st"
					seqg_var->error++;
				}
			}
# line 456 "../xiahsc.st"
			if (!strlen(seqg_var->hID))
			{
				{
# line 457 "../xiahsc.st"
					strcpy(seqg_var->errMsg, "define H ID string");
# line 457 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 63/*errMsg*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 457 "../xiahsc.st"
				;
# line 458 "../xiahsc.st"
				seqg_var->error++;
			}
# line 460 "../xiahsc.st"
			if (!strlen(seqg_var->vID))
			{
				{
# line 461 "../xiahsc.st"
					strcpy(seqg_var->errMsg, "define V ID string");
# line 461 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 63/*errMsg*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 461 "../xiahsc.st"
				;
# line 462 "../xiahsc.st"
				seqg_var->error++;
			}
# line 467 "../xiahsc.st"
			if (seqg_var->error)
			{
				{
# line 468 "../xiahsc.st"
					seqg_var->error = (17);
# line 468 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 62/*error*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 468 "../xiahsc.st"
				;
			}
			else
			{
				{
# line 470 "../xiahsc.st"
					seqg_var->init = (0);
# line 470 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 27/*init*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 470 "../xiahsc.st"
				;
				{
# line 471 "../xiahsc.st"
					strcpy(seqg_var->errMsg, "no error");
# line 471 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 63/*errMsg*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 471 "../xiahsc.st"
				;
			}
# line 473 "../xiahsc.st"
			seq_pvPutTmo(seqg_env, 62/*error*/, DEFAULT, DEFAULT_TIMEOUT);
# line 474 "../xiahsc.st"
			seq_efClear(seqg_env, hID_mon);
# line 475 "../xiahsc.st"
			seq_efClear(seqg_env, vID_mon);
# line 477 "../xiahsc.st"
			seqg_var->init_delay = 30;
		}
		return;
	case 3:
		{
			{
# line 480 "../xiahsc.st"
				seqg_var->hBusy = (0);
# line 480 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 23/*hBusy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 480 "../xiahsc.st"
			;
			{
# line 481 "../xiahsc.st"
				seqg_var->vBusy = (0);
# line 481 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 24/*vBusy*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 481 "../xiahsc.st"
			;
			{
# line 482 "../xiahsc.st"
				seqg_var->error = (0);
# line 482 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 62/*error*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 482 "../xiahsc.st"
			;
			{
				{
# line 487 "../xiahsc.st"
					seqg_var->s_baud = (6);
# line 487 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 2/*s_baud*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 487 "../xiahsc.st"
				;
				{
# line 487 "../xiahsc.st"
					seqg_var->s_dbit = (4);
# line 487 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 3/*s_dbit*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 487 "../xiahsc.st"
				;
				{
# line 487 "../xiahsc.st"
					seqg_var->s_sbit = (1);
# line 487 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 13/*s_sbit*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 487 "../xiahsc.st"
				;
				{
# line 487 "../xiahsc.st"
					seqg_var->s_prty = (1);
# line 487 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 12/*s_prty*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 487 "../xiahsc.st"
				;
				{
# line 487 "../xiahsc.st"
					seqg_var->s_fctl = (1);
# line 487 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 4/*s_fctl*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 487 "../xiahsc.st"
				;
			}
# line 487 "../xiahsc.st"
			;
			{
# line 492 "../xiahsc.st"
				strcpy(seqg_var->s_ieos, "\n");
# line 492 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 5/*s_ieos*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 492 "../xiahsc.st"
			;
			{
# line 493 "../xiahsc.st"
				seqg_var->s_ifmt = (0);
# line 493 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 6/*s_ifmt*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 493 "../xiahsc.st"
			;
			{
# line 494 "../xiahsc.st"
				seqg_var->s_nrrd = (0);
# line 494 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 8/*s_nrrd*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 494 "../xiahsc.st"
			;
			{
# line 496 "../xiahsc.st"
				strcpy(seqg_var->s_oeos, "\r");
# line 496 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 9/*s_oeos*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 496 "../xiahsc.st"
			;
			{
# line 497 "../xiahsc.st"
				seqg_var->s_ofmt = (0);
# line 497 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 10/*s_ofmt*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 497 "../xiahsc.st"
			;
			{
# line 498 "../xiahsc.st"
				seqg_var->s_tmod = (0);
# line 498 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 16/*s_tmod*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 498 "../xiahsc.st"
			;
			{
# line 499 "../xiahsc.st"
				seqg_var->s_scan = (0);
# line 499 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 14/*s_scan*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 499 "../xiahsc.st"
			;
			{
# line 501 "../xiahsc.st"
				seqg_var->s_tmot = (.250);
# line 501 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 17/*s_tmot*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 501 "../xiahsc.st"
			;
# line 503 "../xiahsc.st"
			seq_efClear(seqg_env, s_ainp_mon);
# line 505 "../xiahsc.st"
			seq_efClear(seqg_env, wait_H_input);
# line 506 "../xiahsc.st"
			seq_efClear(seqg_env, wait_V_input);
# line 508 "../xiahsc.st"
			seq_efClear(seqg_env, move_h);
# line 509 "../xiahsc.st"
			seq_efClear(seqg_env, move_v);
# line 510 "../xiahsc.st"
			seq_efClear(seqg_env, new_H_RB);
# line 511 "../xiahsc.st"
			seq_efClear(seqg_env, new_V_RB);
			{
# line 513 "../xiahsc.st"
				seqg_var->stop = (0);
# line 513 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 25/*stop*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 513 "../xiahsc.st"
			;
# line 514 "../xiahsc.st"
			epicsThreadSleep(.02);
# line 515 "../xiahsc.st"
			seq_efClear(seqg_env, stop_mon);
# line 517 "../xiahsc.st"
			seq_efClear(seqg_env, t_mon);
# line 517 "../xiahsc.st"
			seq_efClear(seqg_env, l_mon);
# line 518 "../xiahsc.st"
			seq_efClear(seqg_env, b_mon);
# line 518 "../xiahsc.st"
			seq_efClear(seqg_env, r_mon);
# line 519 "../xiahsc.st"
			seq_efClear(seqg_env, h0_mon);
# line 519 "../xiahsc.st"
			seq_efClear(seqg_env, width_mon);
# line 520 "../xiahsc.st"
			seq_efClear(seqg_env, v0_mon);
# line 520 "../xiahsc.st"
			seq_efClear(seqg_env, height_mon);
			{
# line 521 "../xiahsc.st"
				seqg_var->calibrate = (0);
# line 521 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 29/*calibrate*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 521 "../xiahsc.st"
			;
# line 523 "../xiahsc.st"
			seq_efClear(seqg_env, hID_mon);
# line 524 "../xiahsc.st"
			seq_efClear(seqg_env, vID_mon);
# line 525 "../xiahsc.st"
			seq_efClear(seqg_env, hOrient_mon);
# line 526 "../xiahsc.st"
			seq_efClear(seqg_env, vOrient_mon);
			{
# line 532 "../xiahsc.st"
				if (!seqg_var->s_sevr)
				{
# line 532 "../xiahsc.st"
					sprintf(seqg_var->hsc_command, "!%s %s", "ALL", "K");
# line 532 "../xiahsc.st"
					if (seqg_var->xiahscDebug >= 10)
					{
# line 532 "../xiahsc.st"
						printf("(%s,%d): ", "../xiahsc.st", 532);
# line 532 "../xiahsc.st"
						printf("WRITE_HSC: <%s>", seqg_var->hsc_command);
# line 532 "../xiahsc.st"
						printf("\n");
					}
# line 532 "../xiahsc.st"
					;
					{
# line 532 "../xiahsc.st"
						seqg_var->s_scan = (0);
# line 532 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 14/*s_scan*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 532 "../xiahsc.st"
					;
					{
# line 532 "../xiahsc.st"
						seqg_var->s_tmod = (1);
# line 532 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 16/*s_tmod*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 532 "../xiahsc.st"
					;
					{
# line 532 "../xiahsc.st"
						strcpy(seqg_var->s_ieos, "\n");
# line 532 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 5/*s_ieos*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 532 "../xiahsc.st"
					;
					{
# line 532 "../xiahsc.st"
						strcpy(seqg_var->s_oeos, "\r");
# line 532 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 9/*s_oeos*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 532 "../xiahsc.st"
					;
					{
# line 532 "../xiahsc.st"
						strcpy(seqg_var->s_aout, seqg_var->hsc_command);
# line 532 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 1/*s_aout*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 532 "../xiahsc.st"
					;
				}
			}
# line 532 "../xiahsc.st"
			;
# line 533 "../xiahsc.st"
			epicsThreadSleep(.1);
# line 542 "../xiahsc.st"
			seqg_var->error = 0;
			{
# line 543 "../xiahsc.st"
				seq_efClear(seqg_env, s_ainp_mon);
# line 543 "../xiahsc.st"
				seqg_var->hsc_timeout = 1;
				{
# line 543 "../xiahsc.st"
					if (!seqg_var->s_sevr)
					{
# line 543 "../xiahsc.st"
						sprintf(seqg_var->hsc_command, "!%s %s", seqg_var->hID, "R 1");
# line 543 "../xiahsc.st"
						if (seqg_var->xiahscDebug >= 10)
						{
# line 543 "../xiahsc.st"
							printf("(%s,%d): ", "../xiahsc.st", 543);
# line 543 "../xiahsc.st"
							printf("WRITE_HSC: <%s>", seqg_var->hsc_command);
# line 543 "../xiahsc.st"
							printf("\n");
						}
# line 543 "../xiahsc.st"
						;
						{
# line 543 "../xiahsc.st"
							seqg_var->s_scan = (0);
# line 543 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 14/*s_scan*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 543 "../xiahsc.st"
						;
						{
# line 543 "../xiahsc.st"
							seqg_var->s_tmod = (0);
# line 543 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 16/*s_tmod*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 543 "../xiahsc.st"
						;
						{
# line 543 "../xiahsc.st"
							strcpy(seqg_var->s_ieos, "\n");
# line 543 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 5/*s_ieos*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 543 "../xiahsc.st"
						;
						{
# line 543 "../xiahsc.st"
							strcpy(seqg_var->s_oeos, "\r");
# line 543 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 9/*s_oeos*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 543 "../xiahsc.st"
						;
						{
# line 543 "../xiahsc.st"
							strcpy(seqg_var->s_aout, seqg_var->hsc_command);
# line 543 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 1/*s_aout*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 543 "../xiahsc.st"
						;
					}
				}
# line 543 "../xiahsc.st"
				;
				{
# line 543 "../xiahsc.st"
					if (!seqg_var->s_sevr)
					{
# line 543 "../xiahsc.st"
						for (seqg_var->i = 15; seqg_var->i; seqg_var->i--)
						{
# line 543 "../xiahsc.st"
							if (seq_efTest(seqg_env, s_ainp_mon))
							{
# line 543 "../xiahsc.st"
								seqg_var->hsc_timeout = 0;
								break;
							}
# line 543 "../xiahsc.st"
							epicsThreadSleep(.02);
						}
# line 543 "../xiahsc.st"
						;
# line 543 "../xiahsc.st"
						if (seqg_var->hsc_timeout == 1)
						{
# line 543 "../xiahsc.st"
							strcpy(seqg_var->hsc_response, "");
# line 543 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 10)
							{
# line 543 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 543);
# line 543 "../xiahsc.st"
								printf("WAIT_HSC_RESPONSE: <%s> -> <<< TIMEOUT >>>", seqg_var->hsc_command);
# line 543 "../xiahsc.st"
								printf("\n");
							}
# line 543 "../xiahsc.st"
							;
						}
						else
						{
# line 543 "../xiahsc.st"
							strcpy(seqg_var->hsc_response, seqg_var->s_ainp);
# line 543 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 10)
							{
# line 543 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 543);
# line 543 "../xiahsc.st"
								printf("WAIT_HSC_RESPONSE: <%s> -> NORD=%d  AINP=%s", seqg_var->hsc_command, seqg_var->s_nord, seqg_var->hsc_response);
# line 543 "../xiahsc.st"
								printf("\n");
							}
# line 543 "../xiahsc.st"
							;
						}
# line 543 "../xiahsc.st"
						;
					}
				}
# line 543 "../xiahsc.st"
				;
			}
# line 543 "../xiahsc.st"
			;
# line 544 "../xiahsc.st"
			if (sscanf(seqg_var->hsc_response, "%*s %*s %d", &seqg_var->hOuterLimit) != 1)
			{
# line 545 "../xiahsc.st"
				seqg_var->error++;
# line 546 "../xiahsc.st"
				if (seqg_var->xiahscDebug >= 5)
				{
# line 546 "../xiahsc.st"
					printf("(%s,%d): ", "../xiahsc.st", 546);
# line 546 "../xiahsc.st"
					printf("Could not read horizontal outer limit");
# line 546 "../xiahsc.st"
					printf("\n");
				}
# line 546 "../xiahsc.st"
				;
			}
			{
# line 548 "../xiahsc.st"
				seq_efClear(seqg_env, s_ainp_mon);
# line 548 "../xiahsc.st"
				seqg_var->hsc_timeout = 1;
				{
# line 548 "../xiahsc.st"
					if (!seqg_var->s_sevr)
					{
# line 548 "../xiahsc.st"
						sprintf(seqg_var->hsc_command, "!%s %s", seqg_var->hID, "R 2");
# line 548 "../xiahsc.st"
						if (seqg_var->xiahscDebug >= 10)
						{
# line 548 "../xiahsc.st"
							printf("(%s,%d): ", "../xiahsc.st", 548);
# line 548 "../xiahsc.st"
							printf("WRITE_HSC: <%s>", seqg_var->hsc_command);
# line 548 "../xiahsc.st"
							printf("\n");
						}
# line 548 "../xiahsc.st"
						;
						{
# line 548 "../xiahsc.st"
							seqg_var->s_scan = (0);
# line 548 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 14/*s_scan*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 548 "../xiahsc.st"
						;
						{
# line 548 "../xiahsc.st"
							seqg_var->s_tmod = (0);
# line 548 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 16/*s_tmod*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 548 "../xiahsc.st"
						;
						{
# line 548 "../xiahsc.st"
							strcpy(seqg_var->s_ieos, "\n");
# line 548 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 5/*s_ieos*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 548 "../xiahsc.st"
						;
						{
# line 548 "../xiahsc.st"
							strcpy(seqg_var->s_oeos, "\r");
# line 548 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 9/*s_oeos*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 548 "../xiahsc.st"
						;
						{
# line 548 "../xiahsc.st"
							strcpy(seqg_var->s_aout, seqg_var->hsc_command);
# line 548 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 1/*s_aout*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 548 "../xiahsc.st"
						;
					}
				}
# line 548 "../xiahsc.st"
				;
				{
# line 548 "../xiahsc.st"
					if (!seqg_var->s_sevr)
					{
# line 548 "../xiahsc.st"
						for (seqg_var->i = 15; seqg_var->i; seqg_var->i--)
						{
# line 548 "../xiahsc.st"
							if (seq_efTest(seqg_env, s_ainp_mon))
							{
# line 548 "../xiahsc.st"
								seqg_var->hsc_timeout = 0;
								break;
							}
# line 548 "../xiahsc.st"
							epicsThreadSleep(.02);
						}
# line 548 "../xiahsc.st"
						;
# line 548 "../xiahsc.st"
						if (seqg_var->hsc_timeout == 1)
						{
# line 548 "../xiahsc.st"
							strcpy(seqg_var->hsc_response, "");
# line 548 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 10)
							{
# line 548 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 548);
# line 548 "../xiahsc.st"
								printf("WAIT_HSC_RESPONSE: <%s> -> <<< TIMEOUT >>>", seqg_var->hsc_command);
# line 548 "../xiahsc.st"
								printf("\n");
							}
# line 548 "../xiahsc.st"
							;
						}
						else
						{
# line 548 "../xiahsc.st"
							strcpy(seqg_var->hsc_response, seqg_var->s_ainp);
# line 548 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 10)
							{
# line 548 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 548);
# line 548 "../xiahsc.st"
								printf("WAIT_HSC_RESPONSE: <%s> -> NORD=%d  AINP=%s", seqg_var->hsc_command, seqg_var->s_nord, seqg_var->hsc_response);
# line 548 "../xiahsc.st"
								printf("\n");
							}
# line 548 "../xiahsc.st"
							;
						}
# line 548 "../xiahsc.st"
						;
					}
				}
# line 548 "../xiahsc.st"
				;
			}
# line 548 "../xiahsc.st"
			;
# line 549 "../xiahsc.st"
			if (sscanf(seqg_var->hsc_response, "%*s %*s %d", &seqg_var->hOrigin) != 1)
			{
# line 550 "../xiahsc.st"
				seqg_var->error++;
# line 551 "../xiahsc.st"
				if (seqg_var->xiahscDebug >= 5)
				{
# line 551 "../xiahsc.st"
					printf("(%s,%d): ", "../xiahsc.st", 551);
# line 551 "../xiahsc.st"
					printf("Could not read horizontal origin position");
# line 551 "../xiahsc.st"
					printf("\n");
				}
# line 551 "../xiahsc.st"
				;
			}
# line 554 "../xiahsc.st"
			if (!seqg_var->error)
			{
# line 555 "../xiahsc.st"
				seqg_var->pos_ag = (1.0 * (0 - seqg_var->hOrigin) / 400);
# line 556 "../xiahsc.st"
				seqg_var->pos_bg = (1.0 * (seqg_var->hOuterLimit - seqg_var->hOrigin) / 400);
				{
# line 557 "../xiahsc.st"
					seqg_var->l_lo = (seqg_var->pos_ag);
# line 557 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 36/*l_lo*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 557 "../xiahsc.st"
				;
				{
# line 557 "../xiahsc.st"
					seqg_var->l_hi = (seqg_var->pos_bg);
# line 557 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 35/*l_hi*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 557 "../xiahsc.st"
				;
				{
# line 558 "../xiahsc.st"
					seqg_var->r_lo = (seqg_var->pos_ag);
# line 558 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 44/*r_lo*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 558 "../xiahsc.st"
				;
				{
# line 558 "../xiahsc.st"
					seqg_var->r_hi = (seqg_var->pos_bg);
# line 558 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 43/*r_hi*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 558 "../xiahsc.st"
				;
				{
# line 566 "../xiahsc.st"
					if ((seqg_var->l_lo) > (seqg_var->r_lo))
					{
# line 566 "../xiahsc.st"
						seqg_var->dScratch = (seqg_var->l_lo);
					}
					else
					{
# line 566 "../xiahsc.st"
						seqg_var->dScratch = (seqg_var->r_lo);
					}
				}
# line 566 "../xiahsc.st"
				;
				{
# line 567 "../xiahsc.st"
					if ((seqg_var->dScratch) > (0.0))
					{
# line 567 "../xiahsc.st"
						seqg_var->width_lo = (seqg_var->dScratch);
					}
					else
					{
# line 567 "../xiahsc.st"
						seqg_var->width_lo = (0.0);
					}
				}
# line 567 "../xiahsc.st"
				;
# line 567 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 56/*width_lo*/, DEFAULT, DEFAULT_TIMEOUT);
				{
# line 568 "../xiahsc.st"
					seqg_var->width_hi = (seqg_var->l_hi + seqg_var->r_hi);
# line 568 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 55/*width_hi*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 568 "../xiahsc.st"
				;
				{
# line 573 "../xiahsc.st"
					seqg_var->h0_hi = ((seqg_var->r_hi - seqg_var->l_lo) / 2);
# line 573 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 47/*h0_hi*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 573 "../xiahsc.st"
				;
				{
# line 574 "../xiahsc.st"
					seqg_var->h0_lo = ((seqg_var->r_lo - seqg_var->l_hi) / 2);
# line 574 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 48/*h0_lo*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 574 "../xiahsc.st"
				;
			}
# line 577 "../xiahsc.st"
			seqg_var->error = 0;
			{
# line 578 "../xiahsc.st"
				seq_efClear(seqg_env, s_ainp_mon);
# line 578 "../xiahsc.st"
				seqg_var->hsc_timeout = 1;
				{
# line 578 "../xiahsc.st"
					if (!seqg_var->s_sevr)
					{
# line 578 "../xiahsc.st"
						sprintf(seqg_var->hsc_command, "!%s %s", seqg_var->vID, "R 1");
# line 578 "../xiahsc.st"
						if (seqg_var->xiahscDebug >= 10)
						{
# line 578 "../xiahsc.st"
							printf("(%s,%d): ", "../xiahsc.st", 578);
# line 578 "../xiahsc.st"
							printf("WRITE_HSC: <%s>", seqg_var->hsc_command);
# line 578 "../xiahsc.st"
							printf("\n");
						}
# line 578 "../xiahsc.st"
						;
						{
# line 578 "../xiahsc.st"
							seqg_var->s_scan = (0);
# line 578 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 14/*s_scan*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 578 "../xiahsc.st"
						;
						{
# line 578 "../xiahsc.st"
							seqg_var->s_tmod = (0);
# line 578 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 16/*s_tmod*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 578 "../xiahsc.st"
						;
						{
# line 578 "../xiahsc.st"
							strcpy(seqg_var->s_ieos, "\n");
# line 578 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 5/*s_ieos*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 578 "../xiahsc.st"
						;
						{
# line 578 "../xiahsc.st"
							strcpy(seqg_var->s_oeos, "\r");
# line 578 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 9/*s_oeos*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 578 "../xiahsc.st"
						;
						{
# line 578 "../xiahsc.st"
							strcpy(seqg_var->s_aout, seqg_var->hsc_command);
# line 578 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 1/*s_aout*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 578 "../xiahsc.st"
						;
					}
				}
# line 578 "../xiahsc.st"
				;
				{
# line 578 "../xiahsc.st"
					if (!seqg_var->s_sevr)
					{
# line 578 "../xiahsc.st"
						for (seqg_var->i = 15; seqg_var->i; seqg_var->i--)
						{
# line 578 "../xiahsc.st"
							if (seq_efTest(seqg_env, s_ainp_mon))
							{
# line 578 "../xiahsc.st"
								seqg_var->hsc_timeout = 0;
								break;
							}
# line 578 "../xiahsc.st"
							epicsThreadSleep(.02);
						}
# line 578 "../xiahsc.st"
						;
# line 578 "../xiahsc.st"
						if (seqg_var->hsc_timeout == 1)
						{
# line 578 "../xiahsc.st"
							strcpy(seqg_var->hsc_response, "");
# line 578 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 10)
							{
# line 578 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 578);
# line 578 "../xiahsc.st"
								printf("WAIT_HSC_RESPONSE: <%s> -> <<< TIMEOUT >>>", seqg_var->hsc_command);
# line 578 "../xiahsc.st"
								printf("\n");
							}
# line 578 "../xiahsc.st"
							;
						}
						else
						{
# line 578 "../xiahsc.st"
							strcpy(seqg_var->hsc_response, seqg_var->s_ainp);
# line 578 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 10)
							{
# line 578 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 578);
# line 578 "../xiahsc.st"
								printf("WAIT_HSC_RESPONSE: <%s> -> NORD=%d  AINP=%s", seqg_var->hsc_command, seqg_var->s_nord, seqg_var->hsc_response);
# line 578 "../xiahsc.st"
								printf("\n");
							}
# line 578 "../xiahsc.st"
							;
						}
# line 578 "../xiahsc.st"
						;
					}
				}
# line 578 "../xiahsc.st"
				;
			}
# line 578 "../xiahsc.st"
			;
# line 579 "../xiahsc.st"
			if (sscanf(seqg_var->hsc_response, "%*s %*s %d", &seqg_var->vOuterLimit) != 1)
			{
# line 580 "../xiahsc.st"
				seqg_var->error++;
# line 581 "../xiahsc.st"
				if (seqg_var->xiahscDebug >= 5)
				{
# line 581 "../xiahsc.st"
					printf("(%s,%d): ", "../xiahsc.st", 581);
# line 581 "../xiahsc.st"
					printf("Could not read vertical outer limit");
# line 581 "../xiahsc.st"
					printf("\n");
				}
# line 581 "../xiahsc.st"
				;
			}
			{
# line 583 "../xiahsc.st"
				seq_efClear(seqg_env, s_ainp_mon);
# line 583 "../xiahsc.st"
				seqg_var->hsc_timeout = 1;
				{
# line 583 "../xiahsc.st"
					if (!seqg_var->s_sevr)
					{
# line 583 "../xiahsc.st"
						sprintf(seqg_var->hsc_command, "!%s %s", seqg_var->vID, "R 2");
# line 583 "../xiahsc.st"
						if (seqg_var->xiahscDebug >= 10)
						{
# line 583 "../xiahsc.st"
							printf("(%s,%d): ", "../xiahsc.st", 583);
# line 583 "../xiahsc.st"
							printf("WRITE_HSC: <%s>", seqg_var->hsc_command);
# line 583 "../xiahsc.st"
							printf("\n");
						}
# line 583 "../xiahsc.st"
						;
						{
# line 583 "../xiahsc.st"
							seqg_var->s_scan = (0);
# line 583 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 14/*s_scan*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 583 "../xiahsc.st"
						;
						{
# line 583 "../xiahsc.st"
							seqg_var->s_tmod = (0);
# line 583 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 16/*s_tmod*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 583 "../xiahsc.st"
						;
						{
# line 583 "../xiahsc.st"
							strcpy(seqg_var->s_ieos, "\n");
# line 583 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 5/*s_ieos*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 583 "../xiahsc.st"
						;
						{
# line 583 "../xiahsc.st"
							strcpy(seqg_var->s_oeos, "\r");
# line 583 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 9/*s_oeos*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 583 "../xiahsc.st"
						;
						{
# line 583 "../xiahsc.st"
							strcpy(seqg_var->s_aout, seqg_var->hsc_command);
# line 583 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 1/*s_aout*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 583 "../xiahsc.st"
						;
					}
				}
# line 583 "../xiahsc.st"
				;
				{
# line 583 "../xiahsc.st"
					if (!seqg_var->s_sevr)
					{
# line 583 "../xiahsc.st"
						for (seqg_var->i = 15; seqg_var->i; seqg_var->i--)
						{
# line 583 "../xiahsc.st"
							if (seq_efTest(seqg_env, s_ainp_mon))
							{
# line 583 "../xiahsc.st"
								seqg_var->hsc_timeout = 0;
								break;
							}
# line 583 "../xiahsc.st"
							epicsThreadSleep(.02);
						}
# line 583 "../xiahsc.st"
						;
# line 583 "../xiahsc.st"
						if (seqg_var->hsc_timeout == 1)
						{
# line 583 "../xiahsc.st"
							strcpy(seqg_var->hsc_response, "");
# line 583 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 10)
							{
# line 583 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 583);
# line 583 "../xiahsc.st"
								printf("WAIT_HSC_RESPONSE: <%s> -> <<< TIMEOUT >>>", seqg_var->hsc_command);
# line 583 "../xiahsc.st"
								printf("\n");
							}
# line 583 "../xiahsc.st"
							;
						}
						else
						{
# line 583 "../xiahsc.st"
							strcpy(seqg_var->hsc_response, seqg_var->s_ainp);
# line 583 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 10)
							{
# line 583 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 583);
# line 583 "../xiahsc.st"
								printf("WAIT_HSC_RESPONSE: <%s> -> NORD=%d  AINP=%s", seqg_var->hsc_command, seqg_var->s_nord, seqg_var->hsc_response);
# line 583 "../xiahsc.st"
								printf("\n");
							}
# line 583 "../xiahsc.st"
							;
						}
# line 583 "../xiahsc.st"
						;
					}
				}
# line 583 "../xiahsc.st"
				;
			}
# line 583 "../xiahsc.st"
			;
# line 584 "../xiahsc.st"
			if (sscanf(seqg_var->hsc_response, "%*s %*s %d", &seqg_var->vOrigin) != 1)
			{
# line 585 "../xiahsc.st"
				seqg_var->error++;
# line 586 "../xiahsc.st"
				if (seqg_var->xiahscDebug >= 5)
				{
# line 586 "../xiahsc.st"
					printf("(%s,%d): ", "../xiahsc.st", 586);
# line 586 "../xiahsc.st"
					printf("Could not read vertical origin position");
# line 586 "../xiahsc.st"
					printf("\n");
				}
# line 586 "../xiahsc.st"
				;
			}
# line 588 "../xiahsc.st"
			if (!seqg_var->error)
			{
# line 589 "../xiahsc.st"
				seqg_var->pos_ag = (1.0 * (0 - seqg_var->vOrigin) / 400);
# line 590 "../xiahsc.st"
				seqg_var->pos_bg = (1.0 * (seqg_var->vOuterLimit - seqg_var->vOrigin) / 400);
				{
# line 591 "../xiahsc.st"
					seqg_var->t_lo = (seqg_var->pos_ag);
# line 591 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 32/*t_lo*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 591 "../xiahsc.st"
				;
				{
# line 591 "../xiahsc.st"
					seqg_var->t_hi = (seqg_var->pos_bg);
# line 591 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 31/*t_hi*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 591 "../xiahsc.st"
				;
				{
# line 592 "../xiahsc.st"
					seqg_var->b_lo = (seqg_var->pos_ag);
# line 592 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 40/*b_lo*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 592 "../xiahsc.st"
				;
				{
# line 592 "../xiahsc.st"
					seqg_var->b_hi = (seqg_var->pos_bg);
# line 592 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 39/*b_hi*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 592 "../xiahsc.st"
				;
				{
# line 600 "../xiahsc.st"
					if ((seqg_var->t_lo) > (seqg_var->b_lo))
					{
# line 600 "../xiahsc.st"
						seqg_var->dScratch = (seqg_var->t_lo);
					}
					else
					{
# line 600 "../xiahsc.st"
						seqg_var->dScratch = (seqg_var->b_lo);
					}
				}
# line 600 "../xiahsc.st"
				;
				{
# line 601 "../xiahsc.st"
					if ((seqg_var->dScratch) > (0.0))
					{
# line 601 "../xiahsc.st"
						seqg_var->height_lo = (seqg_var->dScratch);
					}
					else
					{
# line 601 "../xiahsc.st"
						seqg_var->height_lo = (0.0);
					}
				}
# line 601 "../xiahsc.st"
				;
# line 601 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 60/*height_lo*/, DEFAULT, DEFAULT_TIMEOUT);
				{
# line 602 "../xiahsc.st"
					seqg_var->height_hi = (seqg_var->t_hi + seqg_var->b_hi);
# line 602 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 59/*height_hi*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 602 "../xiahsc.st"
				;
				{
# line 607 "../xiahsc.st"
					seqg_var->v0_hi = ((seqg_var->t_hi - seqg_var->b_lo) / 2);
# line 607 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 51/*v0_hi*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 607 "../xiahsc.st"
				;
				{
# line 608 "../xiahsc.st"
					seqg_var->v0_lo = ((seqg_var->t_lo - seqg_var->b_hi) / 2);
# line 608 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 52/*v0_lo*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 608 "../xiahsc.st"
				;
			}
			{
# line 610 "../xiahsc.st"
				seqg_var->locate = (1);
# line 610 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 26/*locate*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 610 "../xiahsc.st"
			;
		}
		return;
	}
}

/****** Code for state "idle" in state set "xiahsc" ******/

/* Event function for state "idle" in state set "xiahsc" */
static seqBool seqg_event_xiahsc_0_idle(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 618 "../xiahsc.st"
	if (!seqg_var->enable)
	{
		*seqg_pnst = 1;
		*seqg_ptrn = 0;
		return TRUE;
	}
# line 619 "../xiahsc.st"
	if (seqg_var->s_sevr)
	{
		*seqg_pnst = 2;
		*seqg_ptrn = 1;
		return TRUE;
	}
# line 624 "../xiahsc.st"
	if (seq_efTest(seqg_env, hID_mon) || seq_efTest(seqg_env, vID_mon))
	{
		*seqg_pnst = 3;
		*seqg_ptrn = 2;
		return TRUE;
	}
# line 625 "../xiahsc.st"
	if (seq_efTest(seqg_env, hOrient_mon) || seq_efTest(seqg_env, vOrient_mon))
	{
		*seqg_pnst = 3;
		*seqg_ptrn = 3;
		return TRUE;
	}
# line 628 "../xiahsc.st"
	if (seqg_var->init)
	{
		*seqg_pnst = 3;
		*seqg_ptrn = 4;
		return TRUE;
	}
# line 630 "../xiahsc.st"
	if (seq_efTest(seqg_env, stop_mon) && seqg_var->stop)
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 5;
		return TRUE;
	}
# line 648 "../xiahsc.st"
	if (seq_efTest(seqg_env, l_mon) || seq_efTest(seqg_env, r_mon) || seq_efTest(seqg_env, t_mon) || seq_efTest(seqg_env, b_mon) || seq_efTest(seqg_env, h0_mon) || seq_efTest(seqg_env, height_mon) || seq_efTest(seqg_env, v0_mon) || seq_efTest(seqg_env, width_mon))
	{
		*seqg_pnst = 6;
		*seqg_ptrn = 6;
		return TRUE;
	}
# line 656 "../xiahsc.st"
	if ((seq_efTest(seqg_env, start_H_move) || seq_efTest(seqg_env, start_V_move)) && seq_delay(seqg_env, 0.1))
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 7;
		return TRUE;
	}
# line 705 "../xiahsc.st"
	if (seqg_var->locate)
	{
		*seqg_pnst = 5;
		*seqg_ptrn = 8;
		return TRUE;
	}
# line 719 "../xiahsc.st"
	if (seqg_var->calibrate)
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 9;
		return TRUE;
	}
# line 731 "../xiahsc.st"
	if (seq_efTest(seqg_env, new_H_RB))
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 10;
		return TRUE;
	}
# line 749 "../xiahsc.st"
	if (seq_efTest(seqg_env, new_V_RB))
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 11;
		return TRUE;
	}
# line 767 "../xiahsc.st"
	if ((seqg_var->hBusy || seqg_var->vBusy) && seq_delay(seqg_env, 0.25))
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 12;
		return TRUE;
	}
# line 770 "../xiahsc.st"
	if (seq_delay(seqg_env, 5.0))
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 13;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "idle" in state set "xiahsc" */
static void seqg_action_xiahsc_0_idle(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
		}
		return;
	case 1:
		{
			{
# line 620 "../xiahsc.st"
				seqg_var->error = (18);
# line 620 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 62/*error*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 620 "../xiahsc.st"
			;
			sprintf (pVar->scratch, "communications error: %d", pVar->s_sevr);
			{
# line 622 "../xiahsc.st"
				strcpy(seqg_var->errMsg, seqg_var->scratch);
# line 622 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 63/*errMsg*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 622 "../xiahsc.st"
			;
		}
		return;
	case 2:
		{
		}
		return;
	case 3:
		{
		}
		return;
	case 4:
		{
# line 628 "../xiahsc.st"
			seqg_var->init_delay = 1;
			{
# line 628 "../xiahsc.st"
				seqg_var->init = (1);
# line 628 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 27/*init*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 628 "../xiahsc.st"
			;
		}
		return;
	case 5:
		{
			{
# line 636 "../xiahsc.st"
				if (!seqg_var->s_sevr)
				{
# line 636 "../xiahsc.st"
					sprintf(seqg_var->hsc_command, "!%s %s", "ALL", "K");
# line 636 "../xiahsc.st"
					if (seqg_var->xiahscDebug >= 10)
					{
# line 636 "../xiahsc.st"
						printf("(%s,%d): ", "../xiahsc.st", 636);
# line 636 "../xiahsc.st"
						printf("WRITE_HSC: <%s>", seqg_var->hsc_command);
# line 636 "../xiahsc.st"
						printf("\n");
					}
# line 636 "../xiahsc.st"
					;
					{
# line 636 "../xiahsc.st"
						seqg_var->s_scan = (0);
# line 636 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 14/*s_scan*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 636 "../xiahsc.st"
					;
					{
# line 636 "../xiahsc.st"
						seqg_var->s_tmod = (1);
# line 636 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 16/*s_tmod*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 636 "../xiahsc.st"
					;
					{
# line 636 "../xiahsc.st"
						strcpy(seqg_var->s_ieos, "\n");
# line 636 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 5/*s_ieos*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 636 "../xiahsc.st"
					;
					{
# line 636 "../xiahsc.st"
						strcpy(seqg_var->s_oeos, "\r");
# line 636 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 9/*s_oeos*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 636 "../xiahsc.st"
					;
					{
# line 636 "../xiahsc.st"
						strcpy(seqg_var->s_aout, seqg_var->hsc_command);
# line 636 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 1/*s_aout*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 636 "../xiahsc.st"
					;
				}
			}
# line 637 "../xiahsc.st"
			epicsThreadSleep(.1);
# line 638 "../xiahsc.st"
			seq_efClear(seqg_env, stop_mon);
			{
# line 639 "../xiahsc.st"
				seqg_var->locate = (1);
# line 639 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 26/*locate*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 639 "../xiahsc.st"
			;
		}
		return;
	case 6:
		{
		}
		return;
	case 7:
		{
# line 657 "../xiahsc.st"
			if (seq_efTest(seqg_env, start_H_move))
			{
# line 658 "../xiahsc.st"
				if (seqg_var->hBusy)
				{
					{
# line 659 "../xiahsc.st"
						if (!seqg_var->s_sevr)
						{
# line 659 "../xiahsc.st"
							sprintf(seqg_var->hsc_command, "!%s %s", seqg_var->hID, "K");
# line 659 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 10)
							{
# line 659 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 659);
# line 659 "../xiahsc.st"
								printf("WRITE_HSC: <%s>", seqg_var->hsc_command);
# line 659 "../xiahsc.st"
								printf("\n");
							}
# line 659 "../xiahsc.st"
							;
							{
# line 659 "../xiahsc.st"
								seqg_var->s_scan = (0);
# line 659 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 14/*s_scan*/, DEFAULT, DEFAULT_TIMEOUT);
							}
# line 659 "../xiahsc.st"
							;
							{
# line 659 "../xiahsc.st"
								seqg_var->s_tmod = (1);
# line 659 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 16/*s_tmod*/, DEFAULT, DEFAULT_TIMEOUT);
							}
# line 659 "../xiahsc.st"
							;
							{
# line 659 "../xiahsc.st"
								strcpy(seqg_var->s_ieos, "\n");
# line 659 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 5/*s_ieos*/, DEFAULT, DEFAULT_TIMEOUT);
							}
# line 659 "../xiahsc.st"
							;
							{
# line 659 "../xiahsc.st"
								strcpy(seqg_var->s_oeos, "\r");
# line 659 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 9/*s_oeos*/, DEFAULT, DEFAULT_TIMEOUT);
							}
# line 659 "../xiahsc.st"
							;
							{
# line 659 "../xiahsc.st"
								strcpy(seqg_var->s_aout, seqg_var->hsc_command);
# line 659 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 1/*s_aout*/, DEFAULT, DEFAULT_TIMEOUT);
							}
# line 659 "../xiahsc.st"
							;
						}
					}
# line 659 "../xiahsc.st"
					;
# line 660 "../xiahsc.st"
					epicsThreadSleep(.1);
				}
				else
				{
					{
# line 662 "../xiahsc.st"
						seqg_var->hBusy = (1);
# line 662 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 23/*hBusy*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 662 "../xiahsc.st"
					;
				}
# line 664 "../xiahsc.st"
				if (seqg_var->hOrient == 0)
				{
# line 665 "../xiahsc.st"
					seqg_var->pos_ag = seqg_var->l;
# line 665 "../xiahsc.st"
					seqg_var->pos_bg = seqg_var->r;
				}
				else
				{
# line 667 "../xiahsc.st"
					seqg_var->pos_ag = seqg_var->r;
# line 667 "../xiahsc.st"
					seqg_var->pos_bg = seqg_var->l;
				}
# line 669 "../xiahsc.st"
				strcpy(seqg_var->word1, seqg_var->hID);
# line 670 "../xiahsc.st"
				seq_efSet(seqg_env, wait_H_input);
# line 671 "../xiahsc.st"
				seq_efClear(seqg_env, start_H_move);
# line 675 "../xiahsc.st"
				seqg_var->pos_a = ((seqg_var->pos_ag) * 400 + 0.5 + seqg_var->hOrigin);
# line 676 "../xiahsc.st"
				seqg_var->pos_b = ((seqg_var->pos_bg) * 400 + 0.5 + seqg_var->hOrigin);
			}
# line 678 "../xiahsc.st"
			if (seq_efTest(seqg_env, start_V_move))
			{
# line 679 "../xiahsc.st"
				if (seqg_var->vBusy)
				{
					{
# line 680 "../xiahsc.st"
						if (!seqg_var->s_sevr)
						{
# line 680 "../xiahsc.st"
							sprintf(seqg_var->hsc_command, "!%s %s", seqg_var->vID, "K");
# line 680 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 10)
							{
# line 680 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 680);
# line 680 "../xiahsc.st"
								printf("WRITE_HSC: <%s>", seqg_var->hsc_command);
# line 680 "../xiahsc.st"
								printf("\n");
							}
# line 680 "../xiahsc.st"
							;
							{
# line 680 "../xiahsc.st"
								seqg_var->s_scan = (0);
# line 680 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 14/*s_scan*/, DEFAULT, DEFAULT_TIMEOUT);
							}
# line 680 "../xiahsc.st"
							;
							{
# line 680 "../xiahsc.st"
								seqg_var->s_tmod = (1);
# line 680 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 16/*s_tmod*/, DEFAULT, DEFAULT_TIMEOUT);
							}
# line 680 "../xiahsc.st"
							;
							{
# line 680 "../xiahsc.st"
								strcpy(seqg_var->s_ieos, "\n");
# line 680 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 5/*s_ieos*/, DEFAULT, DEFAULT_TIMEOUT);
							}
# line 680 "../xiahsc.st"
							;
							{
# line 680 "../xiahsc.st"
								strcpy(seqg_var->s_oeos, "\r");
# line 680 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 9/*s_oeos*/, DEFAULT, DEFAULT_TIMEOUT);
							}
# line 680 "../xiahsc.st"
							;
							{
# line 680 "../xiahsc.st"
								strcpy(seqg_var->s_aout, seqg_var->hsc_command);
# line 680 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 1/*s_aout*/, DEFAULT, DEFAULT_TIMEOUT);
							}
# line 680 "../xiahsc.st"
							;
						}
					}
# line 680 "../xiahsc.st"
					;
# line 681 "../xiahsc.st"
					epicsThreadSleep(.1);
				}
				else
				{
					{
# line 683 "../xiahsc.st"
						seqg_var->vBusy = (1);
# line 683 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 24/*vBusy*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 683 "../xiahsc.st"
					;
				}
# line 685 "../xiahsc.st"
				if (seqg_var->vOrient == 0)
				{
# line 686 "../xiahsc.st"
					seqg_var->pos_ag = seqg_var->t;
# line 686 "../xiahsc.st"
					seqg_var->pos_bg = seqg_var->b;
				}
				else
				{
# line 688 "../xiahsc.st"
					seqg_var->pos_ag = seqg_var->b;
# line 688 "../xiahsc.st"
					seqg_var->pos_bg = seqg_var->t;
				}
# line 690 "../xiahsc.st"
				strcpy(seqg_var->word1, seqg_var->vID);
# line 691 "../xiahsc.st"
				seq_efSet(seqg_env, wait_V_input);
# line 692 "../xiahsc.st"
				seq_efClear(seqg_env, start_V_move);
# line 696 "../xiahsc.st"
				seqg_var->pos_a = ((seqg_var->pos_ag) * 400 + 0.5 + seqg_var->vOrigin);
# line 697 "../xiahsc.st"
				seqg_var->pos_b = ((seqg_var->pos_bg) * 400 + 0.5 + seqg_var->vOrigin);
			}
# line 699 "../xiahsc.st"
			sprintf(seqg_var->scratch, "M %d %d", seqg_var->pos_a, seqg_var->pos_b);
			{
# line 700 "../xiahsc.st"
				if (!seqg_var->s_sevr)
				{
# line 700 "../xiahsc.st"
					sprintf(seqg_var->hsc_command, "!%s %s", seqg_var->word1, seqg_var->scratch);
# line 700 "../xiahsc.st"
					if (seqg_var->xiahscDebug >= 10)
					{
# line 700 "../xiahsc.st"
						printf("(%s,%d): ", "../xiahsc.st", 700);
# line 700 "../xiahsc.st"
						printf("WRITE_HSC: <%s>", seqg_var->hsc_command);
# line 700 "../xiahsc.st"
						printf("\n");
					}
# line 700 "../xiahsc.st"
					;
					{
# line 700 "../xiahsc.st"
						seqg_var->s_scan = (0);
# line 700 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 14/*s_scan*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 700 "../xiahsc.st"
					;
					{
# line 700 "../xiahsc.st"
						seqg_var->s_tmod = (1);
# line 700 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 16/*s_tmod*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 700 "../xiahsc.st"
					;
					{
# line 700 "../xiahsc.st"
						strcpy(seqg_var->s_ieos, "\n");
# line 700 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 5/*s_ieos*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 700 "../xiahsc.st"
					;
					{
# line 700 "../xiahsc.st"
						strcpy(seqg_var->s_oeos, "\r");
# line 700 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 9/*s_oeos*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 700 "../xiahsc.st"
					;
					{
# line 700 "../xiahsc.st"
						strcpy(seqg_var->s_aout, seqg_var->hsc_command);
# line 700 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 1/*s_aout*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 700 "../xiahsc.st"
					;
				}
			}
# line 700 "../xiahsc.st"
			;
# line 701 "../xiahsc.st"
			epicsThreadSleep(.1);
			{
# line 702 "../xiahsc.st"
				seqg_var->locate = (1);
# line 702 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 26/*locate*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 702 "../xiahsc.st"
			;
		}
		return;
	case 8:
		{
# line 714 "../xiahsc.st"
			strcpy(seqg_var->port, seq_macValueGet(seqg_env, "S"));
# line 715 "../xiahsc.st"
			seq_pvPutTmo(seqg_env, 18/*port*/, DEFAULT, DEFAULT_TIMEOUT);
			{
# line 716 "../xiahsc.st"
				seqg_var->locate = (0);
# line 716 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 26/*locate*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 716 "../xiahsc.st"
			;
		}
		return;
	case 9:
		{
			{
# line 725 "../xiahsc.st"
				if (!seqg_var->s_sevr)
				{
# line 725 "../xiahsc.st"
					sprintf(seqg_var->hsc_command, "!%s %s", "ALL", "0 I");
# line 725 "../xiahsc.st"
					if (seqg_var->xiahscDebug >= 10)
					{
# line 725 "../xiahsc.st"
						printf("(%s,%d): ", "../xiahsc.st", 725);
# line 725 "../xiahsc.st"
						printf("WRITE_HSC: <%s>", seqg_var->hsc_command);
# line 725 "../xiahsc.st"
						printf("\n");
					}
# line 725 "../xiahsc.st"
					;
					{
# line 725 "../xiahsc.st"
						seqg_var->s_scan = (0);
# line 725 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 14/*s_scan*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 725 "../xiahsc.st"
					;
					{
# line 725 "../xiahsc.st"
						seqg_var->s_tmod = (1);
# line 725 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 16/*s_tmod*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 725 "../xiahsc.st"
					;
					{
# line 725 "../xiahsc.st"
						strcpy(seqg_var->s_ieos, "\n");
# line 725 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 5/*s_ieos*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 725 "../xiahsc.st"
					;
					{
# line 725 "../xiahsc.st"
						strcpy(seqg_var->s_oeos, "\r");
# line 725 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 9/*s_oeos*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 725 "../xiahsc.st"
					;
					{
# line 725 "../xiahsc.st"
						strcpy(seqg_var->s_aout, seqg_var->hsc_command);
# line 725 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 1/*s_aout*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 725 "../xiahsc.st"
					;
				}
			}
# line 726 "../xiahsc.st"
			epicsThreadSleep(.1);
			{
# line 727 "../xiahsc.st"
				seqg_var->calibrate = (0);
# line 727 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 29/*calibrate*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 727 "../xiahsc.st"
			;
			{
# line 728 "../xiahsc.st"
				seqg_var->locate = (1);
# line 728 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 26/*locate*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 728 "../xiahsc.st"
			;
		}
		return;
	case 10:
		{
# line 732 "../xiahsc.st"
			seq_efClear(seqg_env, new_H_RB);
# line 737 "../xiahsc.st"
			if (!seqg_var->hBusy)
			{
# line 738 "../xiahsc.st"
				if (seqg_var->l != seqg_var->l_RB)
				{
# line 738 "../xiahsc.st"
					seqg_var->l = (seqg_var->l_RB);
# line 738 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 34/*l*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 738 "../xiahsc.st"
				;
# line 739 "../xiahsc.st"
				if (seqg_var->r != seqg_var->r_RB)
				{
# line 739 "../xiahsc.st"
					seqg_var->r = (seqg_var->r_RB);
# line 739 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 42/*r*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 739 "../xiahsc.st"
				;
# line 740 "../xiahsc.st"
				if (seqg_var->h0 != seqg_var->h0_RB)
				{
# line 740 "../xiahsc.st"
					seqg_var->h0 = (seqg_var->h0_RB);
# line 740 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 46/*h0*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 740 "../xiahsc.st"
				;
# line 741 "../xiahsc.st"
				if (seqg_var->width != seqg_var->width_RB)
				{
# line 741 "../xiahsc.st"
					seqg_var->width = (seqg_var->width_RB);
# line 741 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 54/*width*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 741 "../xiahsc.st"
				;
# line 742 "../xiahsc.st"
				epicsThreadSleep(.02);
# line 743 "../xiahsc.st"
				seq_efClear(seqg_env, l_mon);
# line 743 "../xiahsc.st"
				seq_efClear(seqg_env, r_mon);
# line 744 "../xiahsc.st"
				seq_efClear(seqg_env, h0_mon);
# line 744 "../xiahsc.st"
				seq_efClear(seqg_env, width_mon);
# line 745 "../xiahsc.st"
				seq_efClear(seqg_env, wait_H_input);
			}
		}
		return;
	case 11:
		{
# line 750 "../xiahsc.st"
			seq_efClear(seqg_env, new_V_RB);
# line 755 "../xiahsc.st"
			if (!seqg_var->vBusy)
			{
# line 756 "../xiahsc.st"
				if (seqg_var->t != seqg_var->t_RB)
				{
# line 756 "../xiahsc.st"
					seqg_var->t = (seqg_var->t_RB);
# line 756 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 30/*t*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 756 "../xiahsc.st"
				;
# line 757 "../xiahsc.st"
				if (seqg_var->b != seqg_var->b_RB)
				{
# line 757 "../xiahsc.st"
					seqg_var->b = (seqg_var->b_RB);
# line 757 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 38/*b*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 757 "../xiahsc.st"
				;
# line 758 "../xiahsc.st"
				if (seqg_var->v0 != seqg_var->v0_RB)
				{
# line 758 "../xiahsc.st"
					seqg_var->v0 = (seqg_var->v0_RB);
# line 758 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 50/*v0*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 758 "../xiahsc.st"
				;
# line 759 "../xiahsc.st"
				if (seqg_var->height != seqg_var->height_RB)
				{
# line 759 "../xiahsc.st"
					seqg_var->height = (seqg_var->height_RB);
# line 759 "../xiahsc.st"
					seq_pvPutTmo(seqg_env, 58/*height*/, DEFAULT, DEFAULT_TIMEOUT);
				}
# line 759 "../xiahsc.st"
				;
# line 760 "../xiahsc.st"
				epicsThreadSleep(.02);
# line 761 "../xiahsc.st"
				seq_efClear(seqg_env, t_mon);
# line 761 "../xiahsc.st"
				seq_efClear(seqg_env, b_mon);
# line 762 "../xiahsc.st"
				seq_efClear(seqg_env, v0_mon);
# line 762 "../xiahsc.st"
				seq_efClear(seqg_env, height_mon);
# line 763 "../xiahsc.st"
				seq_efClear(seqg_env, wait_V_input);
			}
		}
		return;
	case 12:
		{
			{
# line 768 "../xiahsc.st"
				seqg_var->locate = (1);
# line 768 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 26/*locate*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 768 "../xiahsc.st"
			;
		}
		return;
	case 13:
		{
			{
# line 771 "../xiahsc.st"
				seqg_var->locate = (1);
# line 771 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 26/*locate*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 771 "../xiahsc.st"
			;
		}
		return;
	}
}

/****** Code for state "get_readback_positions" in state set "xiahsc" ******/

/* Event function for state "get_readback_positions" in state set "xiahsc" */
static seqBool seqg_event_xiahsc_0_get_readback_positions(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 778 "../xiahsc.st"
	if (!seqg_var->enable)
	{
		*seqg_pnst = 1;
		*seqg_ptrn = 0;
		return TRUE;
	}
	if (TRUE)
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 1;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "get_readback_positions" in state set "xiahsc" */
static void seqg_action_xiahsc_0_get_readback_positions(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
		}
		return;
	case 1:
		{
			{
# line 784 "../xiahsc.st"
				seq_efClear(seqg_env, s_ainp_mon);
# line 784 "../xiahsc.st"
				seqg_var->hsc_timeout = 1;
				{
# line 784 "../xiahsc.st"
					if (!seqg_var->s_sevr)
					{
# line 784 "../xiahsc.st"
						sprintf(seqg_var->hsc_command, "!%s %s", seqg_var->hID, "P");
# line 784 "../xiahsc.st"
						if (seqg_var->xiahscDebug >= 10)
						{
# line 784 "../xiahsc.st"
							printf("(%s,%d): ", "../xiahsc.st", 784);
# line 784 "../xiahsc.st"
							printf("WRITE_HSC: <%s>", seqg_var->hsc_command);
# line 784 "../xiahsc.st"
							printf("\n");
						}
# line 784 "../xiahsc.st"
						;
						{
# line 784 "../xiahsc.st"
							seqg_var->s_scan = (0);
# line 784 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 14/*s_scan*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 784 "../xiahsc.st"
						;
						{
# line 784 "../xiahsc.st"
							seqg_var->s_tmod = (0);
# line 784 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 16/*s_tmod*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 784 "../xiahsc.st"
						;
						{
# line 784 "../xiahsc.st"
							strcpy(seqg_var->s_ieos, "\n");
# line 784 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 5/*s_ieos*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 784 "../xiahsc.st"
						;
						{
# line 784 "../xiahsc.st"
							strcpy(seqg_var->s_oeos, "\r");
# line 784 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 9/*s_oeos*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 784 "../xiahsc.st"
						;
						{
# line 784 "../xiahsc.st"
							strcpy(seqg_var->s_aout, seqg_var->hsc_command);
# line 784 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 1/*s_aout*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 784 "../xiahsc.st"
						;
					}
				}
# line 784 "../xiahsc.st"
				;
				{
# line 784 "../xiahsc.st"
					if (!seqg_var->s_sevr)
					{
# line 784 "../xiahsc.st"
						for (seqg_var->i = 15; seqg_var->i; seqg_var->i--)
						{
# line 784 "../xiahsc.st"
							if (seq_efTest(seqg_env, s_ainp_mon))
							{
# line 784 "../xiahsc.st"
								seqg_var->hsc_timeout = 0;
								break;
							}
# line 784 "../xiahsc.st"
							epicsThreadSleep(.02);
						}
# line 784 "../xiahsc.st"
						;
# line 784 "../xiahsc.st"
						if (seqg_var->hsc_timeout == 1)
						{
# line 784 "../xiahsc.st"
							strcpy(seqg_var->hsc_response, "");
# line 784 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 10)
							{
# line 784 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 784);
# line 784 "../xiahsc.st"
								printf("WAIT_HSC_RESPONSE: <%s> -> <<< TIMEOUT >>>", seqg_var->hsc_command);
# line 784 "../xiahsc.st"
								printf("\n");
							}
# line 784 "../xiahsc.st"
							;
						}
						else
						{
# line 784 "../xiahsc.st"
							strcpy(seqg_var->hsc_response, seqg_var->s_ainp);
# line 784 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 10)
							{
# line 784 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 784);
# line 784 "../xiahsc.st"
								printf("WAIT_HSC_RESPONSE: <%s> -> NORD=%d  AINP=%s", seqg_var->hsc_command, seqg_var->s_nord, seqg_var->hsc_response);
# line 784 "../xiahsc.st"
								printf("\n");
							}
# line 784 "../xiahsc.st"
							;
						}
# line 784 "../xiahsc.st"
						;
					}
				}
# line 784 "../xiahsc.st"
				;
			}
# line 784 "../xiahsc.st"
			;
# line 785 "../xiahsc.st"
			seqg_var->h_valid = validateResponse(seqg_var->hsc_command, seqg_var->hsc_response);
# line 786 "../xiahsc.st"
			if (seqg_var->xiahscDebug >= 2)
			{
# line 786 "../xiahsc.st"
				printf("(%s,%d): ", "../xiahsc.st", 786);
# line 786 "../xiahsc.st"
				printf("validateResponse (H): %i", seqg_var->h_valid);
# line 786 "../xiahsc.st"
				printf("\n");
			}
# line 786 "../xiahsc.st"
			;
# line 787 "../xiahsc.st"
			if (seqg_var->h_valid)
			{
# line 788 "../xiahsc.st"
				if (sscanf(seqg_var->hsc_response, "%*s %*s %d %d", &seqg_var->pos_a, &seqg_var->pos_b) == 2)
				{
# line 789 "../xiahsc.st"
					seqg_var->pos_ag = (1.0 * (seqg_var->pos_a - seqg_var->hOrigin) / 400);
# line 790 "../xiahsc.st"
					seqg_var->pos_bg = (1.0 * (seqg_var->pos_b - seqg_var->hOrigin) / 400);
# line 791 "../xiahsc.st"
					if (seqg_var->hOrient == 0)
					{
# line 792 "../xiahsc.st"
						if (seqg_var->pos_ag != seqg_var->l_RB)
						{
							{
# line 792 "../xiahsc.st"
								seqg_var->l_RB = (seqg_var->pos_ag);
# line 792 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 37/*l_RB*/, DEFAULT, DEFAULT_TIMEOUT);
							}
						}
# line 792 "../xiahsc.st"
						;
# line 793 "../xiahsc.st"
						if (seqg_var->pos_bg != seqg_var->r_RB)
						{
							{
# line 793 "../xiahsc.st"
								seqg_var->r_RB = (seqg_var->pos_bg);
# line 793 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 45/*r_RB*/, DEFAULT, DEFAULT_TIMEOUT);
							}
						}
# line 793 "../xiahsc.st"
						;
					}
					else
					{
# line 795 "../xiahsc.st"
						if (seqg_var->pos_ag != seqg_var->r_RB)
						{
							{
# line 795 "../xiahsc.st"
								seqg_var->r_RB = (seqg_var->pos_ag);
# line 795 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 45/*r_RB*/, DEFAULT, DEFAULT_TIMEOUT);
							}
						}
# line 795 "../xiahsc.st"
						;
# line 796 "../xiahsc.st"
						if (seqg_var->pos_bg != seqg_var->l_RB)
						{
							{
# line 796 "../xiahsc.st"
								seqg_var->l_RB = (seqg_var->pos_bg);
# line 796 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 37/*l_RB*/, DEFAULT, DEFAULT_TIMEOUT);
							}
						}
# line 796 "../xiahsc.st"
						;
					}
# line 798 "../xiahsc.st"
					if (seqg_var->hBusy)
					{
# line 798 "../xiahsc.st"
						seqg_var->hBusy = (0);
# line 798 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 23/*hBusy*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 798 "../xiahsc.st"
					;
					{
# line 802 "../xiahsc.st"
						seqg_var->width_RB = (seqg_var->l_RB + seqg_var->r_RB);
# line 802 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 57/*width_RB*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 802 "../xiahsc.st"
					;
					{
# line 803 "../xiahsc.st"
						seqg_var->h0_RB = ((seqg_var->r_RB - seqg_var->l_RB) / 2);
# line 803 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 49/*h0_RB*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 803 "../xiahsc.st"
					;
# line 804 "../xiahsc.st"
					seq_efSet(seqg_env, new_H_RB);
# line 809 "../xiahsc.st"
					seqg_var->l_old = seqg_var->l_RB;
# line 809 "../xiahsc.st"
					seqg_var->r_old = seqg_var->r_RB;
# line 810 "../xiahsc.st"
					seqg_var->h0_old = seqg_var->h0_RB;
# line 810 "../xiahsc.st"
					seqg_var->width_old = seqg_var->width_RB;
				}
				else
# line 812 "../xiahsc.st"
					if (sscanf(seqg_var->hsc_response, "%*s %*s %s", seqg_var->scratch) == 1)
					{
# line 813 "../xiahsc.st"
						if (seqg_var->xiahscDebug >= 5)
						{
# line 813 "../xiahsc.st"
							printf("(%s,%d): ", "../xiahsc.st", 813);
# line 813 "../xiahsc.st"
							printf("axis=%s, command=<%s>, response=%s", "H", seqg_var->hsc_command, seqg_var->hsc_response);
# line 813 "../xiahsc.st"
							printf("\n");
						}
# line 813 "../xiahsc.st"
						;
# line 814 "../xiahsc.st"
						if (!strcmp(seqg_var->scratch, "BUSY;"))
						{
# line 815 "../xiahsc.st"
							if (!seqg_var->hBusy)
							{
# line 815 "../xiahsc.st"
								seqg_var->hBusy = (1);
# line 815 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 23/*hBusy*/, DEFAULT, DEFAULT_TIMEOUT);
							}
# line 815 "../xiahsc.st"
							;
						}
						else
						{
# line 817 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 20)
							{
# line 817 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 817);
# line 817 "../xiahsc.st"
								printf("could not understand %s", seqg_var->hsc_response);
# line 817 "../xiahsc.st"
								printf("\n");
							}
# line 817 "../xiahsc.st"
							;
						}
					}
			}
			else
			{
# line 821 "../xiahsc.st"
				if (seqg_var->xiahscDebug >= 2)
				{
# line 821 "../xiahsc.st"
					printf("(%s,%d): ", "../xiahsc.st", 821);
# line 821 "../xiahsc.st"
					printf("incorrect response:  %s", seqg_var->hsc_response);
# line 821 "../xiahsc.st"
					printf("\n");
				}
# line 821 "../xiahsc.st"
				;
			}
			{
# line 827 "../xiahsc.st"
				seq_efClear(seqg_env, s_ainp_mon);
# line 827 "../xiahsc.st"
				seqg_var->hsc_timeout = 1;
				{
# line 827 "../xiahsc.st"
					if (!seqg_var->s_sevr)
					{
# line 827 "../xiahsc.st"
						sprintf(seqg_var->hsc_command, "!%s %s", seqg_var->vID, "P");
# line 827 "../xiahsc.st"
						if (seqg_var->xiahscDebug >= 10)
						{
# line 827 "../xiahsc.st"
							printf("(%s,%d): ", "../xiahsc.st", 827);
# line 827 "../xiahsc.st"
							printf("WRITE_HSC: <%s>", seqg_var->hsc_command);
# line 827 "../xiahsc.st"
							printf("\n");
						}
# line 827 "../xiahsc.st"
						;
						{
# line 827 "../xiahsc.st"
							seqg_var->s_scan = (0);
# line 827 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 14/*s_scan*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 827 "../xiahsc.st"
						;
						{
# line 827 "../xiahsc.st"
							seqg_var->s_tmod = (0);
# line 827 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 16/*s_tmod*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 827 "../xiahsc.st"
						;
						{
# line 827 "../xiahsc.st"
							strcpy(seqg_var->s_ieos, "\n");
# line 827 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 5/*s_ieos*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 827 "../xiahsc.st"
						;
						{
# line 827 "../xiahsc.st"
							strcpy(seqg_var->s_oeos, "\r");
# line 827 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 9/*s_oeos*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 827 "../xiahsc.st"
						;
						{
# line 827 "../xiahsc.st"
							strcpy(seqg_var->s_aout, seqg_var->hsc_command);
# line 827 "../xiahsc.st"
							seq_pvPutTmo(seqg_env, 1/*s_aout*/, DEFAULT, DEFAULT_TIMEOUT);
						}
# line 827 "../xiahsc.st"
						;
					}
				}
# line 827 "../xiahsc.st"
				;
				{
# line 827 "../xiahsc.st"
					if (!seqg_var->s_sevr)
					{
# line 827 "../xiahsc.st"
						for (seqg_var->i = 15; seqg_var->i; seqg_var->i--)
						{
# line 827 "../xiahsc.st"
							if (seq_efTest(seqg_env, s_ainp_mon))
							{
# line 827 "../xiahsc.st"
								seqg_var->hsc_timeout = 0;
								break;
							}
# line 827 "../xiahsc.st"
							epicsThreadSleep(.02);
						}
# line 827 "../xiahsc.st"
						;
# line 827 "../xiahsc.st"
						if (seqg_var->hsc_timeout == 1)
						{
# line 827 "../xiahsc.st"
							strcpy(seqg_var->hsc_response, "");
# line 827 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 10)
							{
# line 827 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 827);
# line 827 "../xiahsc.st"
								printf("WAIT_HSC_RESPONSE: <%s> -> <<< TIMEOUT >>>", seqg_var->hsc_command);
# line 827 "../xiahsc.st"
								printf("\n");
							}
# line 827 "../xiahsc.st"
							;
						}
						else
						{
# line 827 "../xiahsc.st"
							strcpy(seqg_var->hsc_response, seqg_var->s_ainp);
# line 827 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 10)
							{
# line 827 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 827);
# line 827 "../xiahsc.st"
								printf("WAIT_HSC_RESPONSE: <%s> -> NORD=%d  AINP=%s", seqg_var->hsc_command, seqg_var->s_nord, seqg_var->hsc_response);
# line 827 "../xiahsc.st"
								printf("\n");
							}
# line 827 "../xiahsc.st"
							;
						}
# line 827 "../xiahsc.st"
						;
					}
				}
# line 827 "../xiahsc.st"
				;
			}
# line 827 "../xiahsc.st"
			;
# line 828 "../xiahsc.st"
			seqg_var->v_valid = validateResponse(seqg_var->hsc_command, seqg_var->hsc_response);
# line 829 "../xiahsc.st"
			if (seqg_var->xiahscDebug >= 2)
			{
# line 829 "../xiahsc.st"
				printf("(%s,%d): ", "../xiahsc.st", 829);
# line 829 "../xiahsc.st"
				printf("validateResponse (V): %i", seqg_var->v_valid);
# line 829 "../xiahsc.st"
				printf("\n");
			}
# line 829 "../xiahsc.st"
			;
# line 830 "../xiahsc.st"
			if (seqg_var->v_valid)
			{
# line 831 "../xiahsc.st"
				if (sscanf(seqg_var->hsc_response, "%*s %*s %d %d", &seqg_var->pos_a, &seqg_var->pos_b) == 2)
				{
# line 832 "../xiahsc.st"
					seqg_var->pos_ag = (1.0 * (seqg_var->pos_a - seqg_var->vOrigin) / 400);
# line 833 "../xiahsc.st"
					seqg_var->pos_bg = (1.0 * (seqg_var->pos_b - seqg_var->vOrigin) / 400);
# line 834 "../xiahsc.st"
					if (seqg_var->vOrient == 0)
					{
# line 835 "../xiahsc.st"
						if (seqg_var->pos_ag != seqg_var->t_RB)
						{
							{
# line 835 "../xiahsc.st"
								seqg_var->t_RB = (seqg_var->pos_ag);
# line 835 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 33/*t_RB*/, DEFAULT, DEFAULT_TIMEOUT);
							}
						}
# line 835 "../xiahsc.st"
						;
# line 836 "../xiahsc.st"
						if (seqg_var->pos_bg != seqg_var->b_RB)
						{
							{
# line 836 "../xiahsc.st"
								seqg_var->b_RB = (seqg_var->pos_bg);
# line 836 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 41/*b_RB*/, DEFAULT, DEFAULT_TIMEOUT);
							}
						}
# line 836 "../xiahsc.st"
						;
					}
					else
					{
# line 838 "../xiahsc.st"
						if (seqg_var->pos_ag != seqg_var->b_RB)
						{
							{
# line 838 "../xiahsc.st"
								seqg_var->b_RB = (seqg_var->pos_ag);
# line 838 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 41/*b_RB*/, DEFAULT, DEFAULT_TIMEOUT);
							}
						}
# line 838 "../xiahsc.st"
						;
# line 839 "../xiahsc.st"
						if (seqg_var->pos_bg != seqg_var->t_RB)
						{
							{
# line 839 "../xiahsc.st"
								seqg_var->t_RB = (seqg_var->pos_bg);
# line 839 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 33/*t_RB*/, DEFAULT, DEFAULT_TIMEOUT);
							}
						}
# line 839 "../xiahsc.st"
						;
					}
# line 841 "../xiahsc.st"
					if (seqg_var->vBusy)
					{
# line 841 "../xiahsc.st"
						seqg_var->vBusy = (0);
# line 841 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 24/*vBusy*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 841 "../xiahsc.st"
					;
					{
# line 845 "../xiahsc.st"
						seqg_var->height_RB = (seqg_var->t_RB + seqg_var->b_RB);
# line 845 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 61/*height_RB*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 845 "../xiahsc.st"
					;
					{
# line 846 "../xiahsc.st"
						seqg_var->v0_RB = ((seqg_var->t_RB - seqg_var->b_RB) / 2);
# line 846 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 53/*v0_RB*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 846 "../xiahsc.st"
					;
# line 847 "../xiahsc.st"
					seq_efSet(seqg_env, new_V_RB);
# line 852 "../xiahsc.st"
					seqg_var->t_old = seqg_var->t_RB;
# line 852 "../xiahsc.st"
					seqg_var->b_old = seqg_var->b_RB;
# line 853 "../xiahsc.st"
					seqg_var->v0_old = seqg_var->v0_RB;
# line 853 "../xiahsc.st"
					seqg_var->height_old = seqg_var->height_RB;
				}
				else
# line 855 "../xiahsc.st"
					if (sscanf(seqg_var->hsc_response, "%*s %*s %s", seqg_var->scratch) == 1)
					{
# line 856 "../xiahsc.st"
						if (seqg_var->xiahscDebug >= 5)
						{
# line 856 "../xiahsc.st"
							printf("(%s,%d): ", "../xiahsc.st", 856);
# line 856 "../xiahsc.st"
							printf("axis=%s, command=<%s>, response=%s", "V", seqg_var->hsc_command, seqg_var->hsc_response);
# line 856 "../xiahsc.st"
							printf("\n");
						}
# line 856 "../xiahsc.st"
						;
# line 857 "../xiahsc.st"
						if (!strcmp(seqg_var->scratch, "BUSY;"))
						{
# line 858 "../xiahsc.st"
							if (!seqg_var->vBusy)
							{
# line 858 "../xiahsc.st"
								seqg_var->vBusy = (1);
# line 858 "../xiahsc.st"
								seq_pvPutTmo(seqg_env, 24/*vBusy*/, DEFAULT, DEFAULT_TIMEOUT);
							}
# line 858 "../xiahsc.st"
							;
						}
						else
						{
# line 860 "../xiahsc.st"
							if (seqg_var->xiahscDebug >= 20)
							{
# line 860 "../xiahsc.st"
								printf("(%s,%d): ", "../xiahsc.st", 860);
# line 860 "../xiahsc.st"
								printf("could not understand %s", seqg_var->hsc_response);
# line 860 "../xiahsc.st"
								printf("\n");
							}
# line 860 "../xiahsc.st"
							;
						}
					}
			}
			else
			{
# line 864 "../xiahsc.st"
				if (seqg_var->xiahscDebug >= 2)
				{
# line 864 "../xiahsc.st"
					printf("(%s,%d): ", "../xiahsc.st", 864);
# line 864 "../xiahsc.st"
					printf("incorrect response:  %s", seqg_var->hsc_response);
# line 864 "../xiahsc.st"
					printf("\n");
				}
# line 864 "../xiahsc.st"
				;
			}
		}
		return;
	}
}

/****** Code for state "premove" in state set "xiahsc" ******/

/* Event function for state "premove" in state set "xiahsc" */
static seqBool seqg_event_xiahsc_0_premove(SS_ID seqg_env, int *seqg_ptrn, int *seqg_pnst)
{
# line 875 "../xiahsc.st"
	if (seq_efTest(seqg_env, l_mon) && (seqg_var->l == seqg_var->l_old))
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 0;
		return TRUE;
	}
# line 876 "../xiahsc.st"
	if (seq_efTest(seqg_env, r_mon) && (seqg_var->r == seqg_var->r_old))
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 1;
		return TRUE;
	}
# line 877 "../xiahsc.st"
	if (seq_efTest(seqg_env, t_mon) && (seqg_var->t == seqg_var->t_old))
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 2;
		return TRUE;
	}
# line 878 "../xiahsc.st"
	if (seq_efTest(seqg_env, b_mon) && (seqg_var->b == seqg_var->b_old))
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 3;
		return TRUE;
	}
# line 879 "../xiahsc.st"
	if (seq_efTest(seqg_env, h0_mon) && (seqg_var->h0 == seqg_var->h0_old))
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 4;
		return TRUE;
	}
# line 880 "../xiahsc.st"
	if (seq_efTest(seqg_env, v0_mon) && (seqg_var->v0 == seqg_var->v0_old))
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 5;
		return TRUE;
	}
# line 881 "../xiahsc.st"
	if (seq_efTest(seqg_env, width_mon) && (seqg_var->width == seqg_var->width_old))
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 6;
		return TRUE;
	}
# line 883 "../xiahsc.st"
	if (seq_efTest(seqg_env, height_mon) && (seqg_var->height == seqg_var->height_old))
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 7;
		return TRUE;
	}
	if (TRUE)
	{
		*seqg_pnst = 4;
		*seqg_ptrn = 8;
		return TRUE;
	}
	return FALSE;
}

/* Action function for state "premove" in state set "xiahsc" */
static void seqg_action_xiahsc_0_premove(SS_ID seqg_env, int seqg_trn, int *seqg_pnst)
{
	switch(seqg_trn)
	{
	case 0:
		{
# line 875 "../xiahsc.st"
			seq_efClear(seqg_env, l_mon);
		}
		return;
	case 1:
		{
# line 876 "../xiahsc.st"
			seq_efClear(seqg_env, r_mon);
		}
		return;
	case 2:
		{
# line 877 "../xiahsc.st"
			seq_efClear(seqg_env, t_mon);
		}
		return;
	case 3:
		{
# line 878 "../xiahsc.st"
			seq_efClear(seqg_env, b_mon);
		}
		return;
	case 4:
		{
# line 879 "../xiahsc.st"
			seq_efClear(seqg_env, h0_mon);
		}
		return;
	case 5:
		{
# line 880 "../xiahsc.st"
			seq_efClear(seqg_env, v0_mon);
		}
		return;
	case 6:
		{
# line 882 "../xiahsc.st"
			seq_efClear(seqg_env, width_mon);
		}
		return;
	case 7:
		{
# line 884 "../xiahsc.st"
			seq_efClear(seqg_env, height_mon);
		}
		return;
	case 8:
		{
# line 889 "../xiahsc.st"
			if (seq_efTest(seqg_env, l_mon) || seq_efTest(seqg_env, r_mon) || seq_efTest(seqg_env, h0_mon) || seq_efTest(seqg_env, width_mon))
			{
# line 892 "../xiahsc.st"
				if (seq_efTest(seqg_env, l_mon) || seq_efTest(seqg_env, r_mon))
				{
# line 893 "../xiahsc.st"
					seqg_var->width = seqg_var->r + seqg_var->l;
# line 894 "../xiahsc.st"
					seqg_var->h0 = (seqg_var->r - seqg_var->l) / 2;
				}
				else
				{
# line 896 "../xiahsc.st"
					seqg_var->l = seqg_var->width / 2 - seqg_var->h0;
# line 897 "../xiahsc.st"
					seqg_var->r = seqg_var->width / 2 + seqg_var->h0;
				}
# line 900 "../xiahsc.st"
				seqg_var->error = 0;
# line 901 "../xiahsc.st"
				if (!((seqg_var->l_lo <= seqg_var->l) && (seqg_var->l <= seqg_var->l_hi)))
				{
# line 901 "../xiahsc.st"
					seqg_var->l = seqg_var->l_old;
# line 901 "../xiahsc.st"
					seqg_var->error++;
				}
# line 902 "../xiahsc.st"
				if (!((seqg_var->r_lo <= seqg_var->r) && (seqg_var->r <= seqg_var->r_hi)))
				{
# line 902 "../xiahsc.st"
					seqg_var->r = seqg_var->r_old;
# line 902 "../xiahsc.st"
					seqg_var->error++;
				}
# line 903 "../xiahsc.st"
				if (!((seqg_var->h0_lo <= seqg_var->h0) && (seqg_var->h0 <= seqg_var->h0_hi)))
				{
# line 903 "../xiahsc.st"
					seqg_var->h0 = seqg_var->h0_old;
# line 903 "../xiahsc.st"
					seqg_var->error++;
				}
# line 904 "../xiahsc.st"
				if (!((seqg_var->width_lo <= seqg_var->width) && (seqg_var->width <= seqg_var->width_hi)))
				{
# line 905 "../xiahsc.st"
					seqg_var->width = seqg_var->width_old;
# line 905 "../xiahsc.st"
					seqg_var->error++;
				}
# line 906 "../xiahsc.st"
				if (seqg_var->error)
				{
# line 908 "../xiahsc.st"
					if (seq_efTest(seqg_env, l_mon))
# line 908 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 34/*l*/, DEFAULT, DEFAULT_TIMEOUT);
# line 909 "../xiahsc.st"
					if (seq_efTest(seqg_env, r_mon))
# line 909 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 42/*r*/, DEFAULT, DEFAULT_TIMEOUT);
# line 910 "../xiahsc.st"
					if (seq_efTest(seqg_env, h0_mon))
# line 910 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 46/*h0*/, DEFAULT, DEFAULT_TIMEOUT);
# line 911 "../xiahsc.st"
					if (seq_efTest(seqg_env, width_mon))
# line 911 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 54/*width*/, DEFAULT, DEFAULT_TIMEOUT);
# line 912 "../xiahsc.st"
					seqg_var->error = 15;
					{
# line 913 "../xiahsc.st"
						strcpy(seqg_var->errMsg, "H soft limits exceeded");
# line 913 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 63/*errMsg*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 913 "../xiahsc.st"
					;
				}
				else
				{
					{
# line 915 "../xiahsc.st"
						strcpy(seqg_var->errMsg, "no error");
# line 915 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 63/*errMsg*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 915 "../xiahsc.st"
					;
# line 917 "../xiahsc.st"
					seq_efSet(seqg_env, start_H_move);
# line 918 "../xiahsc.st"
					if (seq_efTest(seqg_env, l_mon) || seq_efTest(seqg_env, r_mon))
					{
# line 919 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 46/*h0*/, DEFAULT, DEFAULT_TIMEOUT);
# line 919 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 54/*width*/, DEFAULT, DEFAULT_TIMEOUT);
					}
					else
					{
# line 921 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 34/*l*/, DEFAULT, DEFAULT_TIMEOUT);
# line 921 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 42/*r*/, DEFAULT, DEFAULT_TIMEOUT);
					}
				}
# line 924 "../xiahsc.st"
				epicsThreadSleep(.02);
# line 925 "../xiahsc.st"
				seq_efClear(seqg_env, l_mon);
# line 925 "../xiahsc.st"
				seq_efClear(seqg_env, r_mon);
# line 926 "../xiahsc.st"
				seq_efClear(seqg_env, h0_mon);
# line 926 "../xiahsc.st"
				seq_efClear(seqg_env, width_mon);
# line 927 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 62/*error*/, DEFAULT, DEFAULT_TIMEOUT);
			}
# line 932 "../xiahsc.st"
			if (seq_efTest(seqg_env, t_mon) || seq_efTest(seqg_env, b_mon) || seq_efTest(seqg_env, v0_mon) || seq_efTest(seqg_env, height_mon))
			{
# line 935 "../xiahsc.st"
				if (seq_efTest(seqg_env, t_mon) || seq_efTest(seqg_env, b_mon))
				{
# line 936 "../xiahsc.st"
					seqg_var->height = seqg_var->t + seqg_var->b;
# line 937 "../xiahsc.st"
					seqg_var->v0 = (seqg_var->t - seqg_var->b) / 2;
				}
				else
				{
# line 939 "../xiahsc.st"
					seqg_var->t = seqg_var->height / 2 + seqg_var->v0;
# line 940 "../xiahsc.st"
					seqg_var->b = seqg_var->height / 2 - seqg_var->v0;
				}
# line 943 "../xiahsc.st"
				seqg_var->error = 0;
# line 944 "../xiahsc.st"
				if (!((seqg_var->t_lo <= seqg_var->t) && (seqg_var->t <= seqg_var->t_hi)))
				{
# line 944 "../xiahsc.st"
					seqg_var->t = seqg_var->t_old;
# line 944 "../xiahsc.st"
					seqg_var->error++;
				}
# line 945 "../xiahsc.st"
				if (!((seqg_var->b_lo <= seqg_var->b) && (seqg_var->b <= seqg_var->b_hi)))
				{
# line 945 "../xiahsc.st"
					seqg_var->b = seqg_var->b_old;
# line 945 "../xiahsc.st"
					seqg_var->error++;
				}
# line 946 "../xiahsc.st"
				if (!((seqg_var->v0_lo <= seqg_var->v0) && (seqg_var->v0 <= seqg_var->v0_hi)))
				{
# line 946 "../xiahsc.st"
					seqg_var->v0 = seqg_var->v0_old;
# line 946 "../xiahsc.st"
					seqg_var->error++;
				}
# line 947 "../xiahsc.st"
				if (!((seqg_var->height_lo <= seqg_var->height) && (seqg_var->height <= seqg_var->height_hi)))
				{
# line 948 "../xiahsc.st"
					seqg_var->height = seqg_var->height_old;
# line 948 "../xiahsc.st"
					seqg_var->error++;
				}
# line 949 "../xiahsc.st"
				if (seqg_var->error)
				{
# line 951 "../xiahsc.st"
					if (seq_efTest(seqg_env, t_mon))
# line 951 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 30/*t*/, DEFAULT, DEFAULT_TIMEOUT);
# line 952 "../xiahsc.st"
					if (seq_efTest(seqg_env, b_mon))
# line 952 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 38/*b*/, DEFAULT, DEFAULT_TIMEOUT);
# line 953 "../xiahsc.st"
					if (seq_efTest(seqg_env, v0_mon))
# line 953 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 50/*v0*/, DEFAULT, DEFAULT_TIMEOUT);
# line 954 "../xiahsc.st"
					if (seq_efTest(seqg_env, height_mon))
# line 954 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 58/*height*/, DEFAULT, DEFAULT_TIMEOUT);
# line 955 "../xiahsc.st"
					seqg_var->error = 15;
					{
# line 956 "../xiahsc.st"
						strcpy(seqg_var->errMsg, "V soft limits exceeded");
# line 956 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 63/*errMsg*/, DEFAULT, DEFAULT_TIMEOUT);
					}
# line 956 "../xiahsc.st"
					;
				}
				else
				{
# line 959 "../xiahsc.st"
					seq_efSet(seqg_env, start_V_move);
# line 960 "../xiahsc.st"
					if (seq_efTest(seqg_env, t_mon) || seq_efTest(seqg_env, b_mon))
					{
# line 961 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 50/*v0*/, DEFAULT, DEFAULT_TIMEOUT);
# line 961 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 58/*height*/, DEFAULT, DEFAULT_TIMEOUT);
					}
					else
					{
# line 963 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 30/*t*/, DEFAULT, DEFAULT_TIMEOUT);
# line 963 "../xiahsc.st"
						seq_pvPutTmo(seqg_env, 38/*b*/, DEFAULT, DEFAULT_TIMEOUT);
					}
				}
# line 966 "../xiahsc.st"
				epicsThreadSleep(.02);
# line 967 "../xiahsc.st"
				seq_efClear(seqg_env, t_mon);
# line 967 "../xiahsc.st"
				seq_efClear(seqg_env, b_mon);
# line 968 "../xiahsc.st"
				seq_efClear(seqg_env, v0_mon);
# line 968 "../xiahsc.st"
				seq_efClear(seqg_env, height_mon);
# line 969 "../xiahsc.st"
				seq_pvPutTmo(seqg_env, 62/*error*/, DEFAULT, DEFAULT_TIMEOUT);
			}
		}
		return;
	}
}

#undef seqg_var

/************************ Tables ************************/

/* Channel table */
static seqChan seqg_chans[] = {
	/* chName, offset, varName, varType, count, eventNum, efId, monitored, queueSize, queueIndex */
	{"{S}.AINP", offsetof(struct seqg_vars, s_ainp), "s_ainp", P_STRING, 1, 23, 1, 1, 0, 0},
	{"{S}.AOUT", offsetof(struct seqg_vars, s_aout), "s_aout", P_STRING, 1, 24, 0, 0, 0, 0},
	{"{S}.BAUD", offsetof(struct seqg_vars, s_baud), "s_baud", P_SHORT, 1, 25, 0, 0, 0, 0},
	{"{S}.DBIT", offsetof(struct seqg_vars, s_dbit), "s_dbit", P_SHORT, 1, 26, 0, 0, 0, 0},
	{"{S}.FCTL", offsetof(struct seqg_vars, s_fctl), "s_fctl", P_SHORT, 1, 27, 0, 0, 0, 0},
	{"{S}.IEOS", offsetof(struct seqg_vars, s_ieos), "s_ieos", P_STRING, 1, 28, 0, 0, 0, 0},
	{"{S}.IFMT", offsetof(struct seqg_vars, s_ifmt), "s_ifmt", P_SHORT, 1, 29, 0, 0, 0, 0},
	{"{S}.NORD", offsetof(struct seqg_vars, s_nord), "s_nord", P_SHORT, 1, 30, 0, 1, 0, 0},
	{"{S}.NRRD", offsetof(struct seqg_vars, s_nrrd), "s_nrrd", P_SHORT, 1, 31, 0, 0, 0, 0},
	{"{S}.OEOS", offsetof(struct seqg_vars, s_oeos), "s_oeos", P_STRING, 1, 32, 0, 0, 0, 0},
	{"{S}.OFMT", offsetof(struct seqg_vars, s_ofmt), "s_ofmt", P_SHORT, 1, 33, 0, 0, 0, 0},
	{"{S}.PROC", offsetof(struct seqg_vars, s_proc), "s_proc", P_SHORT, 1, 34, 0, 1, 0, 0},
	{"{S}.PRTY", offsetof(struct seqg_vars, s_prty), "s_prty", P_SHORT, 1, 35, 0, 0, 0, 0},
	{"{S}.SBIT", offsetof(struct seqg_vars, s_sbit), "s_sbit", P_SHORT, 1, 36, 0, 0, 0, 0},
	{"{S}.SCAN", offsetof(struct seqg_vars, s_scan), "s_scan", P_SHORT, 1, 37, 0, 0, 0, 0},
	{"{S}.SEVR", offsetof(struct seqg_vars, s_sevr), "s_sevr", P_INT, 1, 38, 0, 1, 0, 0},
	{"{S}.TMOD", offsetof(struct seqg_vars, s_tmod), "s_tmod", P_SHORT, 1, 39, 0, 0, 0, 0},
	{"{S}.TMOT", offsetof(struct seqg_vars, s_tmot), "s_tmot", P_DOUBLE, 1, 40, 0, 1, 0, 0},
	{"{P}{HSC}port", offsetof(struct seqg_vars, port), "port", P_STRING, 1, 41, 0, 0, 0, 0},
	{"{P}{HSC}hID", offsetof(struct seqg_vars, hID), "hID", P_STRING, 1, 42, 2, 1, 0, 0},
	{"{P}{HSC}vID", offsetof(struct seqg_vars, vID), "vID", P_STRING, 1, 43, 3, 1, 0, 0},
	{"{P}{HSC}hOrient", offsetof(struct seqg_vars, hOrient), "hOrient", P_SHORT, 1, 44, 4, 1, 0, 0},
	{"{P}{HSC}vOrient", offsetof(struct seqg_vars, vOrient), "vOrient", P_SHORT, 1, 45, 5, 1, 0, 0},
	{"{P}{HSC}hBusy", offsetof(struct seqg_vars, hBusy), "hBusy", P_SHORT, 1, 46, 0, 0, 0, 0},
	{"{P}{HSC}vBusy", offsetof(struct seqg_vars, vBusy), "vBusy", P_SHORT, 1, 47, 0, 0, 0, 0},
	{"{P}{HSC}stop", offsetof(struct seqg_vars, stop), "stop", P_SHORT, 1, 48, 6, 1, 0, 0},
	{"{P}{HSC}locate", offsetof(struct seqg_vars, locate), "locate", P_SHORT, 1, 49, 0, 1, 0, 0},
	{"{P}{HSC}init", offsetof(struct seqg_vars, init), "init", P_SHORT, 1, 50, 0, 1, 0, 0},
	{"{P}{HSC}enable", offsetof(struct seqg_vars, enable), "enable", P_SHORT, 1, 51, 0, 1, 0, 0},
	{"{P}{HSC}calib", offsetof(struct seqg_vars, calibrate), "calibrate", P_SHORT, 1, 52, 0, 1, 0, 0},
	{"{P}{HSC}t", offsetof(struct seqg_vars, t), "t", P_DOUBLE, 1, 53, 7, 1, 0, 0},
	{"{P}{HSC}t.HOPR", offsetof(struct seqg_vars, t_hi), "t_hi", P_DOUBLE, 1, 54, 0, 1, 0, 0},
	{"{P}{HSC}t.LOPR", offsetof(struct seqg_vars, t_lo), "t_lo", P_DOUBLE, 1, 55, 0, 1, 0, 0},
	{"{P}{HSC}tRB", offsetof(struct seqg_vars, t_RB), "t_RB", P_DOUBLE, 1, 56, 0, 1, 0, 0},
	{"{P}{HSC}l", offsetof(struct seqg_vars, l), "l", P_DOUBLE, 1, 57, 8, 1, 0, 0},
	{"{P}{HSC}l.HOPR", offsetof(struct seqg_vars, l_hi), "l_hi", P_DOUBLE, 1, 58, 0, 1, 0, 0},
	{"{P}{HSC}l.LOPR", offsetof(struct seqg_vars, l_lo), "l_lo", P_DOUBLE, 1, 59, 0, 1, 0, 0},
	{"{P}{HSC}lRB", offsetof(struct seqg_vars, l_RB), "l_RB", P_DOUBLE, 1, 60, 0, 1, 0, 0},
	{"{P}{HSC}b", offsetof(struct seqg_vars, b), "b", P_DOUBLE, 1, 61, 9, 1, 0, 0},
	{"{P}{HSC}b.HOPR", offsetof(struct seqg_vars, b_hi), "b_hi", P_DOUBLE, 1, 62, 0, 1, 0, 0},
	{"{P}{HSC}b.LOPR", offsetof(struct seqg_vars, b_lo), "b_lo", P_DOUBLE, 1, 63, 0, 1, 0, 0},
	{"{P}{HSC}bRB", offsetof(struct seqg_vars, b_RB), "b_RB", P_DOUBLE, 1, 64, 0, 1, 0, 0},
	{"{P}{HSC}r", offsetof(struct seqg_vars, r), "r", P_DOUBLE, 1, 65, 10, 1, 0, 0},
	{"{P}{HSC}r.HOPR", offsetof(struct seqg_vars, r_hi), "r_hi", P_DOUBLE, 1, 66, 0, 1, 0, 0},
	{"{P}{HSC}r.LOPR", offsetof(struct seqg_vars, r_lo), "r_lo", P_DOUBLE, 1, 67, 0, 1, 0, 0},
	{"{P}{HSC}rRB", offsetof(struct seqg_vars, r_RB), "r_RB", P_DOUBLE, 1, 68, 0, 1, 0, 0},
	{"{P}{HSC}h0", offsetof(struct seqg_vars, h0), "h0", P_DOUBLE, 1, 69, 11, 1, 0, 0},
	{"{P}{HSC}h0.HOPR", offsetof(struct seqg_vars, h0_hi), "h0_hi", P_DOUBLE, 1, 70, 0, 1, 0, 0},
	{"{P}{HSC}h0.LOPR", offsetof(struct seqg_vars, h0_lo), "h0_lo", P_DOUBLE, 1, 71, 0, 1, 0, 0},
	{"{P}{HSC}h0RB", offsetof(struct seqg_vars, h0_RB), "h0_RB", P_DOUBLE, 1, 72, 0, 1, 0, 0},
	{"{P}{HSC}v0", offsetof(struct seqg_vars, v0), "v0", P_DOUBLE, 1, 73, 12, 1, 0, 0},
	{"{P}{HSC}v0.HOPR", offsetof(struct seqg_vars, v0_hi), "v0_hi", P_DOUBLE, 1, 74, 0, 1, 0, 0},
	{"{P}{HSC}v0.LOPR", offsetof(struct seqg_vars, v0_lo), "v0_lo", P_DOUBLE, 1, 75, 0, 1, 0, 0},
	{"{P}{HSC}v0RB", offsetof(struct seqg_vars, v0_RB), "v0_RB", P_DOUBLE, 1, 76, 0, 1, 0, 0},
	{"{P}{HSC}width", offsetof(struct seqg_vars, width), "width", P_DOUBLE, 1, 77, 13, 1, 0, 0},
	{"{P}{HSC}width.HOPR", offsetof(struct seqg_vars, width_hi), "width_hi", P_DOUBLE, 1, 78, 0, 1, 0, 0},
	{"{P}{HSC}width.LOPR", offsetof(struct seqg_vars, width_lo), "width_lo", P_DOUBLE, 1, 79, 0, 1, 0, 0},
	{"{P}{HSC}widthRB", offsetof(struct seqg_vars, width_RB), "width_RB", P_DOUBLE, 1, 80, 0, 1, 0, 0},
	{"{P}{HSC}height", offsetof(struct seqg_vars, height), "height", P_DOUBLE, 1, 81, 14, 1, 0, 0},
	{"{P}{HSC}height.HOPR", offsetof(struct seqg_vars, height_hi), "height_hi", P_DOUBLE, 1, 82, 0, 1, 0, 0},
	{"{P}{HSC}height.LOPR", offsetof(struct seqg_vars, height_lo), "height_lo", P_DOUBLE, 1, 83, 0, 1, 0, 0},
	{"{P}{HSC}heightRB", offsetof(struct seqg_vars, height_RB), "height_RB", P_DOUBLE, 1, 84, 0, 1, 0, 0},
	{"{P}{HSC}error", offsetof(struct seqg_vars, error), "error", P_INT, 1, 85, 0, 0, 0, 0},
	{"{P}{HSC}errMsg", offsetof(struct seqg_vars, errMsg), "errMsg", P_STRING, 1, 86, 0, 0, 0, 0},
	{"{P}{HSC}debug", offsetof(struct seqg_vars, xiahscDebug), "xiahscDebug", P_INT, 1, 87, 0, 1, 0, 0},
};

/* Event masks for state set "xiahsc" */
static const seqMask seqg_mask_xiahsc_0_startup[] = {
	0x00000000,
	0x00000000,
	0x00000000,
};
static const seqMask seqg_mask_xiahsc_0_disable[] = {
	0x00000000,
	0x00080000,
	0x00000000,
};
static const seqMask seqg_mask_xiahsc_0_comm_error[] = {
	0x00000000,
	0x00040040,
	0x00000000,
};
static const seqMask seqg_mask_xiahsc_0_init[] = {
	0x0000000c,
	0x000c0000,
	0x00000000,
};
static const seqMask seqg_mask_xiahsc_0_idle[] = {
	0x0019fffc,
	0x001fc040,
	0x00000000,
};
static const seqMask seqg_mask_xiahsc_0_get_readback_positions[] = {
	0x00000000,
	0x00080000,
	0x00000000,
};
static const seqMask seqg_mask_xiahsc_0_premove[] = {
	0x00007f80,
	0x22200000,
	0x00022222,
};

/* State table for state set "xiahsc" */
static seqState seqg_states_xiahsc[] = {
	{
	/* state name */        "startup",
	/* action function */   seqg_action_xiahsc_0_startup,
	/* event function */    seqg_event_xiahsc_0_startup,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_xiahsc_0_startup,
	/* state options */     (0)
	},
	{
	/* state name */        "disable",
	/* action function */   seqg_action_xiahsc_0_disable,
	/* event function */    seqg_event_xiahsc_0_disable,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_xiahsc_0_disable,
	/* state options */     (0)
	},
	{
	/* state name */        "comm_error",
	/* action function */   seqg_action_xiahsc_0_comm_error,
	/* event function */    seqg_event_xiahsc_0_comm_error,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_xiahsc_0_comm_error,
	/* state options */     (0)
	},
	{
	/* state name */        "init",
	/* action function */   seqg_action_xiahsc_0_init,
	/* event function */    seqg_event_xiahsc_0_init,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_xiahsc_0_init,
	/* state options */     (0)
	},
	{
	/* state name */        "idle",
	/* action function */   seqg_action_xiahsc_0_idle,
	/* event function */    seqg_event_xiahsc_0_idle,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_xiahsc_0_idle,
	/* state options */     (0)
	},
	{
	/* state name */        "get_readback_positions",
	/* action function */   seqg_action_xiahsc_0_get_readback_positions,
	/* event function */    seqg_event_xiahsc_0_get_readback_positions,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_xiahsc_0_get_readback_positions,
	/* state options */     (0)
	},
	{
	/* state name */        "premove",
	/* action function */   seqg_action_xiahsc_0_premove,
	/* event function */    seqg_event_xiahsc_0_premove,
	/* entry function */    0,
	/* exit function */     0,
	/* event mask array */  seqg_mask_xiahsc_0_premove,
	/* state options */     (0)
	},
};

/* State set table */
static seqSS seqg_statesets[] = {
	{
	/* state set name */    "xiahsc",
	/* states */            seqg_states_xiahsc,
	/* number of states */  7
	},
};

/* Program table (global) */
seqProgram xiahsc = {
	/* magic number */      2002005,
	/* program name */      "xiahsc",
	/* channels */          seqg_chans,
	/* num. channels */     65,
	/* state sets */        seqg_statesets,
	/* num. state sets */   1,
	/* user var size */     sizeof(struct seqg_vars),
	/* param */             "name=hsc1, S=ito:serial:b0, P=ito:, HSC=hsc1:",
	/* num. event flags */  22,
	/* encoded options */   (0 | OPT_CONN | OPT_DEBUG | OPT_NEWEF | OPT_REENT),
	/* init func */         seqg_init,
	/* entry func */        0,
	/* exit func */         0,
	/* num. queues */       0
};
# line 976 "../xiahsc.st"


int validateResponse(char *out, char *in)
{
 int return_val;

 int k=1;

 if (strlen(in) == 0)
 {
  return_val = 0;
 }
 else
 {
  while (out[k] != ' ')
  {
   if (out[k] != in[k])
   {
    return_val = 0;
    break;
   }
   else
   {
    return_val = 1;
    k += 1;
   }
  }
 }

 return return_val;
}



/* Register sequencer commands and program */
#include "epicsExport.h"
static void xiahscRegistrar (void) {
    seqRegisterSequencerCommands();
    seqRegisterSequencerProgram (&xiahsc);
}
epicsExportRegistrar(xiahscRegistrar);
